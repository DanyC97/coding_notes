

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cs105_lab1a codes</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon-umich.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/my_theme.css" type="text/css" />
  

  

  
    <link rel="top" title="" href="../index.html"/>
        <link rel="up" title="EdX Course Notes (top-edx.rst)" href="top-edx.html"/>
        <link rel="next" title="cs105_lab1b_wordcount" href="cs105_lab1b.html"/>
        <link rel="prev" title="cs105_lab1a" href="cs105_lab1a.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Coding Notebook
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents (PySpark)</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="top-pyspark.html">PySpark Notes (<code class="docutils literal"><span class="pre">top-pyspark.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyspark-snippet.html">1. <code class="docutils literal"><span class="pre">pyspark-snippet.rst</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#modules">1.1. Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#spark-notebook-helpers-library-for-databricks">1.2. spark_notebook_helpers library for Databricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#create-toy-dataset">1.3. Create toy dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#print-rdd-per-item">1.4. Print RDD per item</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#databrick-helper-function-displaying-all-dfs-in-the-notebook">1.5. Databrick helper function displaying all DFs in the notebook</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#get-shape-of-df-gotta-be-a-better-way">1.6. Get shape of DF (gotta be a better way)</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#random-snippets">1.7. Random snippets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-snippet.html#print-dataframes-in-my-workspace-super-ad-hoc">1.7.1. print dataframes in my workspace (super-ad-hoc)</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-snippet.html#rename-column">1.7.2. Rename column</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#dbutils">1.8. dbutils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-practice.html">2. <code class="docutils literal"><span class="pre">pyspark-practice.rst</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#basics-dfs">2.1. Basics DFs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#udfs">2.2. UDFs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#sorting">2.3. Sorting</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#create-df-from-list-of-tuples">2.4. Create DF from list of tuples</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#groupby">2.5. groupby</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#practice-with-faker-data">2.6. Practice with faker data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-practice.html#little-refrehser-on-generators">2.6.1. Little refrehser on generators</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#register-table-to-use-sql">2.7. Register table to use SQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#more">2.8. More</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-overflow.html">3. <code class="docutils literal"><span class="pre">pyspark-overflow.rst</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-to-get-a-value-from-the-row-object-in-spark-dataframe">3.1. How to get a value from the Row object in Spark Dataframe?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-to-add-a-constant-column-in-a-spark-dataframe">3.2. How to add a constant column in a Spark DataFrame?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#add-an-empty-column-to-spark-dataframe">3.3. Add an empty column to Spark DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#count-number-of-non-nan-entries-in-each-column-of-spark-dataframe">3.4. Count number of non-NaN entries in each column of Spark dataframe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#use-simple-aggregation">3.4.1. Use simple aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#use-sql-null-semantics">3.4.2. Use SQL <code class="docutils literal"><span class="pre">NULL</span></code> semantics</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#in-fractions">3.4.3. In fractions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#updating-a-dataframe-column-in-spark">3.5. Updating a dataframe column in spark</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-do-i-add-a-new-column-to-spark-data-frame-pyspark">3.6. How do I add a new column to spark data frame (Pyspark)?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#use-literals-lit">3.6.1. Use literals <code class="docutils literal"><span class="pre">lit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#transforming-an-existing-column">3.6.2. Transforming an existing column</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-join">3.6.3. Using <code class="docutils literal"><span class="pre">join</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-function-udf">3.6.4. Using function/UDF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-to-change-dataframe-column-names-in-pyspark">3.7. How to change dataframe column names in pyspark?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#option-1-using-selectexpr">3.7.1. Option 1. Using selectExpr.</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#option-2-using-withcolumnrenamed">3.7.2. Option 2. Using <code class="docutils literal"><span class="pre">withColumnRenamed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-alias">3.7.3. Using alias</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-sqlcontext-sql">3.7.4. Using <code class="docutils literal"><span class="pre">sqlContext.sql</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#pyspark-dataframes-way-to-enumerate-without-converting-to-pandas">3.8. PySpark DataFrames - way to enumerate without converting to Pandas?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#dividing-two-columns-from-a-different-df">3.9. Dividing two columns from a different DF</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#ones-i-just-bookmarked-for-future-reference">3.10. Ones I just bookmarked for future reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#reshaping-pivoting-data-in-spark-rdd-and-or-spark-dataframes">3.10.1. Reshaping/Pivoting data in Spark RDD and/or Spark DataFrames</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-install.html">4. Install PySpark (<code class="docutils literal"><span class="pre">pyspark-install</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-install.html#windows">4.1. windows?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-install.html#retry-above-is-a-clusterfuck">4.2. Retry, above is a clusterfuck</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-prog-guide-rdd.html">5. (todo) Spark Programming Guide (<code class="docutils literal"><span class="pre">apache-prog-guide-rdd</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="apache-prog-guide-df.html">6. Spark Programming Guide DataFrames (<code class="docutils literal"><span class="pre">apache-prog-guide-df</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#overview">6.1. Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#sql">6.1.1. SQL</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#datasets-and-dataframes">6.1.2. Datasets and DataFrames</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#getting-started">6.2. Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#starting-point-sparksession">6.2.1. Starting Point: <code class="docutils literal"><span class="pre">SparkSession</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#creating-dataframes">6.2.2. Creating DataFrames</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#untyped-dataset-operations-aka-dataframe-operations">6.2.3. Untyped Dataset Operations (aka DataFrame Operations)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#running-sql-queries-programmatically">6.2.4. Running SQL Queries Programmatically</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#creating-datasets-only-in-scala-java">6.2.5. Creating Datasets (only in Scala/Java)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#interoperating-with-rdds">6.2.6. Interoperating with RDDs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#data-sources">6.3. Data Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#generic-load-functions">6.4. Generic Load Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#default-parquet">6.4.1. Default (parquet)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#manually-specifying-options">6.4.2. Manually Specifying Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#run-sql-on-files-directly">6.4.3. Run SQL on files directly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#generic-save-functions">6.5. Generic Save Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#save-modes">6.5.1. Save Modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#saving-to-persistent-tables">6.5.2. __Saving to Persistent Tables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#parquet-files">6.6. Parquet Files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#loading-data-programmatically">6.6.1. Loading Data Programmatically</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#partition-discovery">6.6.2. __Partition Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#schema-merging">6.6.3. Schema Merging</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#hive-metastore-parquet-conversion">6.6.4. __Hive metastore Parquet Conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#configuration">6.6.5. Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#json-datasets">6.7. JSON Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#hive-tables">6.8. Hive Tables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#interacting-with-different-versions-of-hive-metastore">6.8.1. __Interacting with Different Versions of Hive Metastore</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#jdbc-to-other-databases">6.9. __JDBC To Other Databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#performance-tuning">6.10. Performance Tuning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#caching-data-in-memory">6.10.1. Caching Data in Memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#other-configuration-options">6.10.2. Other Configuration Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#distributed-sql-engine">6.11. Distributed SQL Engine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#running-the-thrift-jdbc-odbc-server">6.11.1. __Running the Thrift JDBC/ODBC server</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#running-the-spark-sql-cli">6.11.2. Running the Spark SQL CLI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#reference">6.12. Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#data-types">6.12.1. Data-Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#nan-semantics">6.12.2. NaN Semantics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="databricks.html">7. Databrick Doc (<code class="docutils literal"><span class="pre">databricks.rst</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="databricks.html#ml-stuffs">7.1. ML Stuffs</a></li>
<li class="toctree-l3"><a class="reference internal" href="databricks.html#bunch-of-notebooks">7.2. Bunch of notebooks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="top-edx.html">EdX Course Notes (<code class="docutils literal"><span class="pre">top-edx.rst</span></code>)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cs105_lab0.html">cs105_lab0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab0.html#create-dataframe-and-filter-it">Create DataFrame and filter it</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab0.html#load-a-text-file">Load a text file</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab0.html#check-plotting">Check plotting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs105_lab1a.html">cs105_lab1a</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a.html#spark-context">Spark Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a.html#sparkcontext-and-the-driver-program-cluster-structure">SparkContext and the Driver Program (Cluster Structure)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#about-the-driver-program">About the Driver Program</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#about-hivecontext-the-type-of-sqlcontext-for-db">About HiveContext (the type of sqlContext for DB)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#sparkcontext">SparkContext</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a.html#using-dataframes-and-chaining-transformations">Using DataFrames and chaining transformations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#dataframe-and-schema">DataFrame and Schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#ways-to-define-schemas">Ways to define schemas</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#distributed-data-and-using-a-collection-to-create-a-dataframe">Distributed Data and using a collection to create a DataFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#query-plans-and-the-catalyst-optimizer">Query plans and the <code class="docutils literal"><span class="pre">Catalyst</span> <span class="pre">Optimizer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="">cs105_lab1a codes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exercise-overview">Exercise Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-list-of-data">Create list of Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-dataframe-from-a-list">Create DataFrame from a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="#subtract-one-from-each-the-age-row">Subtract one from each the <em>age</em> row</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apply-transformations-and-examine-query-plan">Apply transformations, and examine query plan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-collect-to-view-results">Use <code class="docutils literal"><span class="pre">collect</span></code> to view results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#display-helper-function-in-db">display helper function in DB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#more-actions-count-to-get-total">More actions: <code class="docutils literal"><span class="pre">count</span></code> to get total</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apply-transformation-filter-and-view-results-with-collect">Apply transformation <code class="docutils literal"><span class="pre">filter</span></code> and view results with <code class="docutils literal"><span class="pre">collect</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lambda-functions-and-udfs">Lambda functions and UDFs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-dataframe-actions">Additional DataFrame actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-dataframe-transformations">Additional DataFrame transformations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#orderby">orderBy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-distinct-and-dropduplicates">A <code class="docutils literal"><span class="pre">distinct</span></code> and <code class="docutils literal"><span class="pre">dropDuplicates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drop">drop</a></li>
<li class="toctree-l4"><a class="reference internal" href="#groupby">groupBy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sample">sample</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#caching-dataframes-and-storage-options">Caching DataFrames and Storage Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#unpersist-and-storage-options">Unpersist and storage options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#debugging-spark-applications-and-lazy-evaluation">Debugging Spark applications and lazy evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jvm-and-py4j-how-python-is-executed-in-spark">JVM and Py4J - How Python is Executed in Spark</a></li>
<li class="toctree-l4"><a class="reference internal" href="#challenges-with-lazy-evaluation-using-transformations-and-actions">Challenges with lazy evaluation using transformations and actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#finding-the-bug">Finding the bug</a></li>
<li class="toctree-l4"><a class="reference internal" href="#moving-toward-expert-style">Moving toward expert style</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs105_lab1b.html">cs105_lab1b_wordcount</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#create-a-base-df-and-perform-operations">Create a base DF and perform operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#create-a-base-df">Create a base DF</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#use-df-functions-to-add-an-s">Use DF functions to add an &#8216;s&#8217;</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#length-of-each-word">Length of each word</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#counting-with-spark-sql-and-dataframes">Counting with Spark SQL and DataFrames</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#using-groupby-and-count">Using groupBy and count</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#finding-unique-words-and-a-mean-value">Finding unique words and a mean value</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#unique-words">Unique words</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#means-of-groups-using-dataframes">Means of groups using DataFrames</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#apply-word-count-to-a-file">Apply word count to a file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#the-wordcount-function">The wordCount function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#capitalization-and-punctuation">Capitalization and punctuation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#load-a-text-file">Load a text file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#words-from-lines">Words from lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#count-the-words">Count the words</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#random-stuffs-i-played-around-with">Random stuffs I played around with</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs105_lab2.html">cs105_lab2_apache_log</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab2.html#part1-overview-web-server-log-analysis-with-apache-spark">Part1: Overview: Web Server Log Analysis with Apache Spark</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#modules-used-in-this-assignment">Modules used in this assignment</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#dataset-used">Dataset used</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab2.html#part2-exploratory-data-analysis">Part2: Exploratory Data Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#a-loading-the-log-file">2a) loading the log file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#b-parsing-the-log-file">2b) Parsing the log file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#c-data-cleaning">2c) Data Cleaning</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#fix-the-rows-with-null-content-size">Fix the rows with null content_size</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#parsing-the-timestamp">Parsing the timestamp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab2.html#part3-analysis-walk-through-on-the-web-server-log-file">Part3: Analysis Walk-Through on the Web Server Log File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#a-example-content-size-statistics">3a) Example: Content Size Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#b-example-http-status-analysis">3b) Example: HTTP Status Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#c-example-status-graphing">3c) Example: Status Graphing</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#d-example-frequent-hosts">3d) Example: Frequent Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#e-example-visualizing-paths">3e) Example: Visualizing Paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#f-example-top-paths">3f) Example: Top Paths</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab2.html#part-4-analyzing-web-server-log-file">Part 4: Analyzing Web Server Log File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#a-exercise-top-ten-error-paths-hw">4a) Exercise: Top Ten Error Paths (HW)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#b-exercise-number-of-unique-hosts-hw">4b) Exercise: Number of Unique Hosts (HW)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#c-exercise-number-of-unique-daily-hosts">4c) Exercise: Number of Unique Daily Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#d-exercise-visualizing-the-number-of-unique-daily-hosts">4d) Exercise: Visualizing the Number of Unique Daily Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#e-exercise-average-number-of-daily-requests-per-host">4e) Exercise: Average Number of Daily Requests per Host</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#f-exercise-visualizing-the-average-daily-requests-per-unique-host">4f) Exercise: Visualizing the Average Daily Requests per Unique Host</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab2.html#part5-exploring-404-status-codes">Part5: Exploring 404 Status Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#a-exercise-counting-404-response-codes">5a) Exercise: Counting 404 Response Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#b-exercise-listing-404-status-code-records">5b) Exercise: Listing 404 Status Code Records</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#c-exercise-listing-the-top-twenty-404-response-code-paths">5c) Exercise: Listing the Top Twenty 404 Response Code paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#d-exercise-listing-the-top-twenty-five-404-response-code-hosts">5d) Exercise: Listing the Top Twenty-five 404 Response Code Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#e-exercise-listing-404-errors-per-day">5e) Exercise: Listing 404 Errors per Day</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#f-exercise-visualizing-the-404-errors-by-day">5f) Exercise: Visualizing the 404 Errors by Day</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#h-exercise-hourly-404-errors">5h) Exercise: Hourly 404 Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#g-exercise-top-five-days-for-404-errors">5g) Exercise: Top Five Days for 404 Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#i-exercise-hourly-404-errors">5i) Exercise: Hourly 404 Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#j-exercise-visualizing-the-404-response-codes-by-hour">5j) Exercise: Visualizing the 404 Response Codes by Hour</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab1.html">cs110_lab1_power_ml_pipeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part1-business-understanding">Part1: Business Understanding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#background-power-generation">Background &#8212; power generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#challenge-for-power-grid-operation">Challenge for power grid operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#the-business-problem">The business problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#business-understanding">Business Understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part2-extract-transform-load-etl-your-data">Part2: Extract-Transform-Load (ETL) Your Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2a">Exercise 2a</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2b">Exercise 2b</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-2-alternative-method-to-load-your-data">Part 2: Alternative Method to Load your Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2c">Exercise 2c</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2d">Exercise 2d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-3-explore-your-data">Part 3: Explore Your Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#a-register-the-dataframe-to-use-sql-commands">3a - <strong>register</strong> the DataFrame (to use sql commands)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#b-read-data-using-sql-command-databricks-only">3b - read data using <code class="docutils literal"><span class="pre">%sql</span></code> command (DataBricks only)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#c-use-sql-desc-command-to-describe-the-schema">3c - use SQL <code class="docutils literal"><span class="pre">desc</span></code> command to describe the schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#dataframe-describe-method">DataFrame <code class="docutils literal"><span class="pre">describe</span></code> method</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-4-visualize-your-data">Part 4: Visualize your data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-4a">Exercise 4a</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-4b-hw">Exercise 4b (hw)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-4c-hw">Exercise 4c (hw)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-4d-hw">Exercise 4d (hw)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-5-data-preparation">Part 5: Data Preparation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-5-a">Exercise 5(a)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-6-data-modeling">Part 6: Data Modeling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-6-a-hw">Exercise 6(a) (hw)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#b-build-linear-regression-model">6(b) - build Linear Regression Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#c-set-model-parameters-and-fit-linear-regression-model">6(c) - set model parameters, and fit linear regression model</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#d-study-the-fitted-lr-model">6(d) &#8212; study the fitted LR model</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#e-evalute-model-on-the-20-test-set">6(e) evalute model on the 20% test-set</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#f-quantify-performance-using-regressionevaluator">6(f) &#8211; quantify performance using <code class="docutils literal"><span class="pre">RegressionEvaluator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#g-use-r2-this-time">6(g) use R2 this time</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#h-register-our-test-dataframe-as-sql-table">6(h) Register our test DataFrame as SQL table</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#i-sql-statement-on-the-sql-table-registered-from-our-test-dataframe">6(i) SQL statement on the SQL table registered from our test DataFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#j-plot-histogram-of-rmse">6(j) Plot histogram of RMSE</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#k-plot-pie-chart">6(k) Plot pie chart</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-7-tuning-and-evaluation">Part 7: Tuning and Evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#a-run-cross-validation-tuning">7(a) Run Cross Validation Tuning</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-b-evaluate-tuned-lr-model-hw">Exercise 7(b) &#8211; Evaluate tuned LR model (hw)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-c-decisiontreeregressor">Exercise 7(c) DecisionTreeRegressor</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-d">Exercise 7(d)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-e-evaluate-dtr-performance">Exercise 7(e) &#8212; evaluate DTR performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-f-random-forest-regressor">Exercise 7(f) (Random Forest Regressor)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-g-cross-validation">Exercise 7(g) (cross validation)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-h-model-evaluation">Exercise 7(h) (model evaluation)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab1_trimmed.html">cs110_lab1_trimmed</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1_trimmed.html#part2-extract-transform-load-etl-your-data">Part2: Extract-Transform-Load (ETL) Your Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1_trimmed.html#exercise-2a">Exercise 2a</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1_trimmed.html#exercise-2b">Exercise 2b</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1_trimmed.html#part-2-alternative-method-to-load-your-data">Part 2: Alternative Method to Load your Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab2.html">cs110_lab2_als_prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab2.html#preliminaries">Preliminaries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#the-20-million-movie-sample">The 20-million movie sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#cpu-vs-io-tradeoff">CPU vs IO Tradeoff</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#load-and-cache">Load and Cache</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab2.html#basic-recommendations">Basic Recommendations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-1a-movies-with-highest-average-ratings">Exercise (1a) Movies with Highest Average Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-1b-movies-with-highest-average-ratings-and-at-least-500-reviews">Exercise (1b) Movies with Highest Average Ratings and at least 500 reviews</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab2.html#collaborative-filtering">Collaborative Filtering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-2a-creating-a-training-set">Exercise (2a) Creating a Training Set</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-2b-alternating-least-squares">Exercise (2b) Alternating Least Squares</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#why-are-we-doing-our-own-cross-validation">Why are we doing our own cross-validation?</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#excersie-2c-testing-your-model">Excersie (2c) Testing Your Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-2d-comparing-your-model">Exercise (2d) Comparing Your Model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab2.html#predictions-for-yourself">Predictions for Yourself</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3a-your-movie-ratings">Exercise (3a) Your Movie Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3b-add-your-movies-to-training-dataset">Exercise (3b) Add Your Movies to Training Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3c-train-a-model-with-your-ratings">Exercise (3c) Train a Model with Your Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3d-check-rmse-for-the-new-model-with-your-ratings">Exercise (3d) Check RMSE for the New Model with Your Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3e-predict-your-ratings">Exercise (3e) Predict Your Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3f-predict-your-ratings">Exercise (3f) Predict Your Ratings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab3a.html">cs110_lab3a_word_count_rdd</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab3b.html">cs110_lab3b_text_analysis_ER</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#data-files">Data files</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#preliminaries">Preliminaries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#load-data-files">Load data files</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#examine-the-lines-loaded">Examine the lines loaded</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#er-as-text-similarity-bags-of-words">ER as Text Similarity - Bags of Words</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-1-a-tokenize-a-string">Exercise 1(a) Tokenize a String</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-1b-removing-stopwords">Exercise (1b) removing stopwords</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-1c-tokenizing-the-small-datasets">Exercise (1c) Tokenizing the small datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-1d-amazon-record-with-the-most-tokens">Exercise (1d) Amazon record with the most tokens</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#er-as-text-similarity-weighted-bag-of-words-using-tf-idf">ER as Text Similarity - Weighted Bag-of-Words using TF-IDF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-2a-implement-a-tf-function">Exercise (2a) Implement a TF function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-2b-create-a-corpus">Exercise (2b) Create a corpus</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-2c-implement-an-idfs-function">Exercise (2c) Implement an IDFs function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-2d-tokens-with-the-smallest-idf">Exercise (2d) Tokens with the smallest IDF</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-2e-idf-histogram">Exercise (2e) IDF Histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-2f-implement-a-tf-idf-function">Exercise (2f) Implement a TF-IDF function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#er-as-text-similarity-cosine-similarity">ER as Text Similarity &#8212; Cosine Similarity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#excercise-3a-implement-the-components-of-a-cosinesimilarity-function">Excercise (3a) Implement the components of a cosineSimilarity function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-3b-implement-a-cosinesimilarity-function">Exercise (3b) Implement a cosineSimilarity function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-3c-perform-entity-resolution">Exercise (3c) Perform Entity Resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-3d-perform-entity-resolution-with-broadcast-variables">Exercise (3d) Perform Entity Resolution with Broadcast Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#e-perform-a-gold-standard-evaluation">(3e) Perform a Gold Standard evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#using-the-gold-standard-data-we-can-answer-the-following-questions">Using the &#8220;gold standard&#8221; data we can answer the following questions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#scalable-er">Scalable ER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-4a-tokenize-the-full-dataset">Exercise (4a) Tokenize the full dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-4b-compute-idfs-and-tf-idfs-for-the-full-datasets">Exercise (4b) Compute IDFs and TF-IDFs for the full datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-4c-compute-norms-for-the-weights-from-the-full-datasets">Exercise (4c) Compute Norms for the weights from the full datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-4d-create-inverted-indices-from-the-full-datasets">Exercise (4d) Create inverted indices from the full datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-4e-identify-common-tokens-from-the-full-dataset">Exercise (4e) Identify common tokens from the full dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-4f-identify-common-tokens-from-the-full-dataset">Exercise (4f) Identify common tokens from the full dataset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#analysis">Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-5a-counting-true-positives-false-positives-and-false-negatives">Exercise (5a) Counting True Positives, False Positives, and False Negatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#b-precision-recall-and-f-measures">5b Precision, Recall, and F-measures</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#c-line-plots">5c Line Plots</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab1a.html">cs120_lab1a_math_review</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab1a.html#math-review">Math review</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-1a-scalar-multiplication-vectors">Exercise (1a) Scalar multiplication: vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-1b-element-wise-multiplication-vectors">Exercise (1b) Element-wise multiplication: vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-1c-dot-product">Exercise (1c) Dot product</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-1d-matrix-multiplication">Exercise (1d) Matrix multiplication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab1a.html#numpy">NumPy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-2a-scalar-multiplication">Exercise (2a) Scalar multiplication</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-2b-element-wise-multiplication-and-dot-product">Exercise (2b) Element-wise multiplication and dot product</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-2c-matrix-math">Exercise (2c) Matrix math</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab1a.html#additional-numpy-and-spark-linear-algebra">Additional NumPy and Spark linear algebra</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-3a-slices">Exercise (3a) Slices</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-3b-combining-ndarray-objects">Exercise (3b) Combining ndarray objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-3c-pyspark-s-densevector">Exercise (3c) PySpark&#8217;s DenseVector</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab1a.html#python-lambda-expressions">Python lambda expressions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4a-lambda-is-an-anonymous-function">Exercise (4a) Lambda is an anonymous function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4b-lambda-fewer-steps-than-def">Exercise (4b) lambda fewer steps than def</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4c-lambda-expression-arguments">Exercise (4c) Lambda expression arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4d-restrictions-on-lambda-expressions">Exercise (4d) Restrictions on lambda expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4e-functional-programming">Exercise (4e) Functional programming</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4f-composability">Exercise (4f) Composability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab1b.html">cs120_lab1b_word_count_rdd</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab2.html">cs120_lab2_linear_regression_df</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab3.html">cs120_lab3_ctr_df</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab4.html">cs120_lab4_pca</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab4.html#work-through-the-steps-of-pca-on-a-sample-dataset">Work through the steps of PCA on a sample dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-1-two-dimensional-gaussians">Visualization 1: Two-dimensional Gaussians</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#a-interpreting-pca">1a) Interpreting PCA</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#b-sample-covariance-matrix">1b) Sample covariance matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#c-covariance-function">1c) Covariance Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#d-eigendecomposition">1d) Eigendecomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#e-pca-scores">1e) PCA scores</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab4.html#write-a-pca-function-and-evaluate-pca-on-sample-datasets">Write a PCA function and evaluate PCA on sample datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#a-pca-function">2a) PCA function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#b-pca-on-data-random">2b) PCA on data_random</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-2-pca-projection">Visualization 2: PCA projection</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-3-three-dimensional-data">Visualization 3: Three-dimensional data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#c-3d-to-2d">2c) 3D to 2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-4-2d-representation-of-3d-data">Visualization 4: 2D representation of 3D data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#d-variance-explained">2d) Variance explained</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab4.html#parse-inspect-and-preprocess-neuroscience-data-then-perform-pca">Parse, inspect, and preprocess neuroscience data then perform PCA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#a-load-neuroscience-data">3a) Load neuroscience data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#b-parse-the-data">3b) Parse the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#c-min-and-max-fluorescence">3c) Min and max fluorescence</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-5-pixel-intensity">Visualization 5: Pixel intensity</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#d-fractional-signal-change">3d) Fractional signal change</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-6-normalized-data">Visualization 6: Normalized data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#e-pca-on-the-scaled-data">3e) PCA on the scaled data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-7-top-two-components-as-images">Visualization 7: Top two components as images</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-8-top-two-components-as-one-image">Visualization 8: Top two components as one image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab4.html#feature-based-aggregation-and-pca">Feature-based aggregation and PCA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#a-aggregation-using-arrays">(4a) Aggregation using arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#b-recreate-with-np-tile-and-np-eye">(4b) Recreate with np.tile and np.eye</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#c-recreate-with-np-kron">(4c) Recreate with np.kron</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#d-aggregate-by-time">(4d) Aggregate by time</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#e-obtain-a-compact-representation">(4e) Obtain a compact representation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-9-top-two-components-by-time">Visualization 9: Top two components by time</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#f-aggregate-by-direction">(4f) Aggregate by direction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#g-compact-representation-of-direction-data">(4g) Compact representation of direction data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-10-top-two-components-by-direction">Visualization 10: Top two components by direction</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apache-ml-guide.html">MLLib - Main guide (<code class="docutils literal"><span class="pre">apache-ml-guide.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-guide.pipeline-old.html">1. Pipeline-old (<code class="docutils literal"><span class="pre">pipeline-old</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#main-concepts-in-pipelines">1.1. Main concepts in Pipelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#dataframe">1.2. DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#pipeline-components">1.3. Pipeline components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#transformers">1.3.1. Transformers</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#estimators">1.3.2. Estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#properties-of-pipeline-components">1.3.3. Properties of pipeline components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#pipeline-transformers-and-estimators">1.4. Pipeline (transformers and estimators)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#how-it-works">1.4.1. How it works</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#details">1.4.2. Details</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#parameters">1.5. Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#saving-and-loading-pipelines">1.6. Saving and Loading Pipelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#code-examples">1.7. Code Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#estimator-transformer-and-param">1.7.1. Estimator, Transformer, and Param</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#example-pipeline">1.7.2. Example: Pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#example-model-selection-via-cv-scala">1.7.3. Example: model selection via CV (Scala)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#example-model-selection-via-train-validation-split-scala">1.7.4. Example: model selection via train validation split (scala)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-guide.et-fs.html">2. Extracting, transforming and selecting features (<code class="docutils literal"><span class="pre">et-fs</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.et-fs.html#feature-extractors">2.1. Feature Extractors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#tf-idf">2.1.1. TF-IDF</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#word2vec">2.1.2. Word2Vec</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#countvectorizer">2.1.3. CountVectorizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.et-fs.html#feature-transformers">2.2. Feature Transformers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#tokenizer">2.2.1. Tokenizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#stopwordsremover">2.2.2. StopWordsRemover</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#n-gram">2.2.3. n-gram</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#binarizer">2.2.4. Binarizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#pca">2.2.5. PCA</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#polynomialexpansion">2.2.6. PolynomialExpansion</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#discrete-cosine-transform-dct">2.2.7. Discrete Cosine Transform (DCT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#stringindexer">2.2.8. StringIndexer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#indextostring">2.2.9. IndexToString</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#onehotencoder">2.2.10. OneHotEncoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#vectorindexer">2.2.11. VectorIndexer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#normalizer">2.2.12. Normalizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#standardscaler">2.2.13. StandardScaler</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#minmaxscaler">2.2.14. MinMaxScaler</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#maxabsscaler">2.2.15. MaxAbsScaler</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#bucketizer">2.2.16. Bucketizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#elementwiseproduct-bm">2.2.17. ElementwiseProduct (bm)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#sqltransformer-bm">2.2.18. SQLTransformer (bm)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#vectorassembler">2.2.19. VectorAssembler</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#quantilediscretizer">2.2.20. QuantileDiscretizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.et-fs.html#feature-selectors">2.3. Feature Selectors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#vectorslicer">2.3.1. VectorSlicer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#rformula">2.3.2. RFormula</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#chisqselector">2.3.3. ChiSqSelector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-guide.classification.html">3. Classification (<code class="docutils literal"><span class="pre">classification</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#logistic-regression">3.1. Logistic regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#decision-tree-classifier">3.2. Decision tree classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#random-forest-classifier">3.3. Random forest classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#gradient-boosted-tree-classifier">3.4. Gradient-boosted tree classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#multilayer-perceptron-classifier">3.5. Multilayer perceptron classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#one-vs-rest-classifier-a-k-a-one-vs-all">3.6. One-vs-Rest classifier (a.k.a. One-vs-All)</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#naive-bayes">3.7. Naive Bayes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-guide.regression.html">4. Regression (<code class="docutils literal"><span class="pre">regression.rst</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#linear-regression">4.1. Linear regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#generalized-linear-regression">4.2. Generalized linear regression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.regression.html#available-families">4.2.1. Available families</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#decision-tree-regression">4.3. Decision tree regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#random-forest-regression">4.4. Random forest regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#gradient-boosted-tree-regression">4.5. Gradient-boosted tree regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#survival-regression">4.6. Survival regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#isotonic-regression">4.7. Isotonic regression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.regression.html#examples">4.7.1. Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-guide.tree.html">5. Tree-based-methods (<code class="docutils literal"><span class="pre">tree.rst</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.tree.html#decision-trees">5.1. Decision trees</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.tree.html#inputs-and-outputs">5.1.1. Inputs and Outputs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.tree.html#tree-ensembles">5.2. Tree Ensembles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.tree.html#random-forests">5.2.1. Random Forests</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.tree.html#gradient-boosted-trees-gbts">5.2.2. Gradient-Boosted Trees (GBTs)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apache-ml-rdd.html">MLLib: RDD-based API Guideline (<code class="docutils literal"><span class="pre">apache-ml-rdd</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-rdd.datatype.html">1. Data Types (<code class="docutils literal"><span class="pre">datatypes</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.datatype.html#local-vector">1.1. Local vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.datatype.html#labeled-point">1.2. Labeled point</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.datatype.html#local-matrix">1.3. Local matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.datatype.html#distributed-matrix">1.4. Distributed matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.datatype.html#rowmatrix">1.4.1. RowMatrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.datatype.html#indexedrowmatrix">1.4.2. IndexedRowMatrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.datatype.html#coordinatematrix">1.4.3. CoordinateMatrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.datatype.html#blockmatrix">1.4.4. BlockMatrix</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-rdd.stats.html">2. Basic Statistics (<code class="docutils literal"><span class="pre">stats</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#summary-statistics">2.1. Summary statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#correlations">2.2. Correlations</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#stratified-sampling">2.3. Stratified sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#hypothesis-testing">2.4. Hypothesis testing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.stats.html#streaming-significance-testing">2.4.1. Streaming Significance Testing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#random-data-generation">2.5. Random data generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#kernel-density-estimation">2.6. Kernel density estimation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-rdd.eval.html">3. Evaluation metrics (<code class="docutils literal"><span class="pre">eval</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.eval.html#classification-model-evaluation">3.1. Classification model evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.eval.html#binary-classification">3.1.1. Binary classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.eval.html#multiclass-classification">3.1.2. Multiclass classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.eval.html#multilabel-classification">3.1.3. Multilabel classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.eval.html#ranking-systems">3.1.4. Ranking systems</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.eval.html#regression-model-evaluation">3.2. Regression model evaluation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Table of Contents (Others)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bash_wooledge/top-bash-wool.html">Bash wooledge (<code class="docutils literal"><span class="pre">top-bash-wool.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/special_char.html">1. Special Characters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/param.html">2. Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/param.html#basic">2.1. Basic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#always-double-quote-when-doing-pe-parameter-expansion">2.1.1. Always double-quote when doing PE (parameter expansion)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#char-needed-with-dealing-with-numerics">2.1.2. char needed with dealing with numerics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/param.html#special-parameters-and-variables">2.2. Special Parameters and Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#special-parameters">2.2.1. Special Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#special-variables-provided-by-the-shell">2.2.2. Special variables provided by the shell</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/param.html#pe-tricks-some-i-rarely-use">2.3. PE tricks (some I rarely use)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#summary-table">2.3.1. Summary table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var">2.3.2. <code class="docutils literal"><span class="pre">${var}</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-word-use-default-value">2.3.3. <code class="docutils literal"><span class="pre">${var:-word}</span></code> (use default value)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-word-assign-default">2.3.4. <code class="docutils literal"><span class="pre">${var:=word}</span></code> (assign default)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-word-use-alternate-value">2.3.5. <code class="docutils literal"><span class="pre">${var:+word}</span></code> (use alternate value)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-offset-length-substring-expansion">2.3.6. <code class="docutils literal"><span class="pre">${var:offset:length}</span></code> (substring expansion)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-var-number-of-characters-or-array-items">2.3.7. <code class="docutils literal"><span class="pre">${#var}</span></code>, <code class="docutils literal"><span class="pre">${#var[&#64;]}</span></code> (number of characters or array items)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-pattern-delete-beginning-of-str-if-match">2.3.8. <code class="docutils literal"><span class="pre">${var#pattern}</span></code> (delete beginning of str if match)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-msg-print-msg-to-stderr">2.3.9. <code class="docutils literal"><span class="pre">${var:?msg}</span></code> (print msg to stderr)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/patterns.html">3. Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#glob-patterns">3.1. Glob patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/patterns.html#use-glob-not-ls-for-looping-over-files">3.1.1. Use glob, not ls for looping over files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#extended-globs-i-rather-use-regexp">3.2. Extended Globs (I rather use regexp)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#regular-expressions">3.3. Regular expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#brace-expansion">3.4. Brace Expansion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/tests.html">4. Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/tests.html#exit-status-0-success-use">4.1. Exit status (0 = success)....use $?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/tests.html#control-operators-and">4.2. Control operators (&amp;&amp; and ||)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/tests.html#grouping-statements">4.3. Grouping statements {...;}</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/tests.html#use-case1-reporting-stderr-on-complex-test">4.3.1. Use-case1: reporting stderr on complex test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/tests.html#use-case2-redirect-input-to-a-group-of-statements">4.3.2. Use-case2: redirect input to a group of statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/tests.html#use-case3-error-handling">4.3.3. Use-case3: error handling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/conditionals.html">5. Conditionals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/conditionals.html#conditional-blocks-if-test-and">5.1. Conditional Blocks (if, test and [[)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/conditionals.html#conditional-loops-while-until-and-for">5.2. Conditional Loops (while, until and for)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/conditionals.html#choices-case-and-select">5.3. Choices (case and select)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sed/sed-tutorial.gnu.html">sed-tutorial-gnu (<code class="docutils literal"><span class="pre">sed-tutorial.gnu.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#execution-cycle-how-sed-works">Execution Cycle: How sed works</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#addresses-selecting-lines-with-sed">Addresses: Selecting lines with sed</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#single-address-form">Single address form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#two-address-form">Two address form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#match-negation-via">Match negation via <code class="docutils literal"><span class="pre">!</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#regular-expressions-overview-of-regular-expression-syntax">Regular Expressions: Overview of regular expression syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#common-commands-often-used-commands">Common Commands: Often used commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#the-s-command-sed-s-swiss-army-knife">The &#8220;s&#8221; Command: sed&#8217;s Swiss Army Knife</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#replacement">replacement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#flags">flags</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#other-commands-less-frequently-used-commands">Other Commands: Less frequently used commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#programming-commands-commands-for-sed-gurus">Programming Commands: Commands for sed gurus</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html">sed-tutorial-tutorials-points (<code class="docutils literal"><span class="pre">sed-tutorial.tutorialspoints.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#sed-workflow">Sed - workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#basic-syntax-and-examples">Basic syntax and examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#standard-options">Standard options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#gnu-specific-options">GNU specific options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#loops-branches">Loops, Branches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#address-range-search-by-specifying-line-nums">Address range (search by specifying line-nums)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#p-syntax">&#8216;p&#8217; syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#m-n-syntax">&#8216;M,+n&#8217; syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#id1">&#8216;M,~n&#8217; syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#pattern-range-search-for-simple-text-or-regexp-using-regex-syntax">Pattern range - search for simple-text or regexp using /regex/ syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#basic-commands-delete-read-write-append">Basic commands (delete, read, write, append)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#delete-command-address1-address2-d">Delete command [address1[,address2]]d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#write-command-address1-address2-w-file">Write command [address1[,address2]]w file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#append-command-address-a">Append command [address]a</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#change-command-address1-address2-c">Change command [address1[,address2]]c</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#insert-command-address-i">Insert Command [address]i</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#translate-command-address1-address2-y-list-1-list-2">Translate command [address1[,address2]]y/list-1/list-2/</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#i-command">I command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#quit-command-address-q">Quit Command [address]q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#read-command-address-r-file">Read Command [address]r file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#exectuve-command-address1-address2-e-command">Exectuve Command [address1[,address2]]e [command]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#miscellaneous-commands">Miscellaneous Commands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../awk-tutorial/awk-tutorial.html">awk-tutorial (<code class="docutils literal"><span class="pre">awk-tutorial.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-basic-structure.html">1. Basic structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html">2. The Essential Syntax of AWK</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#unary-arithmetic-operators">2.1. Unary arithmetic operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#the-autoincrement-and-autodecrement-operators">2.2. The Autoincrement and Autodecrement Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#assignment-operators">2.3. Assignment Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#conditional-expressions">2.4. Conditional expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#regular-expressions">2.5. Regular Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#and-or-not">2.6. And/Or/Not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-summary-commands.html">3. Summary of AWK Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html">4. AWK Built-in Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#fs-the-input-field-separator-variable">4.1. FS - The Input Field Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#ofs-the-output-field-separator-variable">4.2. OFS - The Output Field Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#nf-the-number-of-fields-variable">4.3. NF - The Number of Fields Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#nr-the-number-of-records-variable">4.4. NR - The Number of Records Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#rs-the-record-separator-variable">4.5. RS - The Record Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#ors-the-output-record-separator-variable">4.6. ORS - The Output Record Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#filename-the-current-filename-variable">4.7. FILENAME - The Current Filename Variable</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../awk-tp.html">Awk Tutorials Points (<code class="docutils literal"><span class="pre">awk-tp.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../awk-ss64.html">1. Whirlwind tour from ss64</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#basic-syntax">1.1. Basic syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#awk-patterns">1.2. awk-patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#variable-names-that-are-predefined">1.3. Variable names that are predefined</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#examples">1.4. Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#complex-examples">1.5. Complex examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-grymoire.html">2. Tables from grymoire</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#arithmetic-expressions">2.1. Arithmetic expressions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#binary-operator">2.1.1. Binary operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#assignment-operator">2.1.2. Assignment operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#conditional-expressions">2.1.3. Conditional expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#regexp">2.1.4. Regexp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#summary-of-awk-commands">2.2. Summary of AWK commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#build-int-awk-variables">2.3. Build-int AWK variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#printf-formatting">2.4. printf - formatting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#syntax">2.4.1. syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#escape-sequences">2.4.2. Escape sequences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#format-specifiers">2.4.3. Format specifiers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#width-specify-minimum-field-size">2.4.4. Width - specify minimum field size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#my-own-example-use-to-left-justify-string-in-s">2.4.5. my own example (use &#8220;-&#8221; to left justify string in %s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#examples-of-complex-formatting">2.4.6. Examples of complex formatting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#explicit-file-output">2.4.7. Explicit file output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#flow-control-with-next-and-exit">2.5. Flow Control with next and exit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#awk-numerical-functions">2.6. AWK Numerical Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#awk-string-functions">2.7. AWK String functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#split-demo">2.7.1. split demo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#gsub-demo">2.7.2. gsub demo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#match-demo">2.7.3. match demo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tp.workflow.html">3. awk-workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.workflow.html#the-begin-body-end-block">3.1. The BEGIN, body, END block</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.workflow.html#first-example-on-marks-txt-file">3.2. First example on marks.txt file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tp.basic-syntax.html">4. AWK Basic Syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#awk-help">4.1. awk &#8211;help</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#awk-in-the-terminal-or-program-file">4.2. AWK in the terminal or Program file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#v-option">4.3. -v option</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#dump-global-variables">4.4. dump global variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#profile-file-to-create-pretty-printed-script-file">4.5. &#8211;profile[=file] to create pretty-printed script file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tp.basic-examples.html">5. AWK &#8211; Basic Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../top-sqlite.html">SQL notes (<code class="docutils literal"><span class="pre">top-sqlite.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sqlite.tutpoint.html">1. SQLite notes from tutorialpoint</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html">1.1. SQLite commands overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html#ddl-data-definition-language">1.1.1. DDL (data definition language)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html#dml-data-manipulation-language">1.1.2. DML (Data manipulation language)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html#dql-data-query-language">1.1.3. DQL (data query language)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.2_unsupported_commands.html">1.2. Unsupported features in SQLite</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html">1.3. sqlite commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#the-dot-commands-from-sqlite">1.3.1. the <em>dot</em> commands from sqlite</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#show-see-default-settings">1.3.2. show &#8211; see default settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#format-output-with-header-mode-timer">1.3.3. Format output with (header, mode, timer)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#the-sqlite-master-table">1.3.4. The sqlite_master Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html">1.4. SQLite syntax (a whirl-wind tour)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#case-sensitivity">1.4.1. Case Sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#comments">1.4.2. Comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#sqlite-statements-and-clause">1.4.3. SQLite Statements and Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#create-table">1.4.4. CREATE TABLE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#create-trigger">1.4.5. CREATE TRIGGER</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#group-by">1.4.6. GROUP BY</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#having">1.4.7. HAVING</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#pragma">1.4.8. PRAGMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#update">1.4.9. UPDATE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html">1.5. SQLite Data Type</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#sqlite-storage-classes">1.5.1. SQLite Storage Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#sqlite-affinity-type">1.5.2. SQLite Affinity Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#sqlite-affinity-and-type-names">1.5.3. SQLite Affinity and Type Names</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#date-and-time-datatype">1.5.4. Date and Time Datatype</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html">1.6. SQLite DDL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#create-database">1.6.1. CREATE Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#attach-database">1.6.2. ATTACH Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#detach-database">1.6.3. DETACH Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#create-table">1.6.4. CREATE Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#drop-table">1.6.5. DROP Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html">1.7. SQLite DML</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#insert-query">1.7.1. INSERT Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#select-query">1.7.2. SELECT Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#update-query">1.7.3. UPDATE Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#delete-query">1.7.4. DELETE Query</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html">1.8. SQLite clauses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#where-clause">1.8.1. WHERE Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#and-or-clause">1.8.2. AND, OR Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#like-clause">1.8.3. LIKE Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#glob-clause">1.8.4. GLOB Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#limit-clause">1.8.5. LIMIT Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#having-clause">1.8.6. HAVING Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#unions-clause">1.8.7. UNIONS Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#order-by-clause">1.8.8. ORDER BY Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#group-by-clause">1.8.9. GROUP BY Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#distinct-clause-keyword">1.8.10. DISTINCT Clause/keyword</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.8_sqlite_expressions.html">1.9. SQLite Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.8_sqlite_operators.html">1.10. SQLite Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_5.html">1.11. SQLite - useful functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_5.html#summary-of-key-functions">1.11.1. Summary of key functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_5.html#examples">1.11.2. Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sqlite_doc.html">2. Bunch of stuffs from the official doc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#command-line-shell-for-sqlite-incomplete">2.1. Command Line Shell for SQLite (incomplete)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#semicolon-to-indicate-end-of-sql-command">2.1.1. Semicolon to indicate end of SQL command</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#dot-commands-special-commands-to-sqlite3">2.1.2. dot-commands (special commands to sqlite3)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#todo">2.1.3. todo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#sql-syntax-link-only">2.2. SQL Syntax (link only)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#sql-keywords-link-only">2.3. SQL Keywords (link only)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#datatypes-in-sqlite-version3-todo">2.4. Datatypes in SQLite Version3 (todo)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#core-functions-todo">2.5. Core functions (todo)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#agg-functions">2.6. Agg functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#data-and-time-functions">2.7. Data and time functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#timestring">2.7.1. timestring</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#modifiers">2.7.2. modifiers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#examples">2.7.3. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#json-just-read">2.8. JSON (just read)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sql_wiki.html">3. Random jumbles from wikipedia pertaining to Database concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#data-integrity">3.1. Data Integrity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#ddl-dml-dcl">3.2. DDL, DML, DCL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#data-definition-language-ddl">3.2.1. Data definition language (DDL)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#data-manipulation-language-dml">3.2.2. Data Manipulation Language (DML)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#data-control-language-dcl">3.2.3. Data Control Language (DCL)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#acid">3.3. ACID</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#atomicity">3.3.1. Atomicity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#consistency">3.3.2. Consistency</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#isolation">3.3.3. Isolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#durability">3.3.4. Durability</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#jumpled-articles">3.4. Jumpled articles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#consistency-model">3.4.1. Consistency model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#cap-theorem-aka-brewer-s-theorem">3.4.2. CAP Theorem (aka Brewer&#8217;s Theorem)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#database-transaction">3.4.3. Database transaction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#database-normalization">3.5. Database normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#database-schema">3.6. Database Schema</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#logical-schema">3.6.1. Logical schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#physical-schema">3.6.2. Physical schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#conceptual-schema">3.6.3. Conceptual schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#three-schema-approach">3.6.4. Three-schema approach</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#bunch-of-jumbled-links">3.7. Bunch of jumbled links</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cs-computer.html">Random notes relating to computer science (<code class="docutils literal"><span class="pre">cs-computer.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cs-computer.unix.html">Unix-related</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cs-computer.unix.html#terminal-shell-tty-console-the-difference">terminal, shell, tty, console...the difference?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cs-computer.network.html">Network notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cs-computer.network.html#http-messages">HTTP messages</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Coding Notebook</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="top-edx.html">EdX Course Notes (<code class="docutils literal"><span class="pre">top-edx.rst</span></code>)</a> &raquo;</li>
      
    <li>cs105_lab1a codes</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/pyspark/cs105_lab1a_coding.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cs105-lab1a-codes">
<h1>cs105_lab1a codes<a class="headerlink" href="#cs105-lab1a-codes" title="Permalink to this headline"></a></h1>
<div class="contents local topic" id="contents">
<p class="topic-title first"><cite>Contents</cite></p>
<ul class="simple">
<li><a class="reference internal" href="#exercise-overview" id="id1">Exercise Overview</a></li>
<li><a class="reference internal" href="#create-list-of-data" id="id2">Create list of Data</a></li>
<li><a class="reference internal" href="#create-dataframe-from-a-list" id="id3">Create DataFrame from a list</a></li>
<li><a class="reference internal" href="#subtract-one-from-each-the-age-row" id="id4">Subtract one from each the <em>age</em> row</a></li>
<li><a class="reference internal" href="#apply-transformations-and-examine-query-plan" id="id5">Apply transformations, and examine query plan</a></li>
<li><a class="reference internal" href="#use-collect-to-view-results" id="id6">Use <code class="docutils literal"><span class="pre">collect</span></code> to view results</a></li>
<li><a class="reference internal" href="#display-helper-function-in-db" id="id7">display helper function in DB</a></li>
<li><a class="reference internal" href="#more-actions-count-to-get-total" id="id8">More actions: <code class="docutils literal"><span class="pre">count</span></code> to get total</a></li>
<li><a class="reference internal" href="#apply-transformation-filter-and-view-results-with-collect" id="id9">Apply transformation <code class="docutils literal"><span class="pre">filter</span></code> and view results with <code class="docutils literal"><span class="pre">collect</span></code></a></li>
<li><a class="reference internal" href="#lambda-functions-and-udfs" id="id10">Lambda functions and UDFs</a></li>
<li><a class="reference internal" href="#additional-dataframe-actions" id="id11">Additional DataFrame actions</a></li>
<li><a class="reference internal" href="#additional-dataframe-transformations" id="id12">Additional DataFrame transformations</a><ul>
<li><a class="reference internal" href="#orderby" id="id13">orderBy</a></li>
<li><a class="reference internal" href="#a-distinct-and-dropduplicates" id="id14">A <code class="docutils literal"><span class="pre">distinct</span></code> and <code class="docutils literal"><span class="pre">dropDuplicates</span></code></a></li>
<li><a class="reference internal" href="#drop" id="id15">drop</a></li>
<li><a class="reference internal" href="#groupby" id="id16">groupBy</a></li>
<li><a class="reference internal" href="#sample" id="id17">sample</a></li>
</ul>
</li>
<li><a class="reference internal" href="#caching-dataframes-and-storage-options" id="id18">Caching DataFrames and Storage Options</a><ul>
<li><a class="reference internal" href="#unpersist-and-storage-options" id="id19">Unpersist and storage options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#debugging-spark-applications-and-lazy-evaluation" id="id20">Debugging Spark applications and lazy evaluation</a><ul>
<li><a class="reference internal" href="#jvm-and-py4j-how-python-is-executed-in-spark" id="id21">JVM and Py4J - How Python is Executed in Spark</a></li>
<li><a class="reference internal" href="#challenges-with-lazy-evaluation-using-transformations-and-actions" id="id22">Challenges with lazy evaluation using transformations and actions</a></li>
<li><a class="reference internal" href="#finding-the-bug" id="id23">Finding the bug</a></li>
<li><a class="reference internal" href="#moving-toward-expert-style" id="id24">Moving toward expert style</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="exercise-overview">
<h2><a class="toc-backref" href="#id1">Exercise Overview</a><a class="headerlink" href="#exercise-overview" title="Permalink to this headline"></a></h2>
<p>What the following exercise does:</p>
<ul class="simple">
<li>Create a Python collection of 10,000 integers</li>
<li>Create a Spark DataFrame from that collection</li>
<li>Subtract one from each value using <code class="docutils literal"><span class="pre">map</span></code></li>
<li>Perform <strong>action</strong> <code class="docutils literal"><span class="pre">collect</span></code> to view results</li>
<li>Perform <strong>action</strong> <code class="docutils literal"><span class="pre">count</span></code> to view counts</li>
<li>Apply <strong>transformation</strong> <code class="docutils literal"><span class="pre">filter</span></code> and view results with <code class="docutils literal"><span class="pre">collect</span></code></li>
<li>Learn about <strong>lambda functions</strong></li>
<li>Explore how <strong>lazy evaluation</strong> works and the <strong>debugging challenges</strong> that it introduces</li>
</ul>
</div>
<div class="section" id="create-list-of-data">
<h2><a class="toc-backref" href="#id2">Create list of Data</a><a class="headerlink" href="#create-list-of-data" title="Permalink to this headline"></a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">faker</span> <span class="kn">import</span> <span class="n">Factory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fake</span> <span class="o">=</span> <span class="n">Factory</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fake</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">4321</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Each entry consists of last_name, first_name, ssn, job, and age (at least 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fake_entry</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">name</span> <span class="o">=</span> <span class="n">fake</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="k">return</span> <span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fake</span><span class="o">.</span><span class="n">ssn</span><span class="p">(),</span> <span class="n">fake</span><span class="o">.</span><span class="n">job</span><span class="p">(),</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">2016</span> <span class="o">-</span> <span class="n">fake</span><span class="o">.</span><span class="n">date_time</span><span class="p">()</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a helper function to call a function repeatedly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">repeat</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">yield</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">repeat</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="n">fake_entry</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Out[15]: (u&#39;Harvey&#39;, u&#39;Tracey&#39;, u&#39;160-37-9051&#39;, &#39;Agricultural engineer&#39;, 39)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">Out[16]: 10000</span>
</pre></div>
</div>
</div>
<div class="section" id="create-dataframe-from-a-list">
<h2><a class="toc-backref" href="#id3">Create DataFrame from a list</a><a class="headerlink" href="#create-dataframe-from-a-list" title="Permalink to this headline"></a></h2>
<p>Remember, we need to pass a schema as the 2nd argument to <code class="docutils literal"><span class="pre">sqlContext.createDataFrame</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataDF</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;last_name&#39;</span><span class="p">,</span> <span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;ssn&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;type of dataDF: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dataDF</span><span class="p">))</span>
<span class="go">type of dataDF: &lt;class &#39;pyspark.sql.dataframe.DataFrame&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># let&#39;s take a look at the DF&#39;s schema and some of its rows</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataDF</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
<span class="go">root</span>
<span class="go"> |-- last_name: string (nullable = true)</span>
<span class="go"> |-- first_name: string (nullable = true)</span>
<span class="go"> |-- ssn: string (nullable = true)</span>
<span class="go"> |-- occupation: string (nullable = true)</span>
<span class="go"> |-- age: long (nullable = true)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># How many partitions will the DataFrame be split into?</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataDF</span><span class="o">.</span><span class="n">rdd</span><span class="o">.</span><span class="n">getNumPartitions</span><span class="p">()</span>
<span class="go">Out[57]: 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># *register* this DF as a named table (so we can use sql functions on it)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqlContext</span><span class="o">.</span><span class="n">registerDataFrameAsTable</span><span class="p">(</span><span class="n">dataDF</span><span class="p">,</span> <span class="s1">&#39;dataframe&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># show content of DF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataDF</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">(1) Spark Jobs</span>
<span class="go">+----------+----------+-----------+--------------------------------+---+</span>
<span class="go">|last_name |first_name|ssn        |occupation                      |age|</span>
<span class="go">+----------+----------+-----------+--------------------------------+---+</span>
<span class="go">|Harvey    |Tracey    |160-37-9051|Agricultural engineer           |39 |</span>
<span class="go">|Green     |Leslie    |361-94-4342|Teacher, primary school         |26 |</span>
<span class="go">|Lewis     |Tammy     |769-27-5887|Scientific laboratory technician|21 |</span>
<span class="go">|Cunningham|Kathleen  |175-24-7915|Geophysicist/field seismologist |42 |</span>
<span class="go">|Marquez   |Joshua    |310-69-7326|Forensic psychologist           |26 |</span>
<span class="go">+----------+----------+-----------+--------------------------------+---+</span>
<span class="go">only showing top 5 rows</span>
</pre></div>
</div>
</div>
<div class="section" id="subtract-one-from-each-the-age-row">
<h2><a class="toc-backref" href="#id4">Subtract one from each the <em>age</em> row</a><a class="headerlink" href="#subtract-one-from-each-the-age-row" title="Permalink to this headline"></a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Transform dataDF through a select transformation and rename the newly created &#39;(age -1)&#39; column to &#39;age&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Because select is a transformation and Spark uses lazy evaluation, no jobs, stages,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or tasks will be launched when we run this code.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subDF</span> <span class="o">=</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;last_name&#39;</span><span class="p">,</span> <span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;ssn&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">dataDF</span><span class="o">.</span><span class="n">age</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ``show`` is an action, so here job gets launched (so DB shows Spark Jobs dropdown menu)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subDF</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(1) Spark Jobs</span>
<span class="go">Job 53 View(Stages: 1/1)</span>
<span class="go">+----------+----------+-----------+--------------------+---+</span>
<span class="go">| last_name|first_name|        ssn|          occupation|age|</span>
<span class="go">+----------+----------+-----------+--------------------+---+</span>
<span class="go">|    Harvey|    Tracey|160-37-9051|Agricultural engi...| 38|</span>
<span class="go">|     Green|    Leslie|361-94-4342|Teacher, primary ...| 25|</span>
<span class="go">|     Lewis|     Tammy|769-27-5887|Scientific labora...| 20|</span>
<span class="go">|Cunningham|  Kathleen|175-24-7915|Geophysicist/fiel...| 41|</span>
<span class="go">|   Marquez|    Joshua|310-69-7326|Forensic psycholo...| 25|</span>
<span class="go">+----------+----------+-----------+--------------------+---+</span>
</pre></div>
</div>
</div>
<div class="section" id="apply-transformations-and-examine-query-plan">
<span id="cs105-lab1a-queryplancode"></span><h2><a class="toc-backref" href="#id5">Apply transformations, and examine query plan</a><a class="headerlink" href="#apply-transformations-and-examine-query-plan" title="Permalink to this headline"></a></h2>
<p>Query plan can be examined by callined <code class="docutils literal"><span class="pre">df.explain</span></code> method (see <a class="reference internal" href="cs105_lab1a.html#cs105-lab1a-queryplan"><span>Query plans and the Catalyst Optimizer</span></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># apply a transformation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newDF</span> <span class="o">=</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># examine query plan (True = show all stages. Default is to just show the final plan)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newDF</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the output below may look gibberish, but with more experience, you&#39;ll get a handle of these (at least what the tutorial told me...)</span>
<span class="go">== Parsed Logical Plan ==</span>
<span class="go">&#39;Project [*]</span>
<span class="go">+- Aggregate [last_name#8,first_name#9,ssn#10,occupation#11,age#12L], [last_name#8,first_name#9,ssn#10,occupation#11,age#12L]</span>
<span class="go">   +- LogicalRDD [last_name#8,first_name#9,ssn#10,occupation#11,age#12L], MapPartitionsRDD[8] at applySchemaToPythonRDD at NativeMethodAccessorImpl.java:-2</span>

<span class="go">== Analyzed Logical Plan ==</span>
<span class="go">last_name: string, first_name: string, ssn: string, occupation: string, age: bigint</span>
<span class="go">Project [last_name#8,first_name#9,ssn#10,occupation#11,age#12L]</span>
<span class="go">+- Aggregate [last_name#8,first_name#9,ssn#10,occupation#11,age#12L], [last_name#8,first_name#9,ssn#10,occupation#11,age#12L]</span>
<span class="go">   +- LogicalRDD [last_name#8,first_name#9,ssn#10,occupation#11,age#12L], MapPartitionsRDD[8] at applySchemaToPythonRDD at NativeMethodAccessorImpl.java:-2</span>

<span class="go">== Optimized Logical Plan ==</span>
<span class="go">Aggregate [last_name#8,first_name#9,ssn#10,occupation#11,age#12L], [last_name#8,first_name#9,ssn#10,occupation#11,age#12L]</span>
<span class="go">+- LogicalRDD [last_name#8,first_name#9,ssn#10,occupation#11,age#12L], MapPartitionsRDD[8] at applySchemaToPythonRDD at NativeMethodAccessorImpl.java:-2</span>

<span class="go">== Physical Plan ==</span>
<span class="go">TungstenAggregate(key=[last_name#8,first_name#9,ssn#10,occupation#11,age#12L], functions=[], output=[last_name#8,first_name#9,ssn#10,occupation#11,age#12L])</span>
<span class="go">+- TungstenExchange hashpartitioning(last_name#8,first_name#9,ssn#10,occupation#11,age#12L,200), None</span>
<span class="go">   +- TungstenAggregate(key=[last_name#8,first_name#9,ssn#10,occupation#11,age#12L], functions=[], output=[last_name#8,first_name#9,ssn#10,occupation#11,age#12L])</span>
<span class="go">      +- Scan ExistingRDD[last_name#8,first_name#9,ssn#10,occupation#11,age#12L]</span>
</pre></div>
</div>
<p>Repeat by examining query plan for <code class="docutils literal"><span class="pre">subDF</span></code> after subtraction</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">subDF</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="go">== Parsed Logical Plan ==</span>
<span class="go">&#39;Project [unresolvedalias(&#39;last_name),unresolvedalias(&#39;first_name),unresolvedalias(&#39;ssn),unresolvedalias(&#39;occupation),(age#12L - 1) AS age#13]</span>
<span class="go">+- LogicalRDD [last_name#8,first_name#9,ssn#10,occupation#11,age#12L], MapPartitionsRDD[8] at applySchemaToPythonRDD at NativeMethodAccessorImpl.java:-2</span>

<span class="go">== Analyzed Logical Plan ==</span>
<span class="go">last_name: string, first_name: string, ssn: string, occupation: string, age: bigint</span>
<span class="go">Project [last_name#8,first_name#9,ssn#10,occupation#11,(age#12L - cast(1 as bigint)) AS age#13L]</span>
<span class="go">+- LogicalRDD [last_name#8,first_name#9,ssn#10,occupation#11,age#12L], MapPartitionsRDD[8] at applySchemaToPythonRDD at NativeMethodAccessorImpl.java:-2</span>

<span class="go">== Optimized Logical Plan ==</span>
<span class="go">Project [last_name#8,first_name#9,ssn#10,occupation#11,(age#12L - 1) AS age#13L]</span>
<span class="go">+- LogicalRDD [last_name#8,first_name#9,ssn#10,occupation#11,age#12L], MapPartitionsRDD[8] at applySchemaToPythonRDD at NativeMethodAccessorImpl.java:-2</span>

<span class="go">== Physical Plan ==</span>
<span class="go">Project [last_name#8,first_name#9,ssn#10,occupation#11,(age#12L - 1) AS age#13L]</span>
<span class="go">+- Scan ExistingRDD[last_name#8,first_name#9,ssn#10,occupation#11,age#12L]</span>
</pre></div>
</div>
</div>
<div class="section" id="use-collect-to-view-results">
<h2><a class="toc-backref" href="#id6">Use <code class="docutils literal"><span class="pre">collect</span></code> to view results</a><a class="headerlink" href="#use-collect-to-view-results" title="Permalink to this headline"></a></h2>
<div class="admonition-execution-of-collect-with-four-partitions admonition">
<p class="first admonition-title">Execution of <code class="docutils literal"><span class="pre">collect</span></code> with four partitions</p>
<ul class="simple">
<li>Here the dataset is broken into four partitions, so four <code class="docutils literal"><span class="pre">collect()</span></code> tasks are launched.</li>
<li>Each <strong>task</strong> collects the entries in its <strong>partition</strong> and sends the result to the <strong>driver</strong>, which creates a list of the values.</li>
</ul>
<img alt="http://spark-mooc.github.io/web-assets/images/cs105x/diagram-3d.png" class="last align-center" src="http://spark-mooc.github.io/web-assets/images/cs105x/diagram-3d.png" />
</div>
<ul class="simple">
<li>To see a list of elements decremented by one, we need to create a new list on the driver from the the data distributed in the executor nodes.</li>
<li>To do this we can call the <code class="docutils literal"><span class="pre">collect()</span></code> method on our DataFrame.</li>
<li><code class="docutils literal"><span class="pre">collect()</span></code> is often used after transformations to ensure that we are only returning a small amount of data to the driver.<ul>
<li>This is done because the data returned to the driver must fit into the driver&#8217;s available memory. If not, the driver will crash.</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">collect</span></code> is a Spark <code class="docutils literal"><span class="pre">Action</span></code></li>
<li><code class="docutils literal"><span class="pre">Action</span></code> operations cause Spark to perform the (lazy) transformation operations that are required to compute the values returned by the action.</li>
<li>In our example, this means that tasks will now be launched to perform the createDataFrame, select, and collect operations.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Let&#39;s collect the data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">subDF</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">results</span>
<span class="go">(1) Spark Jobs</span>
<span class="go">[Row(last_name=u&#39;Harvey&#39;, first_name=u&#39;Tracey&#39;, ssn=u&#39;160-37-9051&#39;, occupation=u&#39;Agricultural engineer&#39;, age=38), Row(last_name=u&#39;Green&#39;, first_name=u&#39;Leslie&#39;, ssn=u&#39;361-94-4342&#39;, occupation=u&#39;Teacher, primary                               school&#39;, age=25), Row(last_name=u&#39;Lewis&#39;, first_name=u&#39;Tammy&#39;, ssn=u&#39;769-27-5887&#39;, occupation=u&#39;Scientific laboratory technician&#39;, age=20), Row(last_name=u&#39;Cunningham&#39;, first_name=u&#39;Kathleen&#39;, ssn=u&#39;175-24-7915&#39;, occupation=u&#39;Geophysicist/field seismologist&#39;, age=41), Row(last_name=u&#39;Marquez&#39;, first_name=u&#39;Joshua&#39;, ssn=u&#39;310-69-7326&#39;, occupation=u&#39;Forensic psychologist&#39;, age=25), Row(last_name=u&#39;Summers&#39;, first_name=u&#39;Beth&#39;, ssn=u&#39;099-90-9730&#39;, occupation=u&#39;Best boy&#39;, age=42), Row(last_name=u&#39;Jessica&#39;, first_name=u&#39;Mrs.&#39;, ssn=u&#39;476-06-5497&#39;, occupation=u&#39;English as a foreign language teacher&#39;, age=42), Row(last_name=u&#39;Turner&#39;, first_name=u&#39;Diana&#39;, ssn=u&#39;722-09-8354&#39;, occupation=u&#39;Psychologist, prison and probation services&#39;, age=6), Row(last_name=u&#39;Johnson&#39;, first_name=u&#39;Ryan&#39;, ssn=u&#39;715-56-1708&#39;, occupation=u&#39;Sales executive&#39;, age=4), Row(last_name=u&#39;Lewis&#39;, first_name=u&#39;Melissa&#39;, ssn=u&#39;123-48-8354&#39;, occupation=u&#39;Engineer, broadcasting (operations)&#39;, age=16), Row(last_name=u&#39;Hernandez&#39;, first_name=u&#39;Benjamin&#39;, ssn=u&#39;293-22-0265&#39;, occupation=u&#39;Scientist, product/process deve</span>
<span class="gp">...</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ``collect()`` create a list of Row objects...print each row at a time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="k">print</span> <span class="n">_i</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="n">_i</span><span class="p">]</span>
<span class="go">0 Row(last_name=u&#39;Harvey&#39;, first_name=u&#39;Tracey&#39;, ssn=u&#39;160-37-9051&#39;, occupation=u&#39;Agricultural engineer&#39;, age=38)</span>
<span class="go">1 Row(last_name=u&#39;Green&#39;, first_name=u&#39;Leslie&#39;, ssn=u&#39;361-94-4342&#39;, occupation=u&#39;Teacher, primary school&#39;, age=25)</span>
<span class="go">2 Row(last_name=u&#39;Lewis&#39;, first_name=u&#39;Tammy&#39;, ssn=u&#39;769-27-5887&#39;, occupation=u&#39;Scientific laboratory technician&#39;, age=20)</span>
<span class="go">3 Row(last_name=u&#39;Cunningham&#39;, first_name=u&#39;Kathleen&#39;, ssn=u&#39;175-24-7915&#39;, occupation=u&#39;Geophysicist/field seismologist&#39;, age=41)</span>
<span class="go">4 Row(last_name=u&#39;Marquez&#39;, first_name=u&#39;Joshua&#39;, ssn=u&#39;310-69-7326&#39;, occupation=u&#39;Forensic psychologist&#39;, age=25)</span>
<span class="go">5 Row(last_name=u&#39;Summers&#39;, first_name=u&#39;Beth&#39;, ssn=u&#39;099-90-9730&#39;, occupation=u&#39;Best boy&#39;, age=42)</span>
<span class="go">6 Row(last_name=u&#39;Jessica&#39;, first_name=u&#39;Mrs.&#39;, ssn=u&#39;476-06-5497&#39;, occupation=u&#39;English as a foreign language teacher&#39;, age=42)</span>
<span class="go">7 Row(last_name=u&#39;Turner&#39;, first_name=u&#39;Diana&#39;, ssn=u&#39;722-09-8354&#39;, occupation=u&#39;Psychologist, prison and probation services&#39;, age=6)</span>
<span class="go">8 Row(last_name=u&#39;Johnson&#39;, first_name=u&#39;Ryan&#39;, ssn=u&#39;715-56-1708&#39;, occupation=u&#39;Sales executive&#39;, age=4)</span>
<span class="go">9 Row(last_name=u&#39;Lewis&#39;, first_name=u&#39;Melissa&#39;, ssn=u&#39;123-48-8354&#39;, occupation=u&#39;Engineer, broadcasting (operations)&#39;, age=16)</span>
<span class="go">10 Row(last_name=u&#39;Hernandez&#39;, first_name=u&#39;Benjamin&#39;, ssn=u&#39;293-22-0265&#39;, occupation=u&#39;Scientist, product/process development&#39;, age=28)</span>
</pre></div>
</div>
</div>
<div class="section" id="display-helper-function-in-db">
<h2><a class="toc-backref" href="#id7">display helper function in DB</a><a class="headerlink" href="#display-helper-function-in-db" title="Permalink to this headline"></a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">display</span><span class="p">(</span><span class="n">subDF</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/db_display_df.png" class="align-center" src="../_images/db_display_df.png" />
</div>
<div class="section" id="more-actions-count-to-get-total">
<h2><a class="toc-backref" href="#id8">More actions: <code class="docutils literal"><span class="pre">count</span></code> to get total</a><a class="headerlink" href="#more-actions-count-to-get-total" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal"><span class="pre">count()</span></code> action will count the number of elements in a DataFrame.</p>
<ul class="simple">
<li>Because <code class="docutils literal"><span class="pre">count()</span></code> is an action operation, if we had not already performed an action with <code class="docutils literal"><span class="pre">collect()</span></code>, then Spark would now perform the transformation operations when we executed <code class="docutils literal"><span class="pre">count()</span></code>.</li>
<li>Each task counts the entries in its partition and sends the result to your SparkContext, which adds up all of the counts.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># two actions here, so 2 spark jobs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">subDF</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">10000</span>
<span class="go">10000</span>
</pre></div>
</div>
<div class="admonition-figure-shows-what-would-happen-if-we-ran-count-on-a-small-example-dataset-with-just-four-partitions admonition">
<p class="first admonition-title">Figure shows what would happen if we ran <code class="docutils literal"><span class="pre">count()</span></code> on a small example dataset with just four partitions</p>
<img alt="http://spark-mooc.github.io/web-assets/images/cs105x/diagram-3e.png" class="last align-center" src="http://spark-mooc.github.io/web-assets/images/cs105x/diagram-3e.png" />
</div>
</div>
<div class="section" id="apply-transformation-filter-and-view-results-with-collect">
<h2><a class="toc-backref" href="#id9">Apply transformation <code class="docutils literal"><span class="pre">filter</span></code> and view results with <code class="docutils literal"><span class="pre">collect</span></code></a><a class="headerlink" href="#apply-transformation-filter-and-view-results-with-collect" title="Permalink to this headline"></a></h2>
<div class="admonition-how-filter-might-work-on-a-small-four-partition-dataset admonition">
<p class="first admonition-title">How <code class="docutils literal"><span class="pre">filter</span></code> might work on a small four-partition dataset.</p>
<img alt="http://spark-mooc.github.io/web-assets/images/cs105x/diagram-3f.png" class="last align-center" src="http://spark-mooc.github.io/web-assets/images/cs105x/diagram-3f.png" />
</div>
<p>Let&#8217;s create a new DF that only contains people whose ages are less than 10</p>
<ul class="simple">
<li>You can also use <code class="docutils literal"><span class="pre">where()</span></code>, an alias for <code class="docutils literal"><span class="pre">filter()</span></code>, if you prefer something more SQL-like</li>
<li>to view the filtered list of elements less than 10, we need to create a new list on the driver from the distributed data on the executor nodes.</li>
<li>We use the <code class="docutils literal"><span class="pre">collect()</span></code> method to return a list that contains all of the elements in this filtered DataFrame to the driver program.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filteredDF</span> <span class="o">=</span> <span class="n">subDF</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">subDF</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filteredDF</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filteredDF</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">+---------+----------+-----------+-------------------------------------------+---+</span>
<span class="go">|last_name|first_name|ssn        |occupation                                 |age|</span>
<span class="go">+---------+----------+-----------+-------------------------------------------+---+</span>
<span class="go">|Turner   |Diana     |722-09-8354|Psychologist, prison and probation services|6  |</span>
<span class="go">|Johnson  |Ryan      |715-56-1708|Sales executive                            |4  |</span>
<span class="go">|Andrade  |Sophia    |386-07-6013|Social research officer, government        |5  |</span>
<span class="go">|Arnold   |Heather   |737-44-0894|Economist                                  |7  |</span>
<span class="go">|Joshua   |Mr.       |363-83-5358|Hotel manager                              |8  |</span>
<span class="go">+---------+----------+-----------+-------------------------------------------+---+</span>
<span class="go">only showing top 5 rows</span>

<span class="go">Out[33]: 2084</span>
</pre></div>
</div>
</div>
<div class="section" id="lambda-functions-and-udfs">
<h2><a class="toc-backref" href="#id10">Lambda functions and UDFs</a><a class="headerlink" href="#lambda-functions-and-udfs" title="Permalink to this headline"></a></h2>
<p>Python supports the use of small one-line anonymous functions that are not bound to a name at runtime.</p>
<ul class="simple">
<li>lambda functions, borrowed from LISP, can be used wherever function objects are required.</li>
<li>They are syntactically restricted to a single expression.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Remember that lambda functions are a matter of style and using them is never required - semantically, they are just syntactic sugar for a normal function definition. You can always define a separate normal function instead, but using a lambda function is an equivalent and more compact form of coding.</p>
</div>
<ul class="simple">
<li>Ideally you should consider using lambda functions where you want to encapsulate non-reusable code without littering your code with one-line functions.</li>
<li>Here, instead of defining a separate function for the <code class="docutils literal"><span class="pre">filter()</span></code> transformation, we will use an inline <code class="docutils literal"><span class="pre">lambda()</span></code> function and we will register that lambda as a Spark <strong>User Defined Function (UDF)</strong>.</li>
<li>A <strong>UDF</strong> is a special wrapper around a function, allowing the function to be used in a DataFrame query.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="n">BooleanType</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Let&#39;s collect the even values less than 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">less_ten</span> <span class="o">=</span> <span class="n">udf</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BooleanType</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambdaDF</span> <span class="o">=</span> <span class="n">subDF</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">less_ten</span><span class="p">(</span><span class="n">subDF</span><span class="o">.</span><span class="n">age</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambdaDF</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambdaDF</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">+---------+----------+-----------+--------------------+---+</span>
<span class="go">|last_name|first_name|        ssn|          occupation|age|</span>
<span class="go">+---------+----------+-----------+--------------------+---+</span>
<span class="go">|   Turner|     Diana|722-09-8354|Psychologist, pri...|  6|</span>
<span class="go">|  Johnson|      Ryan|715-56-1708|     Sales executive|  4|</span>
<span class="go">|  Andrade|    Sophia|386-07-6013|Social research o...|  5|</span>
<span class="go">|   Arnold|   Heather|737-44-0894|           Economist|  7|</span>
<span class="go">|   Joshua|       Mr.|363-83-5358|       Hotel manager|  8|</span>
<span class="go">+---------+----------+-----------+--------------------+---+</span>
<span class="go">only showing top 5 rows</span>

<span class="go">Out[55]: 2084</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Let&#39;s collect the even values less than 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">even</span> <span class="o">=</span> <span class="n">udf</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">BooleanType</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evenDF</span> <span class="o">=</span> <span class="n">lambdaDF</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">even</span><span class="p">(</span><span class="n">lambdaDF</span><span class="o">.</span><span class="n">age</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evenDF</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evenDF</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">+---------+----------+-----------+--------------------+---+</span>
<span class="go">|last_name|first_name|        ssn|          occupation|age|</span>
<span class="go">+---------+----------+-----------+--------------------+---+</span>
<span class="go">|   Turner|     Diana|722-09-8354|Psychologist, pri...|  6|</span>
<span class="go">|  Johnson|      Ryan|715-56-1708|     Sales executive|  4|</span>
<span class="go">|   Joshua|       Mr.|363-83-5358|       Hotel manager|  8|</span>
<span class="go">|    Kelly|     Tracy|082-13-6448|Architectural tec...|  8|</span>
<span class="go">|   Church|     David|370-59-5122|Museum education ...|  6|</span>
<span class="go">+---------+----------+-----------+--------------------+---+</span>
<span class="go">only showing top 5 rows</span>

<span class="go">Out[57]: 993</span>
</pre></div>
</div>
</div>
<div class="section" id="additional-dataframe-actions">
<h2><a class="toc-backref" href="#id11">Additional DataFrame actions</a><a class="headerlink" href="#additional-dataframe-actions" title="Permalink to this headline"></a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that for the first() and take() actions, the elements that are returned depend on how the DataFrame is partitioned.</p>
</div>
<ul class="simple">
<li>Instead of using the <code class="docutils literal"><span class="pre">collect()</span></code> action, we can use the <code class="docutils literal"><span class="pre">take(n)</span></code> action to return the first n elements of the DataFrame.</li>
<li>The <code class="docutils literal"><span class="pre">first()</span></code> action returns the first element of a DataFrame, and is equivalent to <code class="docutils literal"><span class="pre">take(1)[0]</span></code>.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s2">&quot;first: {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filteredDF</span><span class="o">.</span><span class="n">first</span><span class="p">())</span>
<span class="go">&gt;&gt;&gt; print &quot;Four of them: {0}\n&quot;.format(filteredDF.take(4))</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">first: Row(last_name=u&#39;Turner&#39;, first_name=u&#39;Diana&#39;, ssn=u&#39;722-09-8354&#39;, occupation=u&#39;Psychologist, prison and probation services&#39;, age=6)</span>

<span class="go">Four of them: [Row(last_name=u&#39;Turner&#39;, first_name=u&#39;Diana&#39;, ssn=u&#39;722-09-8354&#39;, occupation=u&#39;Psychologist, prison and probation services&#39;, age=6), Row(last_name=u&#39;Johnson&#39;, first_name=u&#39;Ryan&#39;, ssn=u&#39;715-56-1708&#39;, occupation=u&#39;Sales executive&#39;, age=4), Row(last_name=u&#39;Andrade&#39;, first_name=u&#39;Sophia&#39;, ssn=u&#39;386-07-6013&#39;, occupation=u&#39;Social research officer, government&#39;, age=5), Row(last_name=u&#39;Arnold&#39;, first_name=u&#39;Heather&#39;, ssn=u&#39;737-44-0894&#39;, occupation=u&#39;Economist&#39;, age=7)]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># for better presentation (on DB notebook)</span>
<span class="go">display(filteredDF.take(4))</span>
</pre></div>
</div>
</div>
<div class="section" id="additional-dataframe-transformations">
<h2><a class="toc-backref" href="#id12">Additional DataFrame transformations</a><a class="headerlink" href="#additional-dataframe-transformations" title="Permalink to this headline"></a></h2>
<div class="section" id="orderby">
<h3><a class="toc-backref" href="#id13">orderBy</a><a class="headerlink" href="#orderby" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the five oldest people in the list. To do that, sort by age in descending order.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#display(dataDF.orderBy(dataDF.age.desc()).take(5))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">dataDF</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="k">print</span> <span class="n">_</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">Row(last_name=u&#39;Smith&#39;, first_name=u&#39;Jessica&#39;, ssn=u&#39;371-59-8543&#39;, occupation=u&#39;Medical physicist&#39;, age=47)</span>
<span class="go">Row(last_name=u&#39;Blankenship&#39;, first_name=u&#39;Crystal&#39;, ssn=u&#39;341-29-9523&#39;, occupation=u&#39;Commercial/residential surveyor&#39;, age=47)</span>
<span class="go">Row(last_name=u&#39;Meyer&#39;, first_name=u&#39;Christine&#39;, ssn=u&#39;803-59-5869&#39;, occupation=u&#39;Early years teacher&#39;, age=47)</span>
<span class="go">Row(last_name=u&#39;George&#39;, first_name=u&#39;Wesley&#39;, ssn=u&#39;622-72-1540&#39;, occupation=u&#39;Therapist, art&#39;, age=47)</span>
<span class="go">Row(last_name=u&#39;Davila&#39;, first_name=u&#39;Steven&#39;, ssn=u&#39;479-63-8770&#39;, occupation=u&#39;Purchasing manager&#39;, age=47)</span>
</pre></div>
</div>
</div>
<div class="section" id="a-distinct-and-dropduplicates">
<h3><a class="toc-backref" href="#id14">A <code class="docutils literal"><span class="pre">distinct</span></code> and <code class="docutils literal"><span class="pre">dropDuplicates</span></code></a><a class="headerlink" href="#a-distinct-and-dropduplicates" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal"><span class="pre">distinct()</span></code> filters out duplicate rows, and it considers all columns.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># since the data is randomly generated, very likely there&#39;s no duplicates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">10000</span>
<span class="go">10000</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># a quick demonstration of distinct</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tempDF</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="s2">&quot;Joe&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Joe&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Anna&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Anna&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Ravi&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)],</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tempDF</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">+----+-----+</span>
<span class="go">|name|score|</span>
<span class="go">+----+-----+</span>
<span class="go">| Joe|    1|</span>
<span class="go">| Joe|    1|</span>
<span class="go">|Anna|   15|</span>
<span class="go">|Anna|   12|</span>
<span class="go">|Ravi|    5|</span>
<span class="go">+----+-----+</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tempDF</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># note anna row was kept since score wasn&#39; the same</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">+----+-----+</span>
<span class="go">|name|score|</span>
<span class="go">+----+-----+</span>
<span class="go">|Ravi|    5|</span>
<span class="go">|Anna|   12|</span>
<span class="go">|Anna|   15|</span>
<span class="go">| Joe|    1|</span>
<span class="go">+----+-----+</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">dropDuplicates()</span></code> is like <code class="docutils literal"><span class="pre">distinct()</span></code>, except that it <strong>allows us to specify the columns to compare</strong>.</p>
<p>For instance, we can use it to drop all rows where the first name and last name duplicates (ignoring the occupation and age columns).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">dropDuplicates</span><span class="p">([</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">10000</span>
<span class="go">9352</span>
</pre></div>
</div>
</div>
<div class="section" id="drop">
<h3><a class="toc-backref" href="#id15">drop</a><a class="headerlink" href="#drop" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal"><span class="pre">drop()</span></code> is like the opposite of <code class="docutils literal"><span class="pre">select()</span></code>: Instead of selecting specific columns from a DataFrame, it drops a specifed column from a DataFrame.</p>
<ul class="simple">
<li>A simple use case: get rid of 5 columns from 1000 columned CSV table.</li>
<li>Instead of selecting 995 of the columns, it&#8217;s easier just to drop the five you don&#8217;t want.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataDF</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;occupation&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">(1) Spark Jobs</span>
<span class="go">+----------+----------+-----------+</span>
<span class="go">| last_name|first_name|        ssn|</span>
<span class="go">+----------+----------+-----------+</span>
<span class="go">|    Harvey|    Tracey|160-37-9051|</span>
<span class="go">|     Green|    Leslie|361-94-4342|</span>
<span class="go">|     Lewis|     Tammy|769-27-5887|</span>
<span class="go">|Cunningham|  Kathleen|175-24-7915|</span>
<span class="go">|   Marquez|    Joshua|310-69-7326|</span>
<span class="go">|   Summers|      Beth|099-90-9730|</span>
<span class="go">|   Jessica|      Mrs.|476-06-5497|</span>
<span class="go">|    Turner|     Diana|722-09-8354|</span>
<span class="go">|   Johnson|      Ryan|715-56-1708|</span>
<span class="go">|     Lewis|   Melissa|123-48-8354|</span>
<span class="go">| Hernandez|  Benjamin|293-22-0265|</span>
<span class="go">|     Dixon| Stephanie|041-23-3263|</span>
<span class="go">|       Kim|      Leah|725-61-1132|</span>
<span class="go">|    Snyder|    Leslie|268-79-4330|</span>
<span class="go">|    Ortega|   Kenneth|077-96-8349|</span>
<span class="go">|    Barnes|     Ricky|061-88-1648|</span>
<span class="go">|     Adams|    Robert|582-28-0099|</span>
<span class="go">|   Andrade|    Sophia|386-07-6013|</span>
<span class="go">|     Weeks| Catherine|363-94-7993|</span>
<span class="go">|     Tapia|    Thomas|386-39-5490|</span>
<span class="go">+----------+----------+-----------+</span>
<span class="go">only showing top 20 rows</span>
</pre></div>
</div>
</div>
<div class="section" id="groupby">
<h3><a class="toc-backref" href="#id16">groupBy</a><a class="headerlink" href="#groupby" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal"><span class="pre">groupBy()</span></code> is one of the most powerful transformations. It allows you to perform aggregations on a DataFrame.
- Unlike other DataFrame transformations, <code class="docutils literal"><span class="pre">groupBy()</span></code> does not return a DataFrame.</p>
<blockquote>
<div><ul class="simple">
<li>Instead, it returns a special <code class="docutils literal"><span class="pre">GroupedData</span></code> object that contains various aggregation functions.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li>The most commonly used aggregation function is <code class="docutils literal"><span class="pre">count()</span></code>, but there are others &#8212; like <code class="docutils literal"><span class="pre">sum()</span></code>, <code class="docutils literal"><span class="pre">max()</span></code>, and <code class="docutils literal"><span class="pre">avg()</span></code>.</li>
<li>These aggregation functions typically create a new column and return a new DataFrame.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataDF</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;occupation&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">(1) Spark Jobs</span>
<span class="go">+------------------------+-----+</span>
<span class="go">|occupation              |count|</span>
<span class="go">+------------------------+-----+</span>
<span class="go">|Agricultural engineer   |9    |</span>
<span class="go">|Operational researcher  |17   |</span>
<span class="go">|Textile designer        |11   |</span>
<span class="go">|Public relations officer|20   |</span>
<span class="go">|Politician&#39;s assistant  |11   |</span>
<span class="go">+------------------------+-----+</span>
<span class="go">only showing top 5 rows</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dataDF</span><span class="o">.</span><span class="n">groupBy</span><span class="p">()</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">(1) Spark Jobs</span>
<span class="go">+--------+</span>
<span class="go">|avg(age)|</span>
<span class="go">+--------+</span>
<span class="go">|24.3803 |</span>
<span class="go">+--------+</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We can also use groupBy() to do aother useful aggregations:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s2">&quot;Maximum age: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dataDF</span><span class="o">.</span><span class="n">groupBy</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s2">&quot;Minimum age: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dataDF</span><span class="o">.</span><span class="n">groupBy</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">Maximum age: 47</span>
<span class="go">Minimum age: 1</span>
</pre></div>
</div>
</div>
<div class="section" id="sample">
<h3><a class="toc-backref" href="#id17">sample</a><a class="headerlink" href="#sample" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sampledDF</span> <span class="o">=</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">withReplacement</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">sampledDF</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampledDF</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">1028</span>
<span class="go">+---------+----------+-----------+--------------------+---+</span>
<span class="go">|last_name|first_name|        ssn|          occupation|age|</span>
<span class="go">+---------+----------+-----------+--------------------+---+</span>
<span class="go">|    Lewis|     Tammy|769-27-5887|Scientific labora...| 21|</span>
<span class="go">|  Jessica|      Mrs.|476-06-5497|English as a fore...| 43|</span>
<span class="go">|   Snyder|    Leslie|268-79-4330|        Chiropractor| 15|</span>
<span class="go">|    Adams|    Robert|582-28-0099|Manufacturing sys...| 12|</span>
<span class="go">|   Arnold|   Heather|737-44-0894|           Economist|  8|</span>
<span class="go">|     Bird|    Curtis|790-03-8999|     Psychotherapist| 27|</span>
<span class="go">|     Love|      Gary|117-61-4564|         Music tutor| 15|</span>
<span class="go">|  Gardner|   Charles|695-93-4517|Conference centre...| 35|</span>
<span class="go">+---------+----------+-----------+--------------------+---+</span>
<span class="go">only showing top 8 rows</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">withReplacement</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">(1) Spark Jobs</span>
<span class="go">538</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="caching-dataframes-and-storage-options">
<h2><a class="toc-backref" href="#id18">Caching DataFrames and Storage Options</a><a class="headerlink" href="#caching-dataframes-and-storage-options" title="Permalink to this headline"></a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span>For efficiency Spark keeps your DataFrames in memory. (More formally, it keeps the RDDs that implement your DataFrames in memory.) By keeping the contents in memory, Spark can quickly access the data. However, memory is limited, so if you try to keep too many partitions in memory, Spark will automatically delete partitions from memory to make space for new ones. If you later refer to one of the deleted partitions, Spark will automatically recreate it for you, but that takes time.
So, if you plan to use a DataFrame more than once, then you should tell Spark to cache it. You can use the cache() operation to keep the DataFrame in memory. However, you must still trigger an action on the DataFrame, such as collect() or count() before the caching will occur. In other words, cache() is lazy: It merely tells Spark that the DataFrame should be cached when the data is materialized. You have to run an action to materialize the data; the DataFrame will be cached as a side effect. The next time you use the DataFrame, Spark will use the cached data, rather than recomputing the DataFrame from the original data.
You can see your cached DataFrame in the &quot;Storage&quot; section of the Spark web UI. If you click on the name value, you can see more information about where the the DataFrame is stored.
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Cache the DataFrame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filteredDF</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Trigger an action</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">filteredDF</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check if it is cached</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">filteredDF</span><span class="o">.</span><span class="n">is_cached</span>
<span class="go">(1) Spark Jobs</span>
<span class="go">2084</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="section" id="unpersist-and-storage-options">
<h3><a class="toc-backref" href="#id19">Unpersist and storage options</a><a class="headerlink" href="#unpersist-and-storage-options" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span>Spark automatically manages the partitions cached in memory. If it has more partitions than available memory, by default, it will evict older partitions to make room for new ones. For efficiency, once you are finished using cached DataFrame, you can optionally tell Spark to stop caching it in memory by using the DataFrame&#39;s unpersist() method to inform Spark that you no longer need the cached data.

Advanced: Spark provides many more options for managing how DataFrames cached. For instance, you can tell Spark to spill cached partitions to disk when it runs out of memory, instead of simply throwing old ones away. You can explore the API for DataFrame&#39;s persist() operation using Python&#39;s help() command. The persist() operation, optionally, takes a pySpark StorageLevel object.
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># If we are done with the DataFrame we can unpersist it so that its memory can be reclaimed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filteredDF</span><span class="o">.</span><span class="n">unpersist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check if it is cached</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">filteredDF</span><span class="o">.</span><span class="n">is_cached</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="debugging-spark-applications-and-lazy-evaluation">
<h2><a class="toc-backref" href="#id20">Debugging Spark applications and lazy evaluation</a><a class="headerlink" href="#debugging-spark-applications-and-lazy-evaluation" title="Permalink to this headline"></a></h2>
<div class="section" id="jvm-and-py4j-how-python-is-executed-in-spark">
<h3><a class="toc-backref" href="#id21">JVM and Py4J - How Python is Executed in Spark</a><a class="headerlink" href="#jvm-and-py4j-how-python-is-executed-in-spark" title="Permalink to this headline"></a></h3>
<p>Internally, Spark executes using a Java Virtual Machine (JVM). pySpark runs Python code in a JVM using <a class="reference external" href="http://py4j.sourceforge.net/">Py4J</a>. Py4J enables Python programs running in a Python interpreter to dynamically access Java objects in a Java Virtual Machine. Methods are called as if the Java objects resided in the Python interpreter and Java collections can be accessed through standard Python collection methods. Py4J also enables Java programs to call back Python objects.</p>
<p>Because pySpark uses Py4J, coding errors often result in a complicated, confusing stack trace that can be difficult to understand. In the following section, we&#8217;ll explore how to understand stack traces.</p>
</div>
<div class="section" id="challenges-with-lazy-evaluation-using-transformations-and-actions">
<h3><a class="toc-backref" href="#id22">Challenges with lazy evaluation using transformations and actions</a><a class="headerlink" href="#challenges-with-lazy-evaluation-using-transformations-and-actions" title="Permalink to this headline"></a></h3>
<p>Spark&#8217;s use of lazy evaluation can make debugging more difficult because code is not always executed immediately. To see an example of how this can happen, let&#8217;s first define a broken filter function. Next we perform a filter() operation using the broken filtering function. No error will occur at this point due to Spark&#8217;s use of lazy evaluation.</p>
<p>The filter() method will not be executed until an action operation is invoked on the DataFrame. We will perform an action by using the count() method to return a list that contains all of the elements in this DataFrame.</p>
</div>
<div class="section" id="finding-the-bug">
<h3><a class="toc-backref" href="#id23">Finding the bug</a><a class="headerlink" href="#finding-the-bug" title="Permalink to this headline"></a></h3>
<p>When the filter() method is executed, Spark calls the UDF. Since our UDF has an error in the underlying filtering function brokenTen(), an error occurs.
Scroll through the output &#8220;Py4JJavaError Traceback (most recent call last)&#8221; part of the cell and first you will see that the line that generated the error is the count() method line. There is nothing wrong with this line. However, it is an action and that caused other methods to be executed. Continue scrolling through the Traceback and you will see the following error line:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>NameError: global name &#39;val&#39; is not defined
</pre></div>
</div>
<p>Looking at this error line, we can see that we used the wrong variable name in our filtering function brokenTen().</p>
</div>
<div class="section" id="moving-toward-expert-style">
<h3><a class="toc-backref" href="#id24">Moving toward expert style</a><a class="headerlink" href="#moving-toward-expert-style" title="Permalink to this headline"></a></h3>
<p>As you are learning Spark, I recommend that you write your code in the form:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">transformation1</span><span class="p">()</span>
<span class="n">df2</span><span class="o">.</span><span class="n">action1</span><span class="p">()</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">transformation2</span><span class="p">()</span>
<span class="n">df3</span><span class="o">.</span><span class="n">action2</span><span class="p">()</span>
</pre></div>
</div>
<p>Using this style will make debugging your code much easier as it makes errors easier to localize - errors in your transformations will occur when the next action is executed.</p>
<p>Once you become more experienced with Spark, you can write your code with the form: <code class="docutils literal"><span class="pre">df.transformation1().transformation2().action()</span></code></p>
<p>We can also use <code class="docutils literal"><span class="pre">lambda()</span></code> functions instead of separately defined functions when their use improves readability and conciseness.</p>
<p>To make the expert coding style more readable, enclose the statement in parentheses and put each method, transformation, or action on a separate line.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Final version</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dataDF</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">dataDF</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="n">dataDF</span><span class="o">.</span><span class="n">first_name</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">),</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">last_name</span><span class="p">),</span> <span class="n">dataDF</span><span class="o">.</span><span class="n">occupation</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="p">)</span>
<span class="go">(1) Spark Jobs</span>
<span class="go">+------------------------------+--------------------------------+</span>
<span class="go">|concat(first_name, ,last_name)|occupation                      |</span>
<span class="go">+------------------------------+--------------------------------+</span>
<span class="go">|Tracey Harvey                 |Agricultural engineer           |</span>
<span class="go">|Leslie Green                  |Teacher, primary school         |</span>
<span class="go">|Tammy Lewis                   |Scientific laboratory technician|</span>
<span class="go">|Kathleen Cunningham           |Geophysicist/field seismologist |</span>
<span class="go">|Joshua Marquez                |Forensic psychologist           |</span>
<span class="go">+------------------------------+--------------------------------+</span>
<span class="go">only showing top 5 rows</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cs105_lab1b.html" class="btn btn-neutral float-right" title="cs105_lab1b_wordcount" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cs105_lab1a.html" class="btn btn-neutral" title="cs105_lab1a" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Takanori Watanabe.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>