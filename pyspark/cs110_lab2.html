

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cs110_lab2_als_prediction</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon-umich.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/my_theme.css" type="text/css" />
  

  

  
    <link rel="top" title="" href="../index.html"/>
        <link rel="up" title="EdX Course Notes (top-edx.rst)" href="top-edx.html"/>
        <link rel="next" title="cs110_lab3a_word_count_rdd" href="cs110_lab3a.html"/>
        <link rel="prev" title="cs110_lab1_power_plant_ml_pipeline" href="cs110_lab1.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Coding Notebook
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="top-pyspark.html">PySpark Notes (<code class="docutils literal"><span class="pre">top-pyspark.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyspark-snippet.html">1. <code class="docutils literal"><span class="pre">pyspark-snippet.rst</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#modules">1.1. Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#create-toy-dataset">1.2. Create toy dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#databrick-helper-function-displaying-all-dfs-in-the-notebook">1.3. Databrick helper function displaying all DFs in the notebook</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#get-shape-of-df-gotta-be-a-better-way">1.4. Get shape of DF (gotta be a better way)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-prog-guide1.html">2. (TODO) Pyspark Programming Guide DataFrames and SQL <code class="docutils literal"><span class="pre">pyspark-prog-guide1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-prog-guide2.html">3. Pyspark Programming Guide DataFrames and SQL <code class="docutils literal"><span class="pre">pyspark-prog-guide2</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#overview">3.1. Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#sql">3.1.1. SQL</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#datasets-and-dataframes">3.1.2. Datasets and DataFrames</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#getting-started">3.2. Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#starting-point-sparksession">3.2.1. Starting Point: <code class="docutils literal"><span class="pre">SparkSession</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#creating-dataframes">3.2.2. Creating DataFrames</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#untyped-dataset-operations-aka-dataframe-operations">3.2.3. Untyped Dataset Operations (aka DataFrame Operations)</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#running-sql-queries-programmatically">3.2.4. Running SQL Queries Programmatically</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#creating-datasets-only-in-scala-java">3.2.5. Creating Datasets (only in Scala/Java)</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#interoperating-with-rdds">3.2.6. Interoperating with RDDs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#data-sources">3.3. Data Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#generic-load-functions">3.4. Generic Load Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#default-parquet">3.4.1. Default (parquet)</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#manually-specifying-options">3.4.2. Manually Specifying Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#run-sql-on-files-directly">3.4.3. Run SQL on files directly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#generic-save-functions">3.5. Generic Save Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#save-modes">3.5.1. Save Modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#saving-to-persistent-tables">3.5.2. __Saving to Persistent Tables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#parquet-files">3.6. Parquet Files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#loading-data-programmatically">3.6.1. Loading Data Programmatically</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#partition-discovery">3.6.2. __Partition Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#schema-merging">3.6.3. Schema Merging</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#hive-metastore-parquet-conversion">3.6.4. __Hive metastore Parquet Conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#configuration">3.6.5. Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#json-datasets">3.7. JSON Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#hive-tables">3.8. Hive Tables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#interacting-with-different-versions-of-hive-metastore">3.8.1. __Interacting with Different Versions of Hive Metastore</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#jdbc-to-other-databases">3.9. __JDBC To Other Databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#performance-tuning">3.10. Performance Tuning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#caching-data-in-memory">3.10.1. Caching Data in Memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#other-configuration-options">3.10.2. Other Configuration Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#distributed-sql-engine">3.11. Distributed SQL Engine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#running-the-thrift-jdbc-odbc-server">3.11.1. __Running the Thrift JDBC/ODBC server</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#running-the-spark-sql-cli">3.11.2. Running the Spark SQL CLI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-prog-guide2.html#reference">3.12. Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#data-types">3.12.1. Data-Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-prog-guide2.html#nan-semantics">3.12.2. NaN Semantics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-ml-guide.html">4. spark.ml prog-guide <code class="docutils literal"><span class="pre">pyspark-ml-guide</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-ml-guide.html#main-concepts-in-pipelines">4.1. Main concepts in Pipelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-ml-guide.html#dataframe">4.2. DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-ml-guide.html#pipeline-components">4.3. Pipeline components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-ml-guide.html#transformers">4.3.1. Transformers</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-ml-guide.html#estimators">4.3.2. Estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-ml-guide.html#properties-of-pipeline-components">4.3.3. Properties of pipeline components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-ml-guide.html#pipeline-transformers-and-estimators">4.4. Pipeline (transformers and estimators)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-ml-guide.html#how-it-works">4.4.1. How it works</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-ml-guide.html#details">4.4.2. Details</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-ml-guide.html#parameters">4.5. Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-ml-guide.html#saving-and-loading-pipelines">4.6. Saving and Loading Pipelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-ml-guide.html#code-examples">4.7. Code Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-ml-guide.html#estimator-transformer-and-param">4.7.1. Estimator, Transformer, and Param</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-ml-guide.html#example-pipeline">4.7.2. Example: Pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-ml-guide.html#example-model-selection-via-cv-scala">4.7.3. Example: model selection via CV (Scala)</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-ml-guide.html#example-model-selection-via-train-validation-split-scala">4.7.4. Example: model selection via train validation split (scala)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-practice.html">5. <code class="docutils literal"><span class="pre">pyspark-practice.rst</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#basics-dfs">5.1. Basics DFs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#udfs">5.2. UDFs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#sorting">5.3. Sorting</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#create-df-from-list-of-tuples">5.4. Create DF from list of tuples</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#groupby">5.5. groupby</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#practice-with-faker-data">5.6. Practice with faker data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-practice.html#little-refrehser-on-generators">5.6.1. Little refrehser on generators</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#register-table-to-use-sql">5.7. Register table to use SQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#more">5.8. More</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-overflow.html">6. <code class="docutils literal"><span class="pre">pyspark-overflow.rst</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-to-get-a-value-from-the-row-object-in-spark-dataframe">6.1. How to get a value from the Row object in Spark Dataframe?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-to-add-a-constant-column-in-a-spark-dataframe">6.2. How to add a constant column in a Spark DataFrame?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#add-an-empty-column-to-spark-dataframe">6.3. Add an empty column to Spark DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#count-number-of-non-nan-entries-in-each-column-of-spark-dataframe">6.4. Count number of non-NaN entries in each column of Spark dataframe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#use-simple-aggregation">6.4.1. Use simple aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#use-sql-null-semantics">6.4.2. Use SQL <code class="docutils literal"><span class="pre">NULL</span></code> semantics</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#in-fractions">6.4.3. In fractions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#updating-a-dataframe-column-in-spark">6.5. Updating a dataframe column in spark</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-do-i-add-a-new-column-to-spark-data-frame-pyspark">6.6. How do I add a new column to spark data frame (Pyspark)?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#use-literals-lit">6.6.1. Use literals <code class="docutils literal"><span class="pre">lit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#transforming-an-existing-column">6.6.2. Transforming an existing column</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-join">6.6.3. Using <code class="docutils literal"><span class="pre">join</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-function-udf">6.6.4. Using function/UDF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-to-change-dataframe-column-names-in-pyspark">6.7. How to change dataframe column names in pyspark?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#option-1-using-selectexpr">6.7.1. Option 1. Using selectExpr.</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#option-2-using-withcolumnrenamed">6.7.2. Option 2. Using <code class="docutils literal"><span class="pre">withColumnRenamed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-alias">6.7.3. Using alias</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-sqlcontext-sql">6.7.4. Using <code class="docutils literal"><span class="pre">sqlContext.sql</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#pyspark-dataframes-way-to-enumerate-without-converting-to-pandas">6.8. PySpark DataFrames - way to enumerate without converting to Pandas?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#ones-i-just-bookmarked-for-future-reference">6.9. Ones I just bookmarked for future reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#reshaping-pivoting-data-in-spark-rdd-and-or-spark-dataframes">6.9.1. Reshaping/Pivoting data in Spark RDD and/or Spark DataFrames</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-install.html">7. Install PySpark (<code class="docutils literal"><span class="pre">pyspark-install</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-install.html#windows">7.1. windows?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-install.html#retry-above-is-a-clusterfuck">7.2. Retry, above is a clusterfuck</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="top-edx.html">EdX Course Notes (<code class="docutils literal"><span class="pre">top-edx.rst</span></code>)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cs105_lab0.html">cs105_lab0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab0.html#create-dataframe-and-filter-it">Create DataFrame and filter it</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab0.html#load-a-text-file">Load a text file</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab0.html#check-plotting">Check plotting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs105_lab1a.html">cs105_lab1a</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a.html#spark-context">Spark Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a.html#sparkcontext-and-the-driver-program-cluster-structure">SparkContext and the Driver Program (Cluster Structure)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#about-the-driver-program">About the Driver Program</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#about-hivecontext-the-type-of-sqlcontext-for-db">About HiveContext (the type of sqlContext for DB)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#sparkcontext">SparkContext</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a.html#using-dataframes-and-chaining-transformations">Using DataFrames and chaining transformations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#dataframe-and-schema">DataFrame and Schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#ways-to-define-schemas">Ways to define schemas</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#distributed-data-and-using-a-collection-to-create-a-dataframe">Distributed Data and using a collection to create a DataFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#query-plans-and-the-catalyst-optimizer">Query plans and the <code class="docutils literal"><span class="pre">Catalyst</span> <span class="pre">Optimizer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs105_lab1a_coding.html">cs105_lab1a codes (<code class="docutils literal"><span class="pre">cs105_lab1a_code</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#exercise-overview">Exercise Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#create-list-of-data">Create list of Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#create-dataframe-from-a-list">Create DataFrame from a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#subtract-one-from-each-the-age-row">Subtract one from each the <em>age</em> row</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#apply-transformations-and-examine-query-plan">Apply transformations, and examine query plan</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#use-collect-to-view-results">Use <code class="docutils literal"><span class="pre">collect</span></code> to view results</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#display-helper-function-in-db">display helper function in DB</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#more-actions-count-to-get-total">More actions: <code class="docutils literal"><span class="pre">count</span></code> to get total</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#apply-transformation-filter-and-view-results-with-collect">Apply transformation <code class="docutils literal"><span class="pre">filter</span></code> and view results with <code class="docutils literal"><span class="pre">collect</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#lambda-functions-and-udfs">Lambda functions and UDFs</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#additional-dataframe-actions">Additional DataFrame actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#additional-dataframe-transformations">Additional DataFrame transformations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#orderby">orderBy</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#a-distinct-and-dropduplicates">A <code class="docutils literal"><span class="pre">distinct</span></code> and <code class="docutils literal"><span class="pre">dropDuplicates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#drop">drop</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#groupby">groupBy</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#sample">sample</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#caching-dataframes-and-storage-options">Caching DataFrames and Storage Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#unpersist-and-storage-options">Unpersist and storage options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#debugging-spark-applications-and-lazy-evaluation">Debugging Spark applications and lazy evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#jvm-and-py4j-how-python-is-executed-in-spark">JVM and Py4J - How Python is Executed in Spark</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#challenges-with-lazy-evaluation-using-transformations-and-actions">Challenges with lazy evaluation using transformations and actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#finding-the-bug">Finding the bug</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#moving-toward-expert-style">Moving toward expert style</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs105_lab1b.html">cs105_lab1b_wordcount</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#create-a-base-df-and-perform-operations">Create a base DF and perform operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#create-a-base-df">Create a base DF</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#use-df-functions-to-add-an-s">Use DF functions to add an &#8216;s&#8217;</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#length-of-each-word">Length of each word</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#counting-with-spark-sql-and-dataframes">Counting with Spark SQL and DataFrames</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#using-groupby-and-count">Using groupBy and count</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#finding-unique-words-and-a-mean-value">Finding unique words and a mean value</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#unique-words">Unique words</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#means-of-groups-using-dataframes">Means of groups using DataFrames</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#apply-word-count-to-a-file">Apply word count to a file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#the-wordcount-function">The wordCount function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#capitalization-and-punctuation">Capitalization and punctuation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#load-a-text-file">Load a text file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#words-from-lines">Words from lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#count-the-words">Count the words</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#random-stuffs-i-played-around-with">Random stuffs I played around with</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs105_lab2.html">cs105_lab2_apache_log</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab2.html#introduction-and-imports">Introduction and Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab2.html#exploratory-data-analysis">Exploratory Data Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#b-parsing-the-log-file">(2b) Parsing the log file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#data-cleaning">Data Cleaning</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#fix-the-rows-with-null-content-size">Fix the rows with null content_size</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#parsing-the-timestamp">Parsing the timestamp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab2.html#analysis-walk-through-on-the-web-server-log-file">Analysis Walk-Through on the Web Server Log File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#example-content-size-statistics">Example: Content Size Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#example-http-status-analysis">Example: HTTP Status Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#example-status-graphing">Example: Status Graphing</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#example-frequent-hosts">Example: Frequent Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#example-visualizing-paths">Example: Visualizing Paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#example-top-paths">Example: Top Paths</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab2.html#analyzing-web-server-log-file">Analyzing Web Server Log File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-top-ten-error-paths-hw-problem">Exercise: Top Ten Error Paths (HW Problem)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-number-of-unique-hosts-hw">Exercise: Number of Unique Hosts (HW)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-number-of-unique-daily-hosts">Exercise: Number of Unique Daily Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-visualizing-the-number-of-unique-daily-hosts">Exercise: Visualizing the Number of Unique Daily Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-average-number-of-daily-requests-per-host">Exercise: Average Number of Daily Requests per Host</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-visualizing-the-average-daily-requests-per-unique-host">Exercise: Visualizing the Average Daily Requests per Unique Host</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab2.html#exploring-404-status-codes">Exploring 404 Status Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-counting-404-response-codes">Exercise: Counting 404 Response Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-listing-404-status-code-records">Exercise: Listing 404 Status Code Records</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-listing-the-top-twenty-404-response-code-paths">Exercise: Listing the Top Twenty 404 Response Code paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-listing-the-top-twenty-five-404-response-code-hosts">Exercise: Listing the Top Twenty-five 404 Response Code Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-listing-404-errors-per-day">Exercise: Listing 404 Errors per Day</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-visualizing-the-404-errors-by-day">Exercise: Visualizing the 404 Errors by Day</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-top-five-days-for-404-errors">Exercise: Top Five Days for 404 Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-hourly-404-errors">Exercise: Hourly 404 Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab2.html#exercise-visualizing-the-404-response-codes-by-hour">Exercise: Visualizing the 404 Response Codes by Hour</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab1.html">cs110_lab1_power_plant_ml_pipeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#background">Background</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#background-power-generation">Background &#8212; power generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#challenge-for-power-grid-operation">Challenge for power grid operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#the-business-problem">The business problem</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#business-understanding">Business Understanding</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#extract-transform-load-etl-your-data">Extract-Transform-Load (ETL) Your Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2a">Exercise 2a</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2b">Exercise 2b</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2c">Exercise 2c</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2d">Exercise 2d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#explore-your-data">Explore your data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#a">3a</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#b">3b</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#visualize-your-data">Visualize your data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#id1">4a</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-4-b">Exercise 4(b)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#excercise-4-c">Excercise 4(c)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-4-d">Exercise 4(d)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#data-preparation-where-i-left-off">Data Preparation (where i left off)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-5-a">Exercise 5(a)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#data-modeling">Data Modeling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-6-a">Exercise 6(a)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#id2">6(b)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#c">6(c)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#d">6(d)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#e">6e</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#f">6(f)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#g">6(g)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#h">6(h)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#i">6(i)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#j">6(j)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#k">6(k)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#tuning-and-evaluation">Tuning and Evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#id3">7(a)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-b">Exercise 7(b)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-c-decisiontreeregressor">Exercise 7(c) DecisionTreeRegressor</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-d">Exercise 7(d)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-e">Exercise 7(e)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-f-random-forest-regressor">Exercise 7(f) (Random Forest Regressor)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-g-cross-validation">Exercise 7(g) (cross validation)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-h-model-evaluation">Exercise 7(h) (model evaluation)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="">cs110_lab2_als_prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#preliminaries">Preliminaries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-20-million-movie-sample">The 20-million movie sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cpu-vs-io-tradeoff">CPU vs IO Tradeoff</a></li>
<li class="toctree-l4"><a class="reference internal" href="#load-and-cache">Load and Cache</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#basic-recommendations">Basic Recommendations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#exercise-1a-movies-with-highest-average-ratings">Exercise (1a) Movies with Highest Average Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercise-1b-movies-with-highest-average-ratings-and-at-least-500-reviews">Exercise (1b) Movies with Highest Average Ratings and at least 500 reviews</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#collaborative-filtering">Collaborative Filtering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#exercise-2a-creating-a-training-set">Exercise (2a) Creating a Training Set</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercise-2b-alternating-least-squares">Exercise (2b) Alternating Least Squares</a></li>
<li class="toctree-l4"><a class="reference internal" href="#why-are-we-doing-our-own-cross-validation">Why are we doing our own cross-validation?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#excersie-2c-testing-your-model">Excersie (2c) Testing Your Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercise-2d-comparing-your-model">Exercise (2d) Comparing Your Model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#predictions-for-yourself">Predictions for Yourself</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#exercise-3a-your-movie-ratings">Exercise (3a) Your Movie Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercise-3b-add-your-movies-to-training-dataset">Exercise (3b) Add Your Movies to Training Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercise-3c-train-a-model-with-your-ratings">Exercise (3c) Train a Model with Your Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercise-3d-check-rmse-for-the-new-model-with-your-ratings">Exercise (3d) Check RMSE for the New Model with Your Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercise-3e-predict-your-ratings">Exercise (3e) Predict Your Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercise-3f-predict-your-ratings">Exercise (3f) Predict Your Ratings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab3a.html">cs110_lab3a_word_count_rdd</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab3b.html">cs110_lab3b_text_analysis_and_entity_resolution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#data-files">Data files</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#preliminaries">Preliminaries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#load-data-files">Load data files</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#examine-the-lines-loaded">Examine the lines loaded</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#er-as-text-similarity-bags-of-words">ER as Text Similarity - Bags of Words</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#exercise-1-a-tokenize-a-string">Exercise 1(a) Tokenize a String</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab1a.html">cs120_lab1a_math_review</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab1b.html">cs120_lab1b_word_count_rdd</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab2.html">cs120_lab2_linear_regression_df</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab3.html">cs120_lab3_ctr_df</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab4.html">cs120_lab4_pca</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bash_wooledge/top-bash-wool.html">Bash wooledge (<code class="docutils literal"><span class="pre">top-bash-wool.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/special_char.html">1. Special Characters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/param.html">2. Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/param.html#basic">2.1. Basic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#always-double-quote-when-doing-pe-parameter-expansion">2.1.1. Always double-quote when doing PE (parameter expansion)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#char-needed-with-dealing-with-numerics">2.1.2. char needed with dealing with numerics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/param.html#special-parameters-and-variables">2.2. Special Parameters and Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#special-parameters">2.2.1. Special Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#special-variables-provided-by-the-shell">2.2.2. Special variables provided by the shell</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/param.html#pe-tricks-some-i-rarely-use">2.3. PE tricks (some I rarely use)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#summary-table">2.3.1. Summary table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var">2.3.2. <code class="docutils literal"><span class="pre">${var}</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-word-use-default-value">2.3.3. <code class="docutils literal"><span class="pre">${var:-word}</span></code> (use default value)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-word-assign-default">2.3.4. <code class="docutils literal"><span class="pre">${var:=word}</span></code> (assign default)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-word-use-alternate-value">2.3.5. <code class="docutils literal"><span class="pre">${var:+word}</span></code> (use alternate value)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-offset-length-substring-expansion">2.3.6. <code class="docutils literal"><span class="pre">${var:offset:length}</span></code> (substring expansion)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-var-number-of-characters-or-array-items">2.3.7. <code class="docutils literal"><span class="pre">${#var}</span></code>, <code class="docutils literal"><span class="pre">${#var[&#64;]}</span></code> (number of characters or array items)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-pattern-delete-beginning-of-str-if-match">2.3.8. <code class="docutils literal"><span class="pre">${var#pattern}</span></code> (delete beginning of str if match)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-msg-print-msg-to-stderr">2.3.9. <code class="docutils literal"><span class="pre">${var:?msg}</span></code> (print msg to stderr)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/patterns.html">3. Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#glob-patterns">3.1. Glob patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/patterns.html#use-glob-not-ls-for-looping-over-files">3.1.1. Use glob, not ls for looping over files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#extended-globs-i-rather-use-regexp">3.2. Extended Globs (I rather use regexp)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#regular-expressions">3.3. Regular expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#brace-expansion">3.4. Brace Expansion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/tests.html">4. Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/tests.html#exit-status-0-success-use">4.1. Exit status (0 = success)....use $?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/tests.html#control-operators-and">4.2. Control operators (&amp;&amp; and ||)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/tests.html#grouping-statements">4.3. Grouping statements {...;}</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/tests.html#use-case1-reporting-stderr-on-complex-test">4.3.1. Use-case1: reporting stderr on complex test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/tests.html#use-case2-redirect-input-to-a-group-of-statements">4.3.2. Use-case2: redirect input to a group of statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/tests.html#use-case3-error-handling">4.3.3. Use-case3: error handling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/conditionals.html">5. Conditionals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/conditionals.html#conditional-blocks-if-test-and">5.1. Conditional Blocks (if, test and [[)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/conditionals.html#conditional-loops-while-until-and-for">5.2. Conditional Loops (while, until and for)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/conditionals.html#choices-case-and-select">5.3. Choices (case and select)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sed/sed-tutorial.gnu.html">sed-tutorial-gnu (<code class="docutils literal"><span class="pre">sed-tutorial.gnu.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#execution-cycle-how-sed-works">Execution Cycle: How sed works</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#addresses-selecting-lines-with-sed">Addresses: Selecting lines with sed</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#single-address-form">Single address form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#two-address-form">Two address form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#match-negation-via">Match negation via <code class="docutils literal"><span class="pre">!</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#regular-expressions-overview-of-regular-expression-syntax">Regular Expressions: Overview of regular expression syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#common-commands-often-used-commands">Common Commands: Often used commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#the-s-command-sed-s-swiss-army-knife">The &#8220;s&#8221; Command: sed&#8217;s Swiss Army Knife</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#replacement">replacement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#flags">flags</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#other-commands-less-frequently-used-commands">Other Commands: Less frequently used commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#programming-commands-commands-for-sed-gurus">Programming Commands: Commands for sed gurus</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html">sed-tutorial-tutorials-points (<code class="docutils literal"><span class="pre">sed-tutorial.tutorialspoints.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#sed-workflow">Sed - workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#basic-syntax-and-examples">Basic syntax and examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#standard-options">Standard options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#gnu-specific-options">GNU specific options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#loops-branches">Loops, Branches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#address-range-search-by-specifying-line-nums">Address range (search by specifying line-nums)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#p-syntax">&#8216;p&#8217; syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#m-n-syntax">&#8216;M,+n&#8217; syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#id1">&#8216;M,~n&#8217; syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#pattern-range-search-for-simple-text-or-regexp-using-regex-syntax">Pattern range - search for simple-text or regexp using /regex/ syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#basic-commands-delete-read-write-append">Basic commands (delete, read, write, append)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#delete-command-address1-address2-d">Delete command [address1[,address2]]d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#write-command-address1-address2-w-file">Write command [address1[,address2]]w file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#append-command-address-a">Append command [address]a</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#change-command-address1-address2-c">Change command [address1[,address2]]c</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#insert-command-address-i">Insert Command [address]i</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#translate-command-address1-address2-y-list-1-list-2">Translate command [address1[,address2]]y/list-1/list-2/</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#i-command">I command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#quit-command-address-q">Quit Command [address]q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#read-command-address-r-file">Read Command [address]r file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#exectuve-command-address1-address2-e-command">Exectuve Command [address1[,address2]]e [command]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#miscellaneous-commands">Miscellaneous Commands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../awk-tutorial/awk-tutorial.html">awk-tutorial (<code class="docutils literal"><span class="pre">awk-tutorial.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-basic-structure.html">1. Basic structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html">2. The Essential Syntax of AWK</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#unary-arithmetic-operators">2.1. Unary arithmetic operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#the-autoincrement-and-autodecrement-operators">2.2. The Autoincrement and Autodecrement Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#assignment-operators">2.3. Assignment Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#conditional-expressions">2.4. Conditional expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#regular-expressions">2.5. Regular Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#and-or-not">2.6. And/Or/Not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-summary-commands.html">3. Summary of AWK Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html">4. AWK Built-in Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#fs-the-input-field-separator-variable">4.1. FS - The Input Field Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#ofs-the-output-field-separator-variable">4.2. OFS - The Output Field Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#nf-the-number-of-fields-variable">4.3. NF - The Number of Fields Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#nr-the-number-of-records-variable">4.4. NR - The Number of Records Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#rs-the-record-separator-variable">4.5. RS - The Record Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#ors-the-output-record-separator-variable">4.6. ORS - The Output Record Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#filename-the-current-filename-variable">4.7. FILENAME - The Current Filename Variable</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../awk-tp.html">Awk Tutorials Points (<code class="docutils literal"><span class="pre">awk-tp.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../awk-ss64.html">1. Whirlwind tour from ss64</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#basic-syntax">1.1. Basic syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#awk-patterns">1.2. awk-patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#variable-names-that-are-predefined">1.3. Variable names that are predefined</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#examples">1.4. Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#complex-examples">1.5. Complex examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-grymoire.html">2. Tables from grymoire</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#arithmetic-expressions">2.1. Arithmetic expressions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#binary-operator">2.1.1. Binary operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#assignment-operator">2.1.2. Assignment operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#conditional-expressions">2.1.3. Conditional expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#regexp">2.1.4. Regexp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#summary-of-awk-commands">2.2. Summary of AWK commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#build-int-awk-variables">2.3. Build-int AWK variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#printf-formatting">2.4. printf - formatting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#syntax">2.4.1. syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#escape-sequences">2.4.2. Escape sequences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#format-specifiers">2.4.3. Format specifiers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#width-specify-minimum-field-size">2.4.4. Width - specify minimum field size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#my-own-example-use-to-left-justify-string-in-s">2.4.5. my own example (use &#8220;-&#8221; to left justify string in %s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#examples-of-complex-formatting">2.4.6. Examples of complex formatting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#explicit-file-output">2.4.7. Explicit file output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#flow-control-with-next-and-exit">2.5. Flow Control with next and exit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#awk-numerical-functions">2.6. AWK Numerical Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#awk-string-functions">2.7. AWK String functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#split-demo">2.7.1. split demo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#gsub-demo">2.7.2. gsub demo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#match-demo">2.7.3. match demo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tp.workflow.html">3. awk-workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.workflow.html#the-begin-body-end-block">3.1. The BEGIN, body, END block</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.workflow.html#first-example-on-marks-txt-file">3.2. First example on marks.txt file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tp.basic-syntax.html">4. AWK Basic Syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#awk-help">4.1. awk &#8211;help</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#awk-in-the-terminal-or-program-file">4.2. AWK in the terminal or Program file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#v-option">4.3. -v option</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#dump-global-variables">4.4. dump global variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#profile-file-to-create-pretty-printed-script-file">4.5. &#8211;profile[=file] to create pretty-printed script file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tp.basic-examples.html">5. AWK &#8211; Basic Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../top-sqlite.html">SQL notes (<code class="docutils literal"><span class="pre">top-sqlite.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sqlite.tutpoint.html">1. SQLite notes from tutorialpoint</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html">1.1. SQLite commands overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html#ddl-data-definition-language">1.1.1. DDL (data definition language)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html#dml-data-manipulation-language">1.1.2. DML (Data manipulation language)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html#dql-data-query-language">1.1.3. DQL (data query language)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.2_unsupported_commands.html">1.2. Unsupported features in SQLite</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html">1.3. sqlite commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#the-dot-commands-from-sqlite">1.3.1. the <em>dot</em> commands from sqlite</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#show-see-default-settings">1.3.2. show &#8211; see default settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#format-output-with-header-mode-timer">1.3.3. Format output with (header, mode, timer)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#the-sqlite-master-table">1.3.4. The sqlite_master Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html">1.4. SQLite syntax (a whirl-wind tour)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#case-sensitivity">1.4.1. Case Sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#comments">1.4.2. Comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#sqlite-statements-and-clause">1.4.3. SQLite Statements and Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#create-table">1.4.4. CREATE TABLE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#create-trigger">1.4.5. CREATE TRIGGER</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#group-by">1.4.6. GROUP BY</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#having">1.4.7. HAVING</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#pragma">1.4.8. PRAGMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#update">1.4.9. UPDATE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html">1.5. SQLite Data Type</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#sqlite-storage-classes">1.5.1. SQLite Storage Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#sqlite-affinity-type">1.5.2. SQLite Affinity Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#sqlite-affinity-and-type-names">1.5.3. SQLite Affinity and Type Names</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#date-and-time-datatype">1.5.4. Date and Time Datatype</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html">1.6. SQLite DDL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#create-database">1.6.1. CREATE Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#attach-database">1.6.2. ATTACH Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#detach-database">1.6.3. DETACH Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#create-table">1.6.4. CREATE Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#drop-table">1.6.5. DROP Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html">1.7. SQLite DML</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#insert-query">1.7.1. INSERT Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#select-query">1.7.2. SELECT Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#update-query">1.7.3. UPDATE Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#delete-query">1.7.4. DELETE Query</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html">1.8. SQLite clauses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#where-clause">1.8.1. WHERE Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#and-or-clause">1.8.2. AND, OR Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#like-clause">1.8.3. LIKE Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#glob-clause">1.8.4. GLOB Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#limit-clause">1.8.5. LIMIT Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#having-clause">1.8.6. HAVING Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#unions-clause">1.8.7. UNIONS Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#order-by-clause">1.8.8. ORDER BY Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#group-by-clause">1.8.9. GROUP BY Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#distinct-clause-keyword">1.8.10. DISTINCT Clause/keyword</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.8_sqlite_expressions.html">1.9. SQLite Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.8_sqlite_operators.html">1.10. SQLite Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_5.html">1.11. SQLite - useful functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_5.html#summary-of-key-functions">1.11.1. Summary of key functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_5.html#examples">1.11.2. Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sqlite_doc.html">2. Bunch of stuffs from the official doc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#command-line-shell-for-sqlite-incomplete">2.1. Command Line Shell for SQLite (incomplete)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#semicolon-to-indicate-end-of-sql-command">2.1.1. Semicolon to indicate end of SQL command</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#dot-commands-special-commands-to-sqlite3">2.1.2. dot-commands (special commands to sqlite3)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#todo">2.1.3. todo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#sql-syntax-link-only">2.2. SQL Syntax (link only)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#sql-keywords-link-only">2.3. SQL Keywords (link only)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#datatypes-in-sqlite-version3-todo">2.4. Datatypes in SQLite Version3 (todo)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#core-functions-todo">2.5. Core functions (todo)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#agg-functions">2.6. Agg functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#data-and-time-functions">2.7. Data and time functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#timestring">2.7.1. timestring</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#modifiers">2.7.2. modifiers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#examples">2.7.3. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#json-just-read">2.8. JSON (just read)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sql_wiki.html">3. Random jumbles from wikipedia pertaining to Database concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#data-integrity">3.1. Data Integrity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#ddl-dml-dcl">3.2. DDL, DML, DCL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#data-definition-language-ddl">3.2.1. Data definition language (DDL)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#data-manipulation-language-dml">3.2.2. Data Manipulation Language (DML)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#data-control-language-dcl">3.2.3. Data Control Language (DCL)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#acid">3.3. ACID</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#atomicity">3.3.1. Atomicity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#consistency">3.3.2. Consistency</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#isolation">3.3.3. Isolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#durability">3.3.4. Durability</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#jumpled-articles">3.4. Jumpled articles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#consistency-model">3.4.1. Consistency model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#cap-theorem-aka-brewer-s-theorem">3.4.2. CAP Theorem (aka Brewer&#8217;s Theorem)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#database-transaction">3.4.3. Database transaction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#database-normalization">3.5. Database normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#database-schema">3.6. Database Schema</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#logical-schema">3.6.1. Logical schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#physical-schema">3.6.2. Physical schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#conceptual-schema">3.6.3. Conceptual schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#three-schema-approach">3.6.4. Three-schema approach</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#bunch-of-jumbled-links">3.7. Bunch of jumbled links</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cs-computer.html">Random notes relating to computer science (<code class="docutils literal"><span class="pre">cs-computer.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cs-computer.unix.html">Unix-related</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cs-computer.unix.html#terminal-shell-tty-console-the-difference">terminal, shell, tty, console...the difference?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cs-computer.network.html">Network notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cs-computer.network.html#http-messages">HTTP messages</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Coding Notebook</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="top-edx.html">EdX Course Notes (<code class="docutils literal"><span class="pre">top-edx.rst</span></code>)</a> &raquo;</li>
      
    <li>cs110_lab2_als_prediction</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/pyspark/cs110_lab2.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cs110-lab2-als-prediction">
<h1>cs110_lab2_als_prediction<a class="headerlink" href="#cs110-lab2-als-prediction" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://raw.githubusercontent.com/spark-mooc/mooc-setup/master/cs110_lab2_als_prediction.py">https://raw.githubusercontent.com/spark-mooc/mooc-setup/master/cs110_lab2_als_prediction.py</a></p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">This is an actual homework program submitted to EdX. To adhere to the honor code,
the <code class="docutils literal"><span class="pre">&lt;FILL</span> <span class="pre">IN&gt;</span></code> is kept in my personal private <a class="reference external" href="https://github.com/wtak23/private_repos/blob/master/cs105_lab2_solutions.rst">github repos</a>.</p>
</div>
<div class="contents local topic" id="contents">
<p class="topic-title first"><cite>Contents</cite></p>
<ul class="simple">
<li><a class="reference internal" href="#preliminaries" id="id1">Preliminaries</a><ul>
<li><a class="reference internal" href="#the-20-million-movie-sample" id="id2">The 20-million movie sample</a></li>
<li><a class="reference internal" href="#cpu-vs-io-tradeoff" id="id3">CPU vs IO Tradeoff</a></li>
<li><a class="reference internal" href="#load-and-cache" id="id4">Load and Cache</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-recommendations" id="id5">Basic Recommendations</a><ul>
<li><a class="reference internal" href="#exercise-1a-movies-with-highest-average-ratings" id="id6">Exercise (1a) Movies with Highest Average Ratings</a></li>
<li><a class="reference internal" href="#exercise-1b-movies-with-highest-average-ratings-and-at-least-500-reviews" id="id7">Exercise (1b) Movies with Highest Average Ratings and at least 500 reviews</a></li>
</ul>
</li>
<li><a class="reference internal" href="#collaborative-filtering" id="id8">Collaborative Filtering</a><ul>
<li><a class="reference internal" href="#exercise-2a-creating-a-training-set" id="id9">Exercise (2a) Creating a Training Set</a></li>
<li><a class="reference internal" href="#exercise-2b-alternating-least-squares" id="id10">Exercise (2b) Alternating Least Squares</a></li>
<li><a class="reference internal" href="#why-are-we-doing-our-own-cross-validation" id="id11">Why are we doing our own cross-validation?</a></li>
<li><a class="reference internal" href="#excersie-2c-testing-your-model" id="id12">Excersie (2c) Testing Your Model</a></li>
<li><a class="reference internal" href="#exercise-2d-comparing-your-model" id="id13">Exercise (2d) Comparing Your Model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#predictions-for-yourself" id="id14">Predictions for Yourself</a><ul>
<li><a class="reference internal" href="#exercise-3a-your-movie-ratings" id="id15">Exercise (3a) Your Movie Ratings</a></li>
<li><a class="reference internal" href="#exercise-3b-add-your-movies-to-training-dataset" id="id16">Exercise (3b) Add Your Movies to Training Dataset</a></li>
<li><a class="reference internal" href="#exercise-3c-train-a-model-with-your-ratings" id="id17">Exercise (3c) Train a Model with Your Ratings</a></li>
<li><a class="reference internal" href="#exercise-3d-check-rmse-for-the-new-model-with-your-ratings" id="id18">Exercise (3d) Check RMSE for the New Model with Your Ratings</a></li>
<li><a class="reference internal" href="#exercise-3e-predict-your-ratings" id="id19">Exercise (3e) Predict Your Ratings</a></li>
<li><a class="reference internal" href="#exercise-3f-predict-your-ratings" id="id20">Exercise (3f) Predict Your Ratings</a></li>
</ul>
</li>
</ul>
</div>
<p class="rubric">During this lab we will cover:</p>
<ul class="simple">
<li>Part 0: Preliminaries</li>
<li>Part 1: Basic Recommendations</li>
<li>Part 2: Collaborative Filtering</li>
<li>Part 3: Predictions for Yourself</li>
</ul>
<div class="section" id="preliminaries">
<h2><a class="toc-backref" href="#id1">Preliminaries</a><a class="headerlink" href="#preliminaries" title="Permalink to this headline"></a></h2>
<p>We read in each of the files and create a DataFrame consisting of parsed lines.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">databricks_test_helper</span> <span class="kn">import</span> <span class="n">Test</span>

<span class="n">dbfs_dir</span> <span class="o">=</span> <span class="s1">&#39;/databricks-datasets/cs110x/ml-20m/data-001&#39;</span>
<span class="n">ratings_filename</span> <span class="o">=</span> <span class="n">dbfs_dir</span> <span class="o">+</span> <span class="s1">&#39;/ratings.csv&#39;</span>
<span class="n">movies_filename</span> <span class="o">=</span> <span class="n">dbfs_dir</span> <span class="o">+</span> <span class="s1">&#39;/movies.csv&#39;</span>

<span class="c1"># The following line is here to enable this notebook to be exported as source and</span>
<span class="c1"># run on a local machine with a local copy of the files. Just change the dbfs_dir, above.</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
  <span class="c1"># Handle Windows.</span>
  <span class="n">ratings_filename</span> <span class="o">=</span> <span class="n">ratings_filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
  <span class="n">movie_filename</span> <span class="o">=</span> <span class="n">movie_filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="the-20-million-movie-sample">
<h3><a class="toc-backref" href="#id2">The 20-million movie sample</a><a class="headerlink" href="#the-20-million-movie-sample" title="Permalink to this headline"></a></h3>
<p>First, let&#8217;s take a look at the directory containing our files.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">_i</span><span class="p">,</span><span class="n">_item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">dbfs_dir</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="k">print</span> <span class="n">_i</span><span class="p">,</span><span class="n">_item</span>
<span class="go">0 FileInfo(path=u&#39;dbfs:/databricks-datasets/cs110x/ml-20m/data-001/README.txt&#39;, name=u&#39;README.txt&#39;, size=8964L)</span>
<span class="go">1 FileInfo(path=u&#39;dbfs:/databricks-datasets/cs110x/ml-20m/data-001/links.csv&#39;, name=u&#39;links.csv&#39;, size=569517L)</span>
<span class="go">2 FileInfo(path=u&#39;dbfs:/databricks-datasets/cs110x/ml-20m/data-001/links.csv.gz&#39;, name=u&#39;links.csv.gz&#39;, size=245973L)</span>
<span class="go">3 FileInfo(path=u&#39;dbfs:/databricks-datasets/cs110x/ml-20m/data-001/movies.csv&#39;, name=u&#39;movies.csv&#39;, size=1397542L)</span>
<span class="go">4 FileInfo(path=u&#39;dbfs:/databricks-datasets/cs110x/ml-20m/data-001/movies.csv.gz&#39;, name=u&#39;movies.csv.gz&#39;, size=498839L)</span>
<span class="go">5 FileInfo(path=u&#39;dbfs:/databricks-datasets/cs110x/ml-20m/data-001/ratings.csv&#39;, name=u&#39;ratings.csv&#39;, size=533444411L)</span>
<span class="go">6 FileInfo(path=u&#39;dbfs:/databricks-datasets/cs110x/ml-20m/data-001/ratings.csv.gz&#39;, name=u&#39;ratings.csv.gz&#39;, size=132656084L)</span>
<span class="go">7 FileInfo(path=u&#39;dbfs:/databricks-datasets/cs110x/ml-20m/data-001/tags.csv&#39;, name=u&#39;tags.csv&#39;, size=16603996L)</span>
<span class="go">8 FileInfo(path=u&#39;dbfs:/databricks-datasets/cs110x/ml-20m/data-001/tags.csv.gz&#39;, name=u&#39;tags.csv.gz&#39;, size=4787917L)</span>
</pre></div>
</div>
</div>
<div class="section" id="cpu-vs-io-tradeoff">
<h3><a class="toc-backref" href="#id3">CPU vs IO Tradeoff</a><a class="headerlink" href="#cpu-vs-io-tradeoff" title="Permalink to this headline"></a></h3>
<div class="admonition-summary admonition">
<p class="first admonition-title">Summary</p>
<ul class="last simple">
<li>CPU is the bottleneck -&gt; process uncompressed files</li>
<li>I/O is the bottleneck -&gt; process compressed files</li>
<li>explicitly give Schema for extra speedup (schema inference has overhead when creating DF)</li>
</ul>
</div>
<p>Note that we have both compressed files (ending in <code class="docutils literal"><span class="pre">.gz</span></code>) and uncompressed files.</p>
<p>We have a CPU vs. I/O tradeoff here.</p>
<ul class="simple">
<li><strong>If I/O is the bottleneck</strong>, then we want to process the compressed files and pay the extra CPU overhead.</li>
<li><strong>If CPU is the bottleneck</strong>, then it makes more sense to process the uncompressed files.</li>
</ul>
<p>We&#8217;ve done some experiments, and we&#8217;ve determined that CPU is more of a bottleneck than I/O, on Community Edition.
So, we&#8217;re going to process the uncompressed data.</p>
<p>In addition, we&#8217;re going to speed things up further by <strong>specifying the DataFrame schema explicitly</strong>.
(When the Spark CSV adapter infers the schema from a CSV file, it has to make an extra pass over the file.
That&#8217;ll slow things down here, and it isn&#8217;t really necessary.)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">ratings_df_schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span>
   <span class="n">StructField</span><span class="p">(</span><span class="s1">&#39;userId&#39;</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
   <span class="n">StructField</span><span class="p">(</span><span class="s1">&#39;movieId&#39;</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
   <span class="n">StructField</span><span class="p">(</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="n">DoubleType</span><span class="p">()),</span>
  <span class="p">])</span>
<span class="n">movies_df_schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span>
   <span class="n">StructField</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
   <span class="n">StructField</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
  <span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="load-and-cache">
<h3><a class="toc-backref" href="#id4">Load and Cache</a><a class="headerlink" href="#load-and-cache" title="Permalink to this headline"></a></h3>
<p>The Databricks File System (<strong>DBFS</strong>) sits on top of S3.</p>
<ul class="simple">
<li>We&#8217;re going to be accessing this data a lot.</li>
<li>Rather than read it over and over again from S3, we&#8217;ll cache both the movies DF and the ratings DF in memory.</li>
</ul>
<p>The code below will take about 30 sec to run:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">regexp_extract</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="o">*</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw_ratings_df</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;com.databricks.spark.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">inferSchema</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="n">ratings_df_schema</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">ratings_filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratings_df</span> <span class="o">=</span> <span class="n">raw_ratings_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw_movies_df</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;com.databricks.spark.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">inferSchema</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="n">movies_df_schema</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">movies_filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movies_df</span> <span class="o">=</span> <span class="n">raw_movies_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Genres&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s1">&#39;movieId&#39;</span><span class="p">,</span> <span class="s1">&#39;ID&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratings_df</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movies_df</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ratings_df</span><span class="o">.</span><span class="n">is_cached</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">movies_df</span><span class="o">.</span><span class="n">is_cached</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw_ratings_count</span> <span class="o">=</span> <span class="n">raw_ratings_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratings_count</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw_movies_count</span> <span class="o">=</span> <span class="n">raw_movies_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movies_count</span> <span class="o">=</span> <span class="n">movies_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;There are </span><span class="si">%s</span><span class="s1"> ratings and </span><span class="si">%s</span><span class="s1"> movies in the datasets&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ratings_count</span><span class="p">,</span> <span class="n">movies_count</span><span class="p">)</span>
<span class="go">There are 20000263 ratings and 27278 movies in the datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Ratings:&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratings_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Ratings:</span>
<span class="go">+------+-------+------+</span>
<span class="go">|userId|movieId|rating|</span>
<span class="go">+------+-------+------+</span>
<span class="go">|     1|      2|   3.5|</span>
<span class="go">|     1|     29|   3.5|</span>
<span class="go">|     1|     32|   3.5|</span>
<span class="go">+------+-------+------+</span>
<span class="go">only showing top 3 rows</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Movies:&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movies_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Movies:</span>
<span class="go">+---+-----------------------+</span>
<span class="go">|ID |title                  |</span>
<span class="go">+---+-----------------------+</span>
<span class="go">|1  |Toy Story (1995)       |</span>
<span class="go">|2  |Jumanji (1995)         |</span>
<span class="go">|3  |Grumpier Old Men (1995)|</span>
<span class="go">+---+-----------------------+</span>
<span class="go">only showing top 3 rows</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">raw_ratings_count</span> <span class="o">==</span> <span class="n">ratings_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">raw_movies_count</span> <span class="o">==</span> <span class="n">movies_count</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ratings_df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
<span class="go">root</span>
<span class="go"> |-- userId: integer (nullable = true)</span>
<span class="go"> |-- movieId: integer (nullable = true)</span>
<span class="go"> |-- rating: double (nullable = true)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">movies_df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
<span class="go">root</span>
<span class="go"> |-- ID: integer (nullable = true)</span>
<span class="go"> |-- title: string (nullable = true)</span>
</pre></div>
</div>
<p>Data verification check:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">ratings_count</span> <span class="o">==</span> <span class="mi">20000263</span>
<span class="k">assert</span> <span class="n">movies_count</span> <span class="o">==</span> <span class="mi">27278</span>
<span class="k">assert</span> <span class="n">movies_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">movies_df</span><span class="o">.</span><span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Toy Story (1995)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="n">ratings_df</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">ratings_df</span><span class="o">.</span><span class="n">userId</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ratings_df</span><span class="o">.</span><span class="n">movieId</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ratings_df</span><span class="o">.</span><span class="n">rating</span> <span class="o">==</span> <span class="mf">5.0</span><span class="p">))</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="basic-recommendations">
<h2><a class="toc-backref" href="#id5">Basic Recommendations</a><a class="headerlink" href="#basic-recommendations" title="Permalink to this headline"></a></h2>
<p>One way to recommend movies is to always recommend the movies with the highest average rating.</p>
<ul class="simple">
<li>In this part, we will use Spark to find the name, number of ratings, and the average rating of the 20 movies with the highest average rating and at least 500 reviews.</li>
<li>We want to filter our movies with high ratings but greater than or equal to 500 reviews because movies with few reviews may not have broad appeal to everyone.</li>
</ul>
<div class="section" id="exercise-1a-movies-with-highest-average-ratings">
<h3><a class="toc-backref" href="#id6">Exercise (1a) Movies with Highest Average Ratings</a><a class="headerlink" href="#exercise-1a-movies-with-highest-average-ratings" title="Permalink to this headline"></a></h3>
<p>(<a class="reference external" href="https://github.com/wtak23/private_repos/blob/master/cs110_lab2_solutions.rst#exercise-1a-movies-with-highest-average-ratings">sol</a>)</p>
<p>Let&#8217;s determine the movies with the highest average ratings.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL_IN&gt; with appropriate code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">functions</span> <span class="k">as</span> <span class="n">F</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># From ratingsDF, create a movie_ids_with_avg_ratings_df that combines the two DataFrames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movie_ids_with_avg_ratings_df</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;movieId&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">ratings_df</span><span class="o">.</span><span class="n">rating</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="n">ratings_df</span><span class="o">.</span><span class="n">rating</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;average&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;movie_ids_with_avg_ratings_df:&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movie_ids_with_avg_ratings_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movie_ids_with_avg_ratings_df</span><span class="p">:</span>
<span class="go">+-------+-----+------------------+</span>
<span class="go">|movieId|count|average           |</span>
<span class="go">+-------+-----+------------------+</span>
<span class="go">|1831   |7463 |2.5785207021305103|</span>
<span class="go">|431    |8946 |3.695059244355019 |</span>
<span class="go">|631    |2193 |2.7273141814865483|</span>
<span class="go">+-------+-----+------------------+</span>
<span class="go">only showing top 3 rows</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note: movie_names_df is a temporary variable, used only to separate the steps necessary</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># to create the movie_names_with_avg_ratings_df DataFrame.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movie_names_df</span> <span class="o">=</span> <span class="n">movie_ids_with_avg_ratings_df</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movie_names_with_avg_ratings_df</span> <span class="o">=</span> <span class="n">movie_names_df</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;movie_names_with_avg_ratings_df:&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movie_names_with_avg_ratings_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">movie_names_with_avg_ratings_df:</span>
<span class="go">+-------+----------------------------+-----+-------+</span>
<span class="go">|average|title                       |count|movieId|</span>
<span class="go">+-------+----------------------------+-----+-------+</span>
<span class="go">|5.0    |People of the Wind (1976)   |1    |129036 |</span>
<span class="go">|5.0    |Serving Life (2011)         |1    |129034 |</span>
<span class="go">|5.0    |Diplomatic Immunity (2009 )|1    |107434 |</span>
<span class="go">+-------+----------------------------+-----+-------+</span>
<span class="go">only showing top 3 rows</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-1b-movies-with-highest-average-ratings-and-at-least-500-reviews">
<h3><a class="toc-backref" href="#id7">Exercise (1b) Movies with Highest Average Ratings and at least 500 reviews</a><a class="headerlink" href="#exercise-1b-movies-with-highest-average-ratings-and-at-least-500-reviews" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Now that we have a DataFrame of the movies with highest average ratings, we can use Spark to determine the <strong>20 movies with highest average ratings and at least 500 reviews</strong>.</li>
<li>Add a single DataFrame transformation (in place of &lt;FILL_IN&gt;, below) to limit the results to movies with ratings from at least 500 people.</li>
</ul>
<p>(<a class="reference external" href="https://github.com/wtak23/private_repos/blob/master/cs110_lab2_solutions.rst#exercise-1b-movies-with-highest-average-ratings-and-at-least-500-reviews">sol</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movies_with_500_ratings_or_more</span> <span class="o">=</span> <span class="n">movie_names_with_avg_ratings_df</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Movies with highest ratings:&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movies_with_500_ratings_or_more</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">(4) Spark Jobs</span>
<span class="go">Movies with highest ratings:</span>
<span class="go">+-----------------+---------------------------------------------+-----+-------+</span>
<span class="go">|average          |title                                        |count|movieId|</span>
<span class="go">+-----------------+---------------------------------------------+-----+-------+</span>
<span class="go">|4.446990499637029|Shawshank Redemption, The (1994)             |63366|318    |</span>
<span class="go">|4.364732196832306|Godfather, The (1972)                        |41355|858    |</span>
<span class="go">|4.334372207803259|Usual Suspects, The (1995)                   |47006|50     |</span>
<span class="go">|4.310175010988133|Schindler&#39;s List (1993)                      |50054|527    |</span>
<span class="go">|4.275640557704942|Godfather: Part II, The (1974)               |27398|1221   |</span>
<span class="go">|4.2741796572216  |Seven Samurai (Shichinin no samurai) (1954)  |11611|2019   |</span>
<span class="go">|4.271333600779414|Rear Window (1954)                           |17449|904    |</span>
<span class="go">|4.263182346109176|Band of Brothers (2001)                      |4305 |7502   |</span>
<span class="go">|4.258326830670664|Casablanca (1942)                            |24349|912    |</span>
<span class="go">|4.256934865900383|Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)|6525 |922    |</span>
<span class="go">+-----------------+---------------------------------------------+-----+-------+</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="collaborative-filtering">
<h2><a class="toc-backref" href="#id8">Collaborative Filtering</a><a class="headerlink" href="#collaborative-filtering" title="Permalink to this headline"></a></h2>
<div class="section" id="exercise-2a-creating-a-training-set">
<h3><a class="toc-backref" href="#id9">Exercise (2a) Creating a Training Set</a><a class="headerlink" href="#exercise-2a-creating-a-training-set" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL_IN&gt; with the appropriate code.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We&#39;ll hold out 60% for training, 20% of our data for validation, and leave 20% for testing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="il">1800009193L</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">split_60_df</span><span class="p">,</span> <span class="n">split_a_20_df</span><span class="p">,</span> <span class="n">split_b_20_df</span><span class="p">)</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Let&#39;s cache these datasets for performance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_df</span> <span class="o">=</span> <span class="n">split_60_df</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validation_df</span> <span class="o">=</span> <span class="n">split_a_20_df</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_df</span> <span class="o">=</span> <span class="n">split_b_20_df</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;Training: {0}, validation: {1}, test: {2}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">training_df</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="n">validation_df</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="n">test_df</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validation_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-2b-alternating-least-squares">
<h3><a class="toc-backref" href="#id10">Exercise (2b) Alternating Least Squares</a><a class="headerlink" href="#exercise-2b-alternating-least-squares" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This step is broken in ML Pipelines: https://issues.apache.org/jira/browse/SPARK-14489</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.ml.recommendation</span> <span class="kn">import</span> <span class="n">ALS</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Let&#39;s initialize our ALS learner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">als</span> <span class="o">=</span> <span class="n">ALS</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now we set the parameters for the method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">als</span><span class="o">.</span><span class="n">setMaxIter</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>\
<span class="gp">&gt;&gt;&gt; </span>   <span class="o">.</span><span class="n">setSeed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>\
<span class="gp">&gt;&gt;&gt; </span>   <span class="o">.</span><span class="n">setRegParam</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>\
<span class="gp">&gt;&gt;&gt; </span>   <span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now let&#39;s compute an evaluation metric for our test dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.ml.evaluation</span> <span class="kn">import</span> <span class="n">RegressionEvaluator</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create an RMSE evaluator using the label and predicted columns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reg_eval</span> <span class="o">=</span> <span class="n">RegressionEvaluator</span><span class="p">(</span><span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;rating&quot;</span><span class="p">,</span> <span class="n">metricName</span><span class="o">=</span><span class="s2">&quot;rmse&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.03</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ranks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">errors</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_error</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">best_rank</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">ranks</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1"># Set the rank here:</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">als</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1"># Create the model with these parameters.</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">model</span> <span class="o">=</span> <span class="n">als</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1"># Run the model to create a prediction. Predict against the validation_df.</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">predict_df</span> <span class="o">=</span> <span class="n">model</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1"># Remove NaN values from prediction (due to SPARK-14489)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">predicted_ratings_df</span> <span class="o">=</span> <span class="n">predict_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">predict_df</span><span class="o">.</span><span class="n">prediction</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1"># Run the previously created RMSE evaluator, reg_eval, on the predicted_ratings_df DataFrame</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">error</span> <span class="o">=</span> <span class="n">reg_eval</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">errors</span><span class="p">[</span><span class="n">err</span><span class="p">]</span> <span class="o">=</span> <span class="n">error</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">models</span><span class="p">[</span><span class="n">err</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="k">print</span> <span class="s1">&#39;For rank </span><span class="si">%s</span><span class="s1"> the RMSE is </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rank</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="k">if</span> <span class="n">error</span> <span class="o">&lt;</span> <span class="n">min_error</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">min_error</span> <span class="o">=</span> <span class="n">error</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">best_rank</span> <span class="o">=</span> <span class="n">err</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">err</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">als</span><span class="o">.</span><span class="n">setRank</span><span class="p">(</span><span class="n">ranks</span><span class="p">[</span><span class="n">best_rank</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;The best model was trained with rank </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ranks</span><span class="p">[</span><span class="n">best_rank</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_model</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">best_rank</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="why-are-we-doing-our-own-cross-validation">
<h3><a class="toc-backref" href="#id11">Why are we doing our own cross-validation?</a><a class="headerlink" href="#why-are-we-doing-our-own-cross-validation" title="Permalink to this headline"></a></h3>
</div>
<div class="section" id="excersie-2c-testing-your-model">
<h3><a class="toc-backref" href="#id12">Excersie (2c) Testing Your Model</a><a class="headerlink" href="#excersie-2c-testing-your-model" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL_IN&gt; with the appropriate code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># In ML Pipelines, this next step has a bug that produces unwanted NaN values. We</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># have to filter them out. See https://issues.apache.org/jira/browse/SPARK-14489</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predict_df</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove NaN values from prediction (due to SPARK-14489)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted_test_df</span> <span class="o">=</span> <span class="n">predict_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">predict_df</span><span class="o">.</span><span class="n">prediction</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run the previously created RMSE evaluator, reg_eval, on the predicted_test_df DataFrame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_RMSE</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;The model had a RMSE on the test set of {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_RMSE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-2d-comparing-your-model">
<h3><a class="toc-backref" href="#id13">Exercise (2d) Comparing Your Model</a><a class="headerlink" href="#exercise-2d-comparing-your-model" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL_IN&gt; with the appropriate code.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute the average rating</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_rating_df</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract the average rating value. (This is row 0, column 0.)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_avg_rating</span> <span class="o">=</span> <span class="n">avg_rating_df</span><span class="o">.</span><span class="n">collect</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;The average rating for movies in the training set is {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">training_avg_rating</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add a column with the average rating</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_for_avg_df</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;prediction&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run the previously created RMSE evaluator, reg_eval, on the test_for_avg_df DataFrame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_avg_RMSE</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;The RMSE on the average set is {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_avg_RMSE</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="predictions-for-yourself">
<h2><a class="toc-backref" href="#id14">Predictions for Yourself</a><a class="headerlink" href="#predictions-for-yourself" title="Permalink to this headline"></a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Most rated movies:&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;(average rating, movie name, number of reviews, movie ID)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># display(movies_with_500_ratings_or_more.orderBy(movies_with_500_ratings_or_more[&#39;average&#39;].desc()).take(50))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movies_with_500_ratings_or_more</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">movies_with_500_ratings_or_more</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Most rated movies:</span>
<span class="go">(average rating, movie name, number of reviews, movie ID)</span>
<span class="go">+-----------------+-------------------------------------------+-----+-------+</span>
<span class="go">|average          |title                                      |count|movieId|</span>
<span class="go">+-----------------+-------------------------------------------+-----+-------+</span>
<span class="go">|4.446990499637029|Shawshank Redemption, The (1994)           |63366|318    |</span>
<span class="go">|4.364732196832306|Godfather, The (1972)                      |41355|858    |</span>
<span class="go">|4.334372207803259|Usual Suspects, The (1995)                 |47006|50     |</span>
<span class="go">|4.310175010988133|Schindler&#39;s List (1993)                    |50054|527    |</span>
<span class="go">|4.275640557704942|Godfather: Part II, The (1974)             |27398|1221   |</span>
<span class="go">|4.2741796572216  |Seven Samurai (Shichinin no samurai) (1954)|11611|2019   |</span>
<span class="go">|4.271333600779414|Rear Window (1954)                         |17449|904    |</span>
<span class="go">|4.263182346109176|Band of Brothers (2001)                    |4305 |7502   |</span>
<span class="go">+-----------------+-------------------------------------------+-----+-------+</span>
<span class="go">only showing top 8 rows</span>
</pre></div>
</div>
<div class="section" id="exercise-3a-your-movie-ratings">
<h3><a class="toc-backref" href="#id15">Exercise (3a) Your Movie Ratings</a><a class="headerlink" href="#exercise-3a-your-movie-ratings" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_user_id</span> <span class="o">=</span> <span class="mi">0</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note that the movie IDs are the *last* number on each line. A common error was to use the number of ratings as the movie ID.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_rated_movies</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="c1"># The format of each line is (my_user_id, movie ID, your rating)</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="c1"># For example, to give the movie &quot;Star Wars: Episode IV - A New Hope (1977)&quot; a five rating, you would add the following line:</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="c1">#   (my_user_id, 260, 5),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_ratings_df</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">my_rated_movies</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;userId&#39;</span><span class="p">,</span><span class="s1">&#39;movieId&#39;</span><span class="p">,</span><span class="s1">&#39;rating&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;My movie ratings:&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">display</span><span class="p">(</span><span class="n">my_ratings_df</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-3b-add-your-movies-to-training-dataset">
<h3><a class="toc-backref" href="#id16">Exercise (3b) Add Your Movies to Training Dataset</a><a class="headerlink" href="#exercise-3b-add-your-movies-to-training-dataset" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_with_my_ratings_df</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="p">(</span><span class="s1">&#39;The training dataset now has </span><span class="si">%s</span><span class="s1"> more entries than the original training dataset&#39;</span> <span class="o">%</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">(</span><span class="n">training_with_my_ratings_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">-</span> <span class="n">training_df</span><span class="o">.</span><span class="n">count</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">training_with_my_ratings_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">-</span> <span class="n">training_df</span><span class="o">.</span><span class="n">count</span><span class="p">())</span> <span class="o">==</span> <span class="n">my_ratings_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-3c-train-a-model-with-your-ratings">
<h3><a class="toc-backref" href="#id17">Exercise (3c) Train a Model with Your Ratings</a><a class="headerlink" href="#exercise-3c-train-a-model-with-your-ratings" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Reset the parameters for the ALS object.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">als</span><span class="o">.</span><span class="n">setPredictionCol</span><span class="p">(</span><span class="s2">&quot;prediction&quot;</span><span class="p">)</span>\
<span class="gp">&gt;&gt;&gt; </span>   <span class="o">.</span><span class="n">setMaxIter</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>\
<span class="gp">&gt;&gt;&gt; </span>   <span class="o">.</span><span class="n">setSeed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>\
<span class="gp">&gt;&gt;&gt; </span>   <span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the model with these parameters.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_ratings_model</span> <span class="o">=</span> <span class="n">als</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-3d-check-rmse-for-the-new-model-with-your-ratings">
<h3><a class="toc-backref" href="#id18">Exercise (3d) Check RMSE for the New Model with Your Ratings</a><a class="headerlink" href="#exercise-3d-check-rmse-for-the-new-model-with-your-ratings" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_predict_df</span> <span class="o">=</span> <span class="n">my_ratings_model</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove NaN values from prediction (due to SPARK-14489)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted_test_my_ratings_df</span> <span class="o">=</span> <span class="n">my_predict_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">my_predict_df</span><span class="o">.</span><span class="n">prediction</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run the previously created RMSE evaluator, reg_eval, on the predicted_test_my_ratings_df DataFrame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_RMSE_my_ratings</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;The model had a RMSE on the test set of {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_RMSE_my_ratings</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-3e-predict-your-ratings">
<h3><a class="toc-backref" href="#id19">Exercise (3e) Predict Your Ratings</a><a class="headerlink" href="#exercise-3e-predict-your-ratings" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL_IN&gt; with the appropriate code</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a list of my rated movie IDs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_rated_movie_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">my_rated_movies</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Filter out the movies I already rated.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">not_rated_df</span> <span class="o">=</span> <span class="n">movies_df</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Rename the &quot;ID&quot; column to be &quot;movieId&quot;, and add a column with my_user_id as &quot;userId&quot;.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_unrated_movies_df</span> <span class="o">=</span> <span class="n">not_rated_df</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use my_rating_model to predict ratings for the movies that I did not manually rate.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw_predicted_ratings_df</span> <span class="o">=</span> <span class="n">my_ratings_model</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted_ratings_df</span> <span class="o">=</span> <span class="n">raw_predicted_ratings_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">raw_predicted_ratings_df</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-3f-predict-your-ratings">
<h3><a class="toc-backref" href="#id20">Exercise (3f) Predict Your Ratings</a><a class="headerlink" href="#exercise-3f-predict-your-ratings" title="Permalink to this headline"></a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL_IN&gt; with the appropriate code</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted_with_counts_df</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted_highest_rated_movies_df</span> <span class="o">=</span> <span class="n">predicted_with_counts_df</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="p">(</span><span class="s1">&#39;My 25 highest rated movies as predicted (for movies with more than 75 reviews):&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted_highest_rated_movies_df</span><span class="o">.&lt;</span><span class="n">FILL_IN</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cs110_lab3a.html" class="btn btn-neutral float-right" title="cs110_lab3a_word_count_rdd" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cs110_lab1.html" class="btn btn-neutral" title="cs110_lab1_power_plant_ml_pipeline" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Takanori Watanabe.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>