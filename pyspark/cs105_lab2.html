<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>cs105_lab2_apache_log</title>
    
    <link rel="stylesheet" href="../_static/css/my_theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-2.3.2/simplex/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-2.3.2/css/bootstrap-responsive.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-2.3.2/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon-umich.ico"/>
    <link rel="top" title="" href="../index.html" />
    <link rel="up" title="EdX Course Notes (top-edx.rst)" href="top-edx.html" />
    <link rel="next" title="cs110_lab1_power_ml_pipeline" href="cs110_lab1.html" />
    <link rel="prev" title="cs105_lab1b_wordcount" href="cs105_lab1b.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="brand" href="../index.html">
          Coding Notebook</a>
        <span class="navbar-text pull-left"><b></b></span>

        <div class="nav-collapse">
          <ul class="nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://github.com/wtak23">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Table of Contents <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Table of Contents (PySpark)</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="top-edx.html">EdX Course Notes (<code class="docutils literal"><span class="pre">top-edx.rst</span></code>)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cs105_lab0.html">cs105_lab0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab0.html#create-dataframe-and-filter-it">Create DataFrame and filter it</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab0.html#load-a-text-file">Load a text file</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab0.html#check-plotting">Check plotting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs105_lab1a.html">cs105_lab1a</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a.html#spark-context">Spark Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a.html#sparkcontext-and-the-driver-program-cluster-structure">SparkContext and the Driver Program (Cluster Structure)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#about-the-driver-program">About the Driver Program</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#about-hivecontext-the-type-of-sqlcontext-for-db">About HiveContext (the type of sqlContext for DB)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#sparkcontext">SparkContext</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a.html#using-dataframes-and-chaining-transformations">Using DataFrames and chaining transformations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#dataframe-and-schema">DataFrame and Schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#ways-to-define-schemas">Ways to define schemas</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#distributed-data-and-using-a-collection-to-create-a-dataframe">Distributed Data and using a collection to create a DataFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a.html#query-plans-and-the-catalyst-optimizer">Query plans and the <code class="docutils literal"><span class="pre">Catalyst</span> <span class="pre">Optimizer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs105_lab1a_coding.html">cs105_lab1a codes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#exercise-overview">Exercise Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#create-list-of-data">Create list of Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#create-dataframe-from-a-list">Create DataFrame from a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#subtract-one-from-each-the-age-row">Subtract one from each the <em>age</em> row</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#apply-transformations-and-examine-query-plan">Apply transformations, and examine query plan</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#use-collect-to-view-results">Use <code class="docutils literal"><span class="pre">collect</span></code> to view results</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#display-helper-function-in-db">display helper function in DB</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#more-actions-count-to-get-total">More actions: <code class="docutils literal"><span class="pre">count</span></code> to get total</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#apply-transformation-filter-and-view-results-with-collect">Apply transformation <code class="docutils literal"><span class="pre">filter</span></code> and view results with <code class="docutils literal"><span class="pre">collect</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#lambda-functions-and-udfs">Lambda functions and UDFs</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#additional-dataframe-actions">Additional DataFrame actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#additional-dataframe-transformations">Additional DataFrame transformations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#orderby">orderBy</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#a-distinct-and-dropduplicates">A <code class="docutils literal"><span class="pre">distinct</span></code> and <code class="docutils literal"><span class="pre">dropDuplicates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#drop">drop</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#groupby">groupBy</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#sample">sample</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#caching-dataframes-and-storage-options">Caching DataFrames and Storage Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#unpersist-and-storage-options">Unpersist and storage options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1a_coding.html#debugging-spark-applications-and-lazy-evaluation">Debugging Spark applications and lazy evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#jvm-and-py4j-how-python-is-executed-in-spark">JVM and Py4J - How Python is Executed in Spark</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#challenges-with-lazy-evaluation-using-transformations-and-actions">Challenges with lazy evaluation using transformations and actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#finding-the-bug">Finding the bug</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1a_coding.html#moving-toward-expert-style">Moving toward expert style</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs105_lab1b.html">cs105_lab1b_wordcount</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#create-a-base-df-and-perform-operations">Create a base DF and perform operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#create-a-base-df">Create a base DF</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#use-df-functions-to-add-an-s">Use DF functions to add an &#8216;s&#8217;</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#length-of-each-word">Length of each word</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#counting-with-spark-sql-and-dataframes">Counting with Spark SQL and DataFrames</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#using-groupby-and-count">Using groupBy and count</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#finding-unique-words-and-a-mean-value">Finding unique words and a mean value</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#unique-words">Unique words</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#means-of-groups-using-dataframes">Means of groups using DataFrames</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#apply-word-count-to-a-file">Apply word count to a file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#the-wordcount-function">The wordCount function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#capitalization-and-punctuation">Capitalization and punctuation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#load-a-text-file">Load a text file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#words-from-lines">Words from lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs105_lab1b.html#count-the-words">Count the words</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs105_lab1b.html#random-stuffs-i-played-around-with">Random stuffs I played around with</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="">cs105_lab2_apache_log</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#part1-overview-web-server-log-analysis-with-apache-spark">Part1: Overview: Web Server Log Analysis with Apache Spark</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modules-used-in-this-assignment">Modules used in this assignment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataset-used">Dataset used</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#part2-exploratory-data-analysis">Part2: Exploratory Data Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a-loading-the-log-file">2a) loading the log file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#b-parsing-the-log-file">2b) Parsing the log file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-data-cleaning">2c) Data Cleaning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fix-the-rows-with-null-content-size">Fix the rows with null content_size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parsing-the-timestamp">Parsing the timestamp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#part3-analysis-walk-through-on-the-web-server-log-file">Part3: Analysis Walk-Through on the Web Server Log File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a-example-content-size-statistics">3a) Example: Content Size Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#b-example-http-status-analysis">3b) Example: HTTP Status Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-example-status-graphing">3c) Example: Status Graphing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#d-example-frequent-hosts">3d) Example: Frequent Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#e-example-visualizing-paths">3e) Example: Visualizing Paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="#f-example-top-paths">3f) Example: Top Paths</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#part-4-analyzing-web-server-log-file">Part 4: Analyzing Web Server Log File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a-exercise-top-ten-error-paths-hw">4a) Exercise: Top Ten Error Paths (HW)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#b-exercise-number-of-unique-hosts-hw">4b) Exercise: Number of Unique Hosts (HW)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-exercise-number-of-unique-daily-hosts">4c) Exercise: Number of Unique Daily Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#d-exercise-visualizing-the-number-of-unique-daily-hosts">4d) Exercise: Visualizing the Number of Unique Daily Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#e-exercise-average-number-of-daily-requests-per-host">4e) Exercise: Average Number of Daily Requests per Host</a></li>
<li class="toctree-l4"><a class="reference internal" href="#f-exercise-visualizing-the-average-daily-requests-per-unique-host">4f) Exercise: Visualizing the Average Daily Requests per Unique Host</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#part5-exploring-404-status-codes">Part5: Exploring 404 Status Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a-exercise-counting-404-response-codes">5a) Exercise: Counting 404 Response Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#b-exercise-listing-404-status-code-records">5b) Exercise: Listing 404 Status Code Records</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-exercise-listing-the-top-twenty-404-response-code-paths">5c) Exercise: Listing the Top Twenty 404 Response Code paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="#d-exercise-listing-the-top-twenty-five-404-response-code-hosts">5d) Exercise: Listing the Top Twenty-five 404 Response Code Hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#e-exercise-listing-404-errors-per-day">5e) Exercise: Listing 404 Errors per Day</a></li>
<li class="toctree-l4"><a class="reference internal" href="#f-exercise-visualizing-the-404-errors-by-day">5f) Exercise: Visualizing the 404 Errors by Day</a></li>
<li class="toctree-l4"><a class="reference internal" href="#h-exercise-hourly-404-errors">5h) Exercise: Hourly 404 Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#g-exercise-top-five-days-for-404-errors">5g) Exercise: Top Five Days for 404 Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#i-exercise-hourly-404-errors">5i) Exercise: Hourly 404 Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#j-exercise-visualizing-the-404-response-codes-by-hour">5j) Exercise: Visualizing the 404 Response Codes by Hour</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab1.html">cs110_lab1_power_ml_pipeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part1-business-understanding">Part1: Business Understanding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#background-power-generation">Background &#8212; power generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#challenge-for-power-grid-operation">Challenge for power grid operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#the-business-problem">The business problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#business-understanding">Business Understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part2-extract-transform-load-etl-your-data">Part2: Extract-Transform-Load (ETL) Your Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2a">Exercise 2a</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2b">Exercise 2b</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-2-alternative-method-to-load-your-data">Part 2: Alternative Method to Load your Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2c">Exercise 2c</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-2d">Exercise 2d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-3-explore-your-data">Part 3: Explore Your Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#a-register-the-dataframe-to-use-sql-commands">3a - <strong>register</strong> the DataFrame (to use sql commands)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#b-read-data-using-sql-command-databricks-only">3b - read data using <code class="docutils literal"><span class="pre">%sql</span></code> command (DataBricks only)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#c-use-sql-desc-command-to-describe-the-schema">3c - use SQL <code class="docutils literal"><span class="pre">desc</span></code> command to describe the schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#dataframe-describe-method">DataFrame <code class="docutils literal"><span class="pre">describe</span></code> method</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-4-visualize-your-data">Part 4: Visualize your data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-4a">Exercise 4a</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-4b-hw">Exercise 4b (hw)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-4c-hw">Exercise 4c (hw)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-4d-hw">Exercise 4d (hw)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-5-data-preparation">Part 5: Data Preparation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-5-a">Exercise 5(a)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-6-data-modeling">Part 6: Data Modeling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-6-a-hw">Exercise 6(a) (hw)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#b-build-linear-regression-model">6(b) - build Linear Regression Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#c-set-model-parameters-and-fit-linear-regression-model">6(c) - set model parameters, and fit linear regression model</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#d-study-the-fitted-lr-model">6(d) &#8212; study the fitted LR model</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#e-evalute-model-on-the-20-test-set">6(e) evalute model on the 20% test-set</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#f-quantify-performance-using-regressionevaluator">6(f) &#8211; quantify performance using <code class="docutils literal"><span class="pre">RegressionEvaluator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#g-use-r2-this-time">6(g) use R2 this time</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#h-register-our-test-dataframe-as-sql-table">6(h) Register our test DataFrame as SQL table</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#i-sql-statement-on-the-sql-table-registered-from-our-test-dataframe">6(i) SQL statement on the SQL table registered from our test DataFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#j-plot-histogram-of-rmse">6(j) Plot histogram of RMSE</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#k-plot-pie-chart">6(k) Plot pie chart</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1.html#part-7-tuning-and-evaluation">Part 7: Tuning and Evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#a-run-cross-validation-tuning">7(a) Run Cross Validation Tuning</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-b-evaluate-tuned-lr-model-hw">Exercise 7(b) &#8211; Evaluate tuned LR model (hw)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-c-decisiontreeregressor">Exercise 7(c) DecisionTreeRegressor</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-d">Exercise 7(d)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-e-evaluate-dtr-performance">Exercise 7(e) &#8212; evaluate DTR performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-f-random-forest-regressor">Exercise 7(f) (Random Forest Regressor)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-g-cross-validation">Exercise 7(g) (cross validation)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1.html#exercise-7-h-model-evaluation">Exercise 7(h) (model evaluation)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab1_trimmed.html">cs110_lab1_trimmed</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1_trimmed.html#part2-extract-transform-load-etl-your-data">Part2: Extract-Transform-Load (ETL) Your Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1_trimmed.html#exercise-2a">Exercise 2a</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab1_trimmed.html#exercise-2b">Exercise 2b</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab1_trimmed.html#part-2-alternative-method-to-load-your-data">Part 2: Alternative Method to Load your Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab2.html">cs110_lab2_als_prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab2.html#preliminaries">Preliminaries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#the-20-million-movie-sample">The 20-million movie sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#cpu-vs-io-tradeoff">CPU vs IO Tradeoff</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#load-and-cache">Load and Cache</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab2.html#basic-recommendations">Basic Recommendations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-1a-movies-with-highest-average-ratings">Exercise (1a) Movies with Highest Average Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-1b-movies-with-highest-average-ratings-and-at-least-500-reviews">Exercise (1b) Movies with Highest Average Ratings and at least 500 reviews</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab2.html#collaborative-filtering">Collaborative Filtering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-2a-creating-a-training-set">Exercise (2a) Creating a Training Set</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-2b-alternating-least-squares">Exercise (2b) Alternating Least Squares</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#why-are-we-doing-our-own-cross-validation">Why are we doing our own cross-validation?</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#excersie-2c-testing-your-model">Excersie (2c) Testing Your Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-2d-comparing-your-model">Exercise (2d) Comparing Your Model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab2.html#predictions-for-yourself">Predictions for Yourself</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3a-your-movie-ratings">Exercise (3a) Your Movie Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3b-add-your-movies-to-training-dataset">Exercise (3b) Add Your Movies to Training Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3c-train-a-model-with-your-ratings">Exercise (3c) Train a Model with Your Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3d-check-rmse-for-the-new-model-with-your-ratings">Exercise (3d) Check RMSE for the New Model with Your Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3e-predict-your-ratings">Exercise (3e) Predict Your Ratings</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab2.html#exercise-3f-predict-your-ratings">Exercise (3f) Predict Your Ratings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab3a.html">cs110_lab3a_word_count_rdd</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs110_lab3b.html">cs110_lab3b_text_analysis_ER</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#preliminaries">Preliminaries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#background-on-er">Background on ER</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#data-files">Data files</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#load-data-files">Load data files</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#examine-the-lines-loaded">Examine the lines loaded</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#part1-er-as-text-similarity-bags-of-words">Part1: ER as Text Similarity - Bags of Words</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#a-tokenize-a-string">1a) Tokenize a String</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#b-removing-stopwords">1b) removing stopwords</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#c-tokenizing-the-small-datasets">1c) Tokenizing the small datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#d-amazon-record-with-the-most-tokens">1d) Amazon record with the most tokens</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#part2-er-as-text-similarity-weighted-bag-of-words-using-tf-idf">Part2: ER as Text Similarity - Weighted Bag-of-Words using TF-IDF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#a-implement-a-tf-function">2a) Implement a TF function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#b-create-a-corpus">2b) Create a corpus</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#c-implement-an-idfs-function">2c) Implement an IDFs function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#d-tokens-with-the-smallest-idf">2d) Tokens with the smallest IDF</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#e-idf-histogram">2e) IDF Histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#f-implement-a-tf-idf-function">2f) Implement a TF-IDF function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#part-3-er-as-text-similarity-cosine-similarity">Part 3: ER as Text Similarity &#8212; Cosine Similarity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#a-implement-the-components-of-a-cosinesimilarity-function">3a) Implement the components of a cosineSimilarity function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#b-implement-a-cosinesimilarity-function">3b) Implement a cosineSimilarity function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#c-perform-entity-resolution">3c) Perform Entity Resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#d-perform-entity-resolution-with-broadcast-variables">3d) Perform Entity Resolution with Broadcast Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#e-perform-a-gold-standard-evaluation">3e) Perform a Gold Standard evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#using-the-gold-standard-data-we-can-answer-the-following-questions">Using the &#8220;gold standard&#8221; data we can answer the following questions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#part-4-scalable-er">Part 4: Scalable ER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#inverted-indices">Inverted Indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#a-tokenize-the-full-dataset">4a) Tokenize the full dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#b-compute-idfs-and-tf-idfs-for-the-full-datasets">4b) Compute IDFs and TF-IDFs for the full datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#c-compute-norms-for-the-weights-from-the-full-datasets">4c) Compute Norms for the weights from the full datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#d-create-inverted-indices-from-the-full-datasets">4d) Create inverted indices from the full datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#e-identify-common-tokens-from-the-full-dataset">4e) Identify common tokens from the full dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#f-identify-common-tokens-from-the-full-dataset">4f) Identify common tokens from the full dataset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#part-5-analysis">Part 5: Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#a-counting-true-positives-false-positives-and-false-negatives">5a) Counting True Positives, False Positives, and False Negatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#b-precision-recall-and-f-measures">5b Precision, Recall, and F-measures</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs110_lab3b.html#c-line-plots">5c Line Plots</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs110_lab3b.html#discussion-of-results">Discussion of results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab1a.html">cs120_lab1a_math_review</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab1a.html#math-review">Math review</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-1a-scalar-multiplication-vectors">Exercise (1a) Scalar multiplication: vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-1b-element-wise-multiplication-vectors">Exercise (1b) Element-wise multiplication: vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-1c-dot-product">Exercise (1c) Dot product</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-1d-matrix-multiplication">Exercise (1d) Matrix multiplication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab1a.html#numpy">NumPy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-2a-scalar-multiplication">Exercise (2a) Scalar multiplication</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-2b-element-wise-multiplication-and-dot-product">Exercise (2b) Element-wise multiplication and dot product</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-2c-matrix-math">Exercise (2c) Matrix math</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab1a.html#additional-numpy-and-spark-linear-algebra">Additional NumPy and Spark linear algebra</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-3a-slices">Exercise (3a) Slices</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-3b-combining-ndarray-objects">Exercise (3b) Combining ndarray objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-3c-pyspark-s-densevector">Exercise (3c) PySpark&#8217;s DenseVector</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab1a.html#python-lambda-expressions">Python lambda expressions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4a-lambda-is-an-anonymous-function">Exercise (4a) Lambda is an anonymous function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4b-lambda-fewer-steps-than-def">Exercise (4b) lambda fewer steps than def</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4c-lambda-expression-arguments">Exercise (4c) Lambda expression arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4d-restrictions-on-lambda-expressions">Exercise (4d) Restrictions on lambda expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4e-functional-programming">Exercise (4e) Functional programming</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab1a.html#exercise-4f-composability">Exercise (4f) Composability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab1b.html">cs120_lab1b_word_count_rdd</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab2.html">cs120_lab2_linear_regression_df</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab3.html">cs120_lab3_ctr_df</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs120_lab4.html">cs120_lab4_pca</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab4.html#work-through-the-steps-of-pca-on-a-sample-dataset">Work through the steps of PCA on a sample dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-1-two-dimensional-gaussians">Visualization 1: Two-dimensional Gaussians</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#a-interpreting-pca">1a) Interpreting PCA</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#b-sample-covariance-matrix">1b) Sample covariance matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#c-covariance-function">1c) Covariance Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#d-eigendecomposition">1d) Eigendecomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#e-pca-scores">1e) PCA scores</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab4.html#write-a-pca-function-and-evaluate-pca-on-sample-datasets">Write a PCA function and evaluate PCA on sample datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#a-pca-function">2a) PCA function</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#b-pca-on-data-random">2b) PCA on data_random</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-2-pca-projection">Visualization 2: PCA projection</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-3-three-dimensional-data">Visualization 3: Three-dimensional data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#c-3d-to-2d">2c) 3D to 2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-4-2d-representation-of-3d-data">Visualization 4: 2D representation of 3D data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#d-variance-explained">2d) Variance explained</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab4.html#parse-inspect-and-preprocess-neuroscience-data-then-perform-pca">Parse, inspect, and preprocess neuroscience data then perform PCA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#a-load-neuroscience-data">3a) Load neuroscience data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#b-parse-the-data">3b) Parse the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#c-min-and-max-fluorescence">3c) Min and max fluorescence</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-5-pixel-intensity">Visualization 5: Pixel intensity</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#d-fractional-signal-change">3d) Fractional signal change</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-6-normalized-data">Visualization 6: Normalized data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#e-pca-on-the-scaled-data">3e) PCA on the scaled data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-7-top-two-components-as-images">Visualization 7: Top two components as images</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-8-top-two-components-as-one-image">Visualization 8: Top two components as one image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cs120_lab4.html#feature-based-aggregation-and-pca">Feature-based aggregation and PCA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#a-aggregation-using-arrays">(4a) Aggregation using arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#b-recreate-with-np-tile-and-np-eye">(4b) Recreate with np.tile and np.eye</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#c-recreate-with-np-kron">(4c) Recreate with np.kron</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#d-aggregate-by-time">(4d) Aggregate by time</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#e-obtain-a-compact-representation">(4e) Obtain a compact representation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-9-top-two-components-by-time">Visualization 9: Top two components by time</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#f-aggregate-by-direction">(4f) Aggregate by direction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#g-compact-representation-of-direction-data">(4g) Compact representation of direction data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cs120_lab4.html#visualization-10-top-two-components-by-direction">Visualization 10: Top two components by direction</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="top-pyspark.html">PySpark Notes (<code class="docutils literal"><span class="pre">top-pyspark.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyspark-snippet.html">1 <code class="docutils literal"><span class="pre">pyspark-snippet.rst</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#dbf">1.1 DBF</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#modules">1.2 Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#spark-notebook-helpers-library-for-databricks">1.3 spark_notebook_helpers library for Databricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#create-toy-dataset">1.4 Create toy dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#print-rdd-per-item">1.5 Print RDD per item</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#databrick-helper-function-displaying-all-dfs-in-the-notebook">1.6 Databrick helper function displaying all DFs in the notebook</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#get-shape-of-df-gotta-be-a-better-way">1.7 Get shape of DF (gotta be a better way)</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#random-snippets">1.8 Random snippets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-snippet.html#print-dataframes-in-my-workspace-super-ad-hoc">1.8.1 print dataframes in my workspace (super-ad-hoc)</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-snippet.html#rename-column">1.8.2 Rename column</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#dbutils">1.9 dbutils</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-snippet.html#random-from-spark-essentials-spark-summit-2016">1.10 Random from Spark Essentials (Spark Summit 2016)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-practice.html">2 <code class="docutils literal"><span class="pre">pyspark-practice.rst</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#basics-dfs">2.1 Basics DFs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#udfs">2.2 UDFs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#sorting">2.3 Sorting</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#create-df-from-list-of-tuples">2.4 Create DF from list of tuples</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#groupby">2.5 groupby</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#practice-with-faker-data">2.6 Practice with faker data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-practice.html#little-refrehser-on-generators">2.6.1 Little refrehser on generators</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#register-table-to-use-sql">2.7 Register table to use SQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-practice.html#more">2.8 More</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-overflow.html">3 <code class="docutils literal"><span class="pre">pyspark-overflow.rst</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-to-get-a-value-from-the-row-object-in-spark-dataframe">3.1 How to get a value from the Row object in Spark Dataframe?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-to-add-a-constant-column-in-a-spark-dataframe">3.2 How to add a constant column in a Spark DataFrame?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#add-an-empty-column-to-spark-dataframe">3.3 Add an empty column to Spark DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#count-number-of-non-nan-entries-in-each-column-of-spark-dataframe">3.4 Count number of non-NaN entries in each column of Spark dataframe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#use-simple-aggregation">3.4.1 Use simple aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#use-sql-null-semantics">3.4.2 Use SQL <code class="docutils literal"><span class="pre">NULL</span></code> semantics</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#in-fractions">3.4.3 In fractions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#updating-a-dataframe-column-in-spark">3.5 Updating a dataframe column in spark</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-do-i-add-a-new-column-to-spark-data-frame-pyspark">3.6 How do I add a new column to spark data frame (Pyspark)?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#use-literals-lit">3.6.1 Use literals <code class="docutils literal"><span class="pre">lit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#transforming-an-existing-column">3.6.2 Transforming an existing column</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-join">3.6.3 Using <code class="docutils literal"><span class="pre">join</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-function-udf">3.6.4 Using function/UDF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#how-to-change-dataframe-column-names-in-pyspark">3.7 How to change dataframe column names in pyspark?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#option-1-using-selectexpr">3.7.1 Option 1. Using selectExpr.</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#option-2-using-withcolumnrenamed">3.7.2 Option 2. Using <code class="docutils literal"><span class="pre">withColumnRenamed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-alias">3.7.3 Using alias</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#using-sqlcontext-sql">3.7.4 Using <code class="docutils literal"><span class="pre">sqlContext.sql</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#pyspark-dataframes-way-to-enumerate-without-converting-to-pandas">3.8 PySpark DataFrames - way to enumerate without converting to Pandas?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#dividing-two-columns-from-a-different-df">3.9 Dividing two columns from a different DF</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-overflow.html#ones-i-just-bookmarked-for-future-reference">3.10 Ones I just bookmarked for future reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyspark-overflow.html#reshaping-pivoting-data-in-spark-rdd-and-or-spark-dataframes">3.10.1 Reshaping/Pivoting data in Spark RDD and/or Spark DataFrames</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyspark-install.html">4 Install PySpark (<code class="docutils literal"><span class="pre">pyspark-install</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyspark-install.html#windows">4.1 windows?</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyspark-install.html#retry-above-is-a-clusterfuck">4.2 Retry, above is a clusterfuck</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-prog-guide-rdd.html">5 (todo) Spark Programming Guide (<code class="docutils literal"><span class="pre">apache-prog-guide-rdd</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="apache-prog-guide-df.html">6 Spark Programming Guide DataFrames (<code class="docutils literal"><span class="pre">apache-prog-guide-df</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#overview">6.1 Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#sql">6.1.1 SQL</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#datasets-and-dataframes">6.1.2 Datasets and DataFrames</a><ul>
<li class="toctree-l5"><a class="reference internal" href="apache-prog-guide-df.html#datasets">6.1.2.1 Datasets</a></li>
<li class="toctree-l5"><a class="reference internal" href="apache-prog-guide-df.html#dataframe">6.1.2.2 DataFrame</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#getting-started">6.2 Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#starting-point-sparksession">6.2.1 Starting Point: <code class="docutils literal"><span class="pre">SparkSession</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#creating-dataframes">6.2.2 Creating DataFrames</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#untyped-dataset-operations-aka-dataframe-operations">6.2.3 Untyped Dataset Operations (aka DataFrame Operations)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#running-sql-queries-programmatically">6.2.4 Running SQL Queries Programmatically</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#creating-datasets-only-in-scala-java">6.2.5 Creating Datasets (only in Scala/Java)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#interoperating-with-rdds">6.2.6 Interoperating with RDDs</a><ul>
<li class="toctree-l5"><a class="reference internal" href="apache-prog-guide-df.html#inferring-the-schema-using-reflection">6.2.6.1 Inferring the Schema Using Reflection</a></li>
<li class="toctree-l5"><a class="reference internal" href="apache-prog-guide-df.html#programmatically-specifying-the-schema">6.2.6.2 Programmatically Specifying the Schema</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#data-sources">6.3 Data Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#generic-load-functions">6.4 Generic Load Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#default-parquet">6.4.1 Default (parquet)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#manually-specifying-options">6.4.2 Manually Specifying Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#run-sql-on-files-directly">6.4.3 Run SQL on files directly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#generic-save-functions">6.5 Generic Save Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#save-modes">6.5.1 Save Modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#saving-to-persistent-tables">6.5.2 __Saving to Persistent Tables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#parquet-files">6.6 Parquet Files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#loading-data-programmatically">6.6.1 Loading Data Programmatically</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#partition-discovery">6.6.2 __Partition Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#schema-merging">6.6.3 Schema Merging</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#hive-metastore-parquet-conversion">6.6.4 __Hive metastore Parquet Conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#configuration">6.6.5 Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#json-datasets">6.7 JSON Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#hive-tables">6.8 Hive Tables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#interacting-with-different-versions-of-hive-metastore">6.8.1 __Interacting with Different Versions of Hive Metastore</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#jdbc-to-other-databases">6.9 __JDBC To Other Databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#performance-tuning">6.10 Performance Tuning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#caching-data-in-memory">6.10.1 Caching Data in Memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#other-configuration-options">6.10.2 Other Configuration Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#distributed-sql-engine">6.11 Distributed SQL Engine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#running-the-thrift-jdbc-odbc-server">6.11.1 __Running the Thrift JDBC/ODBC server</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#running-the-spark-sql-cli">6.11.2 Running the Spark SQL CLI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-prog-guide-df.html#reference">6.12 Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#data-types">6.12.1 Data-Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-prog-guide-df.html#nan-semantics">6.12.2 NaN Semantics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="databricks.html">7 Databrick Doc (<code class="docutils literal"><span class="pre">databricks.rst</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="databricks.html#ml-stuffs">7.1 ML Stuffs</a></li>
<li class="toctree-l3"><a class="reference internal" href="databricks.html#bunch-of-notebooks">7.2 Bunch of notebooks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apache-ml-guide.html">MLLib - Main guide (<code class="docutils literal"><span class="pre">apache-ml-guide.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-guide.pipeline-old.html">1 Pipeline-old (<code class="docutils literal"><span class="pre">pipeline-old</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#main-concepts-in-pipelines">1.1 Main concepts in Pipelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#dataframe">1.2 DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#pipeline-components">1.3 Pipeline components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#transformers">1.3.1 Transformers</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#estimators">1.3.2 Estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#properties-of-pipeline-components">1.3.3 Properties of pipeline components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#pipeline-transformers-and-estimators">1.4 Pipeline (transformers and estimators)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#how-it-works">1.4.1 How it works</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#details">1.4.2 Details</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#parameters">1.5 Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#saving-and-loading-pipelines">1.6 Saving and Loading Pipelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#code-examples">1.7 Code Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#estimator-transformer-and-param">1.7.1 Estimator, Transformer, and Param</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#example-pipeline">1.7.2 Example: Pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#example-model-selection-via-cv-scala">1.7.3 Example: model selection via CV (Scala)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.pipeline-old.html#example-model-selection-via-train-validation-split-scala">1.7.4 Example: model selection via train validation split (scala)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-guide.et-fs.html">2 Extracting, transforming and selecting features (<code class="docutils literal"><span class="pre">et-fs</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.et-fs.html#feature-extractors">2.1 Feature Extractors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#tf-idf">2.1.1 TF-IDF</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#word2vec">2.1.2 Word2Vec</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#countvectorizer">2.1.3 CountVectorizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.et-fs.html#feature-transformers">2.2 Feature Transformers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#tokenizer">2.2.1 Tokenizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#stopwordsremover">2.2.2 StopWordsRemover</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#n-gram">2.2.3 n-gram</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#binarizer">2.2.4 Binarizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#pca">2.2.5 PCA</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#polynomialexpansion">2.2.6 PolynomialExpansion</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#discrete-cosine-transform-dct">2.2.7 Discrete Cosine Transform (DCT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#stringindexer">2.2.8 StringIndexer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#indextostring">2.2.9 IndexToString</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#onehotencoder">2.2.10 OneHotEncoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#vectorindexer">2.2.11 VectorIndexer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#normalizer">2.2.12 Normalizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#standardscaler">2.2.13 StandardScaler</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#minmaxscaler">2.2.14 MinMaxScaler</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#maxabsscaler">2.2.15 MaxAbsScaler</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#bucketizer">2.2.16 Bucketizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#elementwiseproduct-bm">2.2.17 ElementwiseProduct (bm)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#sqltransformer-bm">2.2.18 SQLTransformer (bm)</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#vectorassembler">2.2.19 VectorAssembler</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#quantilediscretizer">2.2.20 QuantileDiscretizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.et-fs.html#feature-selectors">2.3 Feature Selectors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#vectorslicer">2.3.1 VectorSlicer</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#rformula">2.3.2 RFormula</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.et-fs.html#chisqselector">2.3.3 ChiSqSelector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-guide.classification.html">3 Classification (<code class="docutils literal"><span class="pre">classification</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#logistic-regression">3.1 Logistic regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#decision-tree-classifier">3.2 Decision tree classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#random-forest-classifier">3.3 Random forest classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#gradient-boosted-tree-classifier">3.4 Gradient-boosted tree classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#multilayer-perceptron-classifier">3.5 Multilayer perceptron classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#one-vs-rest-classifier-a-k-a-one-vs-all">3.6 One-vs-Rest classifier (a.k.a. One-vs-All)</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.classification.html#naive-bayes">3.7 Naive Bayes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-guide.regression.html">4 Regression (<code class="docutils literal"><span class="pre">regression.rst</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#linear-regression">4.1 Linear regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#generalized-linear-regression">4.2 Generalized linear regression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.regression.html#available-families">4.2.1 Available families</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#decision-tree-regression">4.3 Decision tree regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#random-forest-regression">4.4 Random forest regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#gradient-boosted-tree-regression">4.5 Gradient-boosted tree regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#survival-regression">4.6 Survival regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.regression.html#isotonic-regression">4.7 Isotonic regression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.regression.html#examples">4.7.1 Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-guide.tree.html">5 Tree-based-methods (<code class="docutils literal"><span class="pre">tree.rst</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.tree.html#decision-trees">5.1 Decision trees</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.tree.html#inputs-and-outputs">5.1.1 Inputs and Outputs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-guide.tree.html#tree-ensembles">5.2 Tree Ensembles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.tree.html#random-forests">5.2.1 Random Forests</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-guide.tree.html#gradient-boosted-trees-gbts">5.2.2 Gradient-Boosted Trees (GBTs)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apache-ml-rdd.html">MLLib: RDD-based API Guideline (<code class="docutils literal"><span class="pre">apache-ml-rdd</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-rdd.datatype.html">1 Data Types (<code class="docutils literal"><span class="pre">datatypes</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.datatype.html#local-vector">1.1 Local vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.datatype.html#labeled-point">1.2 Labeled point</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.datatype.html#local-matrix">1.3 Local matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.datatype.html#distributed-matrix">1.4 Distributed matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.datatype.html#rowmatrix">1.4.1 RowMatrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.datatype.html#indexedrowmatrix">1.4.2 IndexedRowMatrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.datatype.html#coordinatematrix">1.4.3 CoordinateMatrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.datatype.html#blockmatrix">1.4.4 BlockMatrix</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-rdd.stats.html">2 Basic Statistics (<code class="docutils literal"><span class="pre">stats</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#summary-statistics">2.1 Summary statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#correlations">2.2 Correlations</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#stratified-sampling">2.3 Stratified sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#hypothesis-testing">2.4 Hypothesis testing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.stats.html#streaming-significance-testing">2.4.1 Streaming Significance Testing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#random-data-generation">2.5 Random data generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.stats.html#kernel-density-estimation">2.6 Kernel density estimation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apache-ml-rdd.eval.html">3 Evaluation metrics (<code class="docutils literal"><span class="pre">eval</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.eval.html#classification-model-evaluation">3.1 Classification model evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.eval.html#binary-classification">3.1.1 Binary classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.eval.html#multiclass-classification">3.1.2 Multiclass classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.eval.html#multilabel-classification">3.1.3 Multilabel classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="apache-ml-rdd.eval.html#ranking-systems">3.1.4 Ranking systems</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache-ml-rdd.eval.html#regression-model-evaluation">3.2 Regression model evaluation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Table of Contents (Others)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bash_wooledge/top-bash-wool.html">Bash wooledge (<code class="docutils literal"><span class="pre">top-bash-wool.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/special_char.html">1 Special Characters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/param.html">2 Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/param.html#basic">2.1 Basic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#always-double-quote-when-doing-pe-parameter-expansion">2.1.1 Always double-quote when doing PE (parameter expansion)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#char-needed-with-dealing-with-numerics">2.1.2 char needed with dealing with numerics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/param.html#special-parameters-and-variables">2.2 Special Parameters and Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#special-parameters">2.2.1 Special Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#special-variables-provided-by-the-shell">2.2.2 Special variables provided by the shell</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/param.html#pe-tricks-some-i-rarely-use">2.3 PE tricks (some I rarely use)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#summary-table">2.3.1 Summary table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var">2.3.2 <code class="docutils literal"><span class="pre">${var}</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-word-use-default-value">2.3.3 <code class="docutils literal"><span class="pre">${var:-word}</span></code> (use default value)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-word-assign-default">2.3.4 <code class="docutils literal"><span class="pre">${var:=word}</span></code> (assign default)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-word-use-alternate-value">2.3.5 <code class="docutils literal"><span class="pre">${var:+word}</span></code> (use alternate value)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-offset-length-substring-expansion">2.3.6 <code class="docutils literal"><span class="pre">${var:offset:length}</span></code> (substring expansion)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-var-number-of-characters-or-array-items">2.3.7 <code class="docutils literal"><span class="pre">${#var}</span></code>, <code class="docutils literal"><span class="pre">${#var[&#64;]}</span></code> (number of characters or array items)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-pattern-delete-beginning-of-str-if-match">2.3.8 <code class="docutils literal"><span class="pre">${var#pattern}</span></code> (delete beginning of str if match)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/param.html#var-msg-print-msg-to-stderr">2.3.9 <code class="docutils literal"><span class="pre">${var:?msg}</span></code> (print msg to stderr)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/patterns.html">3 Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#glob-patterns">3.1 Glob patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/patterns.html#use-glob-not-ls-for-looping-over-files">3.1.1 Use glob, not ls for looping over files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#extended-globs-i-rather-use-regexp">3.2 Extended Globs (I rather use regexp)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#regular-expressions">3.3 Regular expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/patterns.html#brace-expansion">3.4 Brace Expansion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/tests.html">4 Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/tests.html#exit-status-0-success-use">4.1 Exit status (0 = success)....use $?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/tests.html#control-operators-and">4.2 Control operators (&amp;&amp; and ||)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/tests.html#grouping-statements">4.3 Grouping statements {...;}</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/tests.html#use-case1-reporting-stderr-on-complex-test">4.3.1 Use-case1: reporting stderr on complex test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/tests.html#use-case2-redirect-input-to-a-group-of-statements">4.3.2 Use-case2: redirect input to a group of statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bash_wooledge/tests.html#use-case3-error-handling">4.3.3 Use-case3: error handling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../bash_wooledge/conditionals.html">5 Conditionals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/conditionals.html#conditional-blocks-if-test-and">5.1 Conditional Blocks (if, test and [[)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/conditionals.html#conditional-loops-while-until-and-for">5.2 Conditional Loops (while, until and for)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bash_wooledge/conditionals.html#choices-case-and-select">5.3 Choices (case and select)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sed/sed-tutorial.gnu.html">sed-tutorial-gnu (<code class="docutils literal"><span class="pre">sed-tutorial.gnu.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#execution-cycle-how-sed-works">Execution Cycle: How sed works</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#addresses-selecting-lines-with-sed">Addresses: Selecting lines with sed</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#single-address-form">Single address form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#two-address-form">Two address form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#match-negation-via">Match negation via <code class="docutils literal"><span class="pre">!</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#regular-expressions-overview-of-regular-expression-syntax">Regular Expressions: Overview of regular expression syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#common-commands-often-used-commands">Common Commands: Often used commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#the-s-command-sed-s-swiss-army-knife">The &#8220;s&#8221; Command: sed&#8217;s Swiss Army Knife</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#replacement">replacement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#flags">flags</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#other-commands-less-frequently-used-commands">Other Commands: Less frequently used commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.gnu.html#programming-commands-commands-for-sed-gurus">Programming Commands: Commands for sed gurus</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html">sed-tutorials-points (<code class="docutils literal"><span class="pre">sed-tutorial.tut</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#sed-workflow">Sed - workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#basic-syntax-and-examples">Basic syntax and examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#standard-options">Standard options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#gnu-specific-options">GNU specific options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#loops-branches">Loops, Branches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#address-range-search-by-specifying-line-nums">Address range (search by specifying line-nums)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#p-syntax">&#8216;p&#8217; syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#m-n-syntax">&#8216;M,+n&#8217; syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#id1">&#8216;M,~n&#8217; syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#pattern-range-search-for-simple-text-or-regexp-using-regex-syntax">Pattern range - search for simple-text or regexp using /regex/ syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#basic-commands-delete-read-write-append">Basic commands (delete, read, write, append)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#delete-command-address1-address2-d">Delete command [address1[,address2]]d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#write-command-address1-address2-w-file">Write command [address1[,address2]]w file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#append-command-address-a">Append command [address]a</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#change-command-address1-address2-c">Change command [address1[,address2]]c</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#insert-command-address-i">Insert Command [address]i</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#translate-command-address1-address2-y-list-1-list-2">Translate command [address1[,address2]]y/list-1/list-2/</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#i-command">I command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#quit-command-address-q">Quit Command [address]q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#read-command-address-r-file">Read Command [address]r file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#exectuve-command-address1-address2-e-command">Exectuve Command [address1[,address2]]e [command]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sed/sed-tutorial.tutorialspoints.html#miscellaneous-commands">Miscellaneous Commands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../awk-tutorial/awk-tutorial.html">awk-tutorial (<code class="docutils literal"><span class="pre">awk-tutorial.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-basic-structure.html">1 Basic structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html">2 The Essential Syntax of AWK</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#unary-arithmetic-operators">2.1 Unary arithmetic operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#the-autoincrement-and-autodecrement-operators">2.2 The Autoincrement and Autodecrement Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#assignment-operators">2.3 Assignment Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#conditional-expressions">2.4 Conditional expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#regular-expressions">2.5 Regular Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-essential-syntax.html#and-or-not">2.6 And/Or/Not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-summary-commands.html">3 Summary of AWK Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html">4 AWK Built-in Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#fs-the-input-field-separator-variable">4.1 FS - The Input Field Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#ofs-the-output-field-separator-variable">4.2 OFS - The Output Field Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#nf-the-number-of-fields-variable">4.3 NF - The Number of Fields Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#nr-the-number-of-records-variable">4.4 NR - The Number of Records Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#rs-the-record-separator-variable">4.5 RS - The Record Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#ors-the-output-record-separator-variable">4.6 ORS - The Output Record Separator Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tutorial/awk-builtin-vars.html#filename-the-current-filename-variable">4.7 FILENAME - The Current Filename Variable</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../awk-tp.html">Awk Tutorials Points (<code class="docutils literal"><span class="pre">awk-tp.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../awk-ss64.html">1 Whirlwind tour from ss64</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#basic-syntax">1.1 Basic syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#awk-patterns">1.2 awk-patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#variable-names-that-are-predefined">1.3 Variable names that are predefined</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#examples">1.4 Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-ss64.html#complex-examples">1.5 Complex examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-grymoire.html">2 Tables from grymoire</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#arithmetic-expressions">2.1 Arithmetic expressions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#binary-operator">2.1.1 Binary operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#assignment-operator">2.1.2 Assignment operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#conditional-expressions">2.1.3 Conditional expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#regexp">2.1.4 Regexp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#summary-of-awk-commands">2.2 Summary of AWK commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#build-int-awk-variables">2.3 Build-int AWK variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#printf-formatting">2.4 printf - formatting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#syntax">2.4.1 syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#escape-sequences">2.4.2 Escape sequences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#format-specifiers">2.4.3 Format specifiers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#width-specify-minimum-field-size">2.4.4 Width - specify minimum field size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#my-own-example-use-to-left-justify-string-in-s">2.4.5 my own example (use &#8220;-&#8221; to left justify string in %s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#examples-of-complex-formatting">2.4.6 Examples of complex formatting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#explicit-file-output">2.4.7 Explicit file output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#flow-control-with-next-and-exit">2.5 Flow Control with next and exit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#awk-numerical-functions">2.6 AWK Numerical Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-grymoire.html#awk-string-functions">2.7 AWK String functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#split-demo">2.7.1 split demo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#gsub-demo">2.7.2 gsub demo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awk-grymoire.html#match-demo">2.7.3 match demo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tp.workflow.html">3 awk-workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.workflow.html#the-begin-body-end-block">3.1 The BEGIN, body, END block</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.workflow.html#first-example-on-marks-txt-file">3.2 First example on marks.txt file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tp.basic-syntax.html">4 AWK Basic Syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#awk-help">4.1 awk &#8211;help</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#awk-in-the-terminal-or-program-file">4.2 AWK in the terminal or Program file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#v-option">4.3 -v option</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#dump-global-variables">4.4 dump global variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../awk-tp.basic-syntax.html#profile-file-to-create-pretty-printed-script-file">4.5 &#8211;profile[=file] to create pretty-printed script file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../awk-tp.basic-examples.html">5 AWK &#8211; Basic Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../top-sqlite.html">SQL notes (<code class="docutils literal"><span class="pre">top-sqlite.rst</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sqlite.tutpoint.html">1 SQLite notes from tutorialpoint</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html">1.1 SQLite commands overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html#ddl-data-definition-language">1.1.1 DDL (data definition language)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html#dml-data-manipulation-language">1.1.2 DML (Data manipulation language)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.1_commands_overview.html#dql-data-query-language">1.1.3 DQL (data query language)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.2_unsupported_commands.html">1.2 Unsupported features in SQLite</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html">1.3 sqlite commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#the-dot-commands-from-sqlite">1.3.1 the <em>dot</em> commands from sqlite</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#show-see-default-settings">1.3.2 show &#8211; see default settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#format-output-with-header-mode-timer">1.3.3 Format output with (header, mode, timer)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.3_sqlite_commands.html#the-sqlite-master-table">1.3.4 The sqlite_master Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html">1.4 SQLite syntax (a whirl-wind tour)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#case-sensitivity">1.4.1 Case Sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#comments">1.4.2 Comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#sqlite-statements-and-clause">1.4.3 SQLite Statements and Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#create-table">1.4.4 CREATE TABLE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#create-trigger">1.4.5 CREATE TRIGGER</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#group-by">1.4.6 GROUP BY</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#having">1.4.7 HAVING</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#pragma">1.4.8 PRAGMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.4_sqlite_syntax.html#update">1.4.9 UPDATE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html">1.5 SQLite Data Type</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#sqlite-storage-classes">1.5.1 SQLite Storage Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#sqlite-affinity-type">1.5.2 SQLite Affinity Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#sqlite-affinity-and-type-names">1.5.3 SQLite Affinity and Type Names</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.5_datatype.html#date-and-time-datatype">1.5.4 Date and Time Datatype</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html">1.6 SQLite DDL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#create-database">1.6.1 CREATE Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#attach-database">1.6.2 ATTACH Database</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#basic-syntax">1.6.2.1 Basic syntax</a></li>
<li class="toctree-l5"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#demo">1.6.2.2 Demo</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#detach-database">1.6.3 DETACH Database</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#example">1.6.3.1 Example</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#create-table">1.6.4 CREATE Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.6_sqlite_DDL.html#drop-table">1.6.5 DROP Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html">1.7 SQLite DML</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#insert-query">1.7.1 INSERT Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#select-query">1.7.2 SELECT Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#update-query">1.7.3 UPDATE Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_DML.html#delete-query">1.7.4 DELETE Query</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html">1.8 SQLite clauses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#where-clause">1.8.1 WHERE Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#and-or-clause">1.8.2 AND, OR Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#like-clause">1.8.3 LIKE Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#glob-clause">1.8.4 GLOB Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#limit-clause">1.8.5 LIMIT Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#having-clause">1.8.6 HAVING Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#unions-clause">1.8.7 UNIONS Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#order-by-clause">1.8.8 ORDER BY Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#group-by-clause">1.8.9 GROUP BY Clause</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite.tutpoint.7_sqlite_clauses.html#distinct-clause-keyword">1.8.10 DISTINCT Clause/keyword</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.8_sqlite_expressions.html">1.9 SQLite Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite.tutpoint.8_sqlite_operators.html">1.10 SQLite Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_5.html">1.11 SQLite - useful functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_5.html#summary-of-key-functions">1.11.1 Summary of key functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_5.html#examples">1.11.2 Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sqlite_doc.html">2 Bunch of stuffs from the official doc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#command-line-shell-for-sqlite-incomplete">2.1 Command Line Shell for SQLite (incomplete)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#semicolon-to-indicate-end-of-sql-command">2.1.1 Semicolon to indicate end of SQL command</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#dot-commands-special-commands-to-sqlite3">2.1.2 dot-commands (special commands to sqlite3)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#todo">2.1.3 todo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#sql-syntax-link-only">2.2 SQL Syntax (link only)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#sql-keywords-link-only">2.3 SQL Keywords (link only)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#datatypes-in-sqlite-version3-todo">2.4 Datatypes in SQLite Version3 (todo)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#core-functions-todo">2.5 Core functions (todo)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#agg-functions">2.6 Agg functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#data-and-time-functions">2.7 Data and time functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#timestring">2.7.1 timestring</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#modifiers">2.7.2 modifiers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sqlite_doc.html#examples">2.7.3 Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sqlite_doc.html#json-just-read">2.8 JSON (just read)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sql_wiki.html">3 Random jumbles from wikipedia pertaining to Database concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#data-integrity">3.1 Data Integrity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#ddl-dml-dcl">3.2 DDL, DML, DCL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#data-definition-language-ddl">3.2.1 Data definition language (DDL)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#data-manipulation-language-dml">3.2.2 Data Manipulation Language (DML)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#data-control-language-dcl">3.2.3 Data Control Language (DCL)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#acid">3.3 ACID</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#atomicity">3.3.1 Atomicity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#consistency">3.3.2 Consistency</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#isolation">3.3.3 Isolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#durability">3.3.4 Durability</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#jumpled-articles">3.4 Jumpled articles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#consistency-model">3.4.1 Consistency model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#cap-theorem-aka-brewer-s-theorem">3.4.2 CAP Theorem (aka Brewer&#8217;s Theorem)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#database-transaction">3.4.3 Database transaction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#database-normalization">3.5 Database normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#database-schema">3.6 Database Schema</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#logical-schema">3.6.1 Logical schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#physical-schema">3.6.2 Physical schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#conceptual-schema">3.6.3 Conceptual schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sql_wiki.html#three-schema-approach">3.6.4 Three-schema approach</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sql_wiki.html#bunch-of-jumbled-links">3.7 Bunch of jumbled links</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cs-computer.html">Random computer science notes (<code class="docutils literal"><span class="pre">cs-computer</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cs-computer.unix.html">Unix-related</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cs-computer.unix.html#terminal-shell-tty-console-the-difference">terminal, shell, tty, console...the difference?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cs-computer.network.html">Network notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cs-computer.network.html#http-messages">HTTP messages</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Contents (current page) <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">cs105_lab2_apache_log</a><ul>
<li><a class="reference internal" href="#part1-overview-web-server-log-analysis-with-apache-spark">Part1: Overview: Web Server Log Analysis with Apache Spark</a><ul>
<li><a class="reference internal" href="#modules-used-in-this-assignment">Modules used in this assignment</a></li>
<li><a class="reference internal" href="#dataset-used">Dataset used</a></li>
</ul>
</li>
<li><a class="reference internal" href="#part2-exploratory-data-analysis">Part2: Exploratory Data Analysis</a><ul>
<li><a class="reference internal" href="#a-loading-the-log-file">2a) loading the log file</a></li>
<li><a class="reference internal" href="#b-parsing-the-log-file">2b) Parsing the log file</a></li>
<li><a class="reference internal" href="#c-data-cleaning">2c) Data Cleaning</a></li>
<li><a class="reference internal" href="#fix-the-rows-with-null-content-size">Fix the rows with null content_size</a></li>
<li><a class="reference internal" href="#parsing-the-timestamp">Parsing the timestamp</a></li>
</ul>
</li>
<li><a class="reference internal" href="#part3-analysis-walk-through-on-the-web-server-log-file">Part3: Analysis Walk-Through on the Web Server Log File</a><ul>
<li><a class="reference internal" href="#a-example-content-size-statistics">3a) Example: Content Size Statistics</a></li>
<li><a class="reference internal" href="#b-example-http-status-analysis">3b) Example: HTTP Status Analysis</a></li>
<li><a class="reference internal" href="#c-example-status-graphing">3c) Example: Status Graphing</a></li>
<li><a class="reference internal" href="#d-example-frequent-hosts">3d) Example: Frequent Hosts</a></li>
<li><a class="reference internal" href="#e-example-visualizing-paths">3e) Example: Visualizing Paths</a></li>
<li><a class="reference internal" href="#f-example-top-paths">3f) Example: Top Paths</a></li>
</ul>
</li>
<li><a class="reference internal" href="#part-4-analyzing-web-server-log-file">Part 4: Analyzing Web Server Log File</a><ul>
<li><a class="reference internal" href="#a-exercise-top-ten-error-paths-hw">4a) Exercise: Top Ten Error Paths (HW)</a></li>
<li><a class="reference internal" href="#b-exercise-number-of-unique-hosts-hw">4b) Exercise: Number of Unique Hosts (HW)</a></li>
<li><a class="reference internal" href="#c-exercise-number-of-unique-daily-hosts">4c) Exercise: Number of Unique Daily Hosts</a></li>
<li><a class="reference internal" href="#d-exercise-visualizing-the-number-of-unique-daily-hosts">4d) Exercise: Visualizing the Number of Unique Daily Hosts</a></li>
<li><a class="reference internal" href="#e-exercise-average-number-of-daily-requests-per-host">4e) Exercise: Average Number of Daily Requests per Host</a></li>
<li><a class="reference internal" href="#f-exercise-visualizing-the-average-daily-requests-per-unique-host">4f) Exercise: Visualizing the Average Daily Requests per Unique Host</a></li>
</ul>
</li>
<li><a class="reference internal" href="#part5-exploring-404-status-codes">Part5: Exploring 404 Status Codes</a><ul>
<li><a class="reference internal" href="#a-exercise-counting-404-response-codes">5a) Exercise: Counting 404 Response Codes</a></li>
<li><a class="reference internal" href="#b-exercise-listing-404-status-code-records">5b) Exercise: Listing 404 Status Code Records</a></li>
<li><a class="reference internal" href="#c-exercise-listing-the-top-twenty-404-response-code-paths">5c) Exercise: Listing the Top Twenty 404 Response Code paths</a></li>
<li><a class="reference internal" href="#d-exercise-listing-the-top-twenty-five-404-response-code-hosts">5d) Exercise: Listing the Top Twenty-five 404 Response Code Hosts</a></li>
<li><a class="reference internal" href="#e-exercise-listing-404-errors-per-day">5e) Exercise: Listing 404 Errors per Day</a></li>
<li><a class="reference internal" href="#f-exercise-visualizing-the-404-errors-by-day">5f) Exercise: Visualizing the 404 Errors by Day</a></li>
<li><a class="reference internal" href="#h-exercise-hourly-404-errors">5h) Exercise: Hourly 404 Errors</a></li>
<li><a class="reference internal" href="#g-exercise-top-five-days-for-404-errors">5g) Exercise: Top Five Days for 404 Errors</a></li>
<li><a class="reference internal" href="#i-exercise-hourly-404-errors">5i) Exercise: Hourly 404 Errors</a></li>
<li><a class="reference internal" href="#j-exercise-visualizing-the-404-response-codes-by-hour">5j) Exercise: Visualizing the 404 Response Codes by Hour</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
      </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="span12 content">
      
  <style>
.emph {color:red; font-weight: bold}
</style><div class="section" id="cs105-lab2-apache-log">
<span id="cs105-lab2"></span><h1>cs105_lab2_apache_log</h1>
<p><a class="reference external" href="https://github.com/spark-mooc/mooc-setup/blob/master/cs105_lab2_apache_log.py">https://github.com/spark-mooc/mooc-setup/blob/master/cs105_lab2_apache_log.py</a></p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">This is an actual homework program submitted to EdX. To adhere to the honor code,
the <code class="docutils literal"><span class="pre">&lt;FILL</span> <span class="pre">IN&gt;</span></code> is kept in my personal private <a class="reference external" href="https://github.com/wtak23/private_repos/blob/master/cs105_lab2_solutions.rst">github repos</a>.</p>
</div>
<div class="contents local topic" id="contents">
<p class="topic-title first"><cite>Contents</cite></p>
<ul class="simple">
<li><a class="reference internal" href="#part1-overview-web-server-log-analysis-with-apache-spark" id="id1">Part1: Overview: Web Server Log Analysis with Apache Spark</a><ul>
<li><a class="reference internal" href="#modules-used-in-this-assignment" id="id2">Modules used in this assignment</a></li>
<li><a class="reference internal" href="#dataset-used" id="id3">Dataset used</a></li>
</ul>
</li>
<li><a class="reference internal" href="#part2-exploratory-data-analysis" id="id4">Part2: Exploratory Data Analysis</a><ul>
<li><a class="reference internal" href="#a-loading-the-log-file" id="id5">2a) loading the log file</a></li>
<li><a class="reference internal" href="#b-parsing-the-log-file" id="id6">2b) Parsing the log file</a></li>
<li><a class="reference internal" href="#c-data-cleaning" id="id7">2c) Data Cleaning</a></li>
<li><a class="reference internal" href="#fix-the-rows-with-null-content-size" id="id8">Fix the rows with null content_size</a></li>
<li><a class="reference internal" href="#parsing-the-timestamp" id="id9">Parsing the timestamp</a></li>
</ul>
</li>
<li><a class="reference internal" href="#part3-analysis-walk-through-on-the-web-server-log-file" id="id10">Part3: Analysis Walk-Through on the Web Server Log File</a><ul>
<li><a class="reference internal" href="#a-example-content-size-statistics" id="id11">3a) Example: Content Size Statistics</a></li>
<li><a class="reference internal" href="#b-example-http-status-analysis" id="id12">3b) Example: HTTP Status Analysis</a></li>
<li><a class="reference internal" href="#c-example-status-graphing" id="id13">3c) Example: Status Graphing</a></li>
<li><a class="reference internal" href="#d-example-frequent-hosts" id="id14">3d) Example: Frequent Hosts</a></li>
<li><a class="reference internal" href="#e-example-visualizing-paths" id="id15">3e) Example: Visualizing Paths</a></li>
<li><a class="reference internal" href="#f-example-top-paths" id="id16">3f) Example: Top Paths</a></li>
</ul>
</li>
<li><a class="reference internal" href="#part-4-analyzing-web-server-log-file" id="id17">Part 4: Analyzing Web Server Log File</a><ul>
<li><a class="reference internal" href="#a-exercise-top-ten-error-paths-hw" id="id18">4a) Exercise: Top Ten Error Paths (HW)</a></li>
<li><a class="reference internal" href="#b-exercise-number-of-unique-hosts-hw" id="id19">4b) Exercise: Number of Unique Hosts (HW)</a></li>
<li><a class="reference internal" href="#c-exercise-number-of-unique-daily-hosts" id="id20">4c) Exercise: Number of Unique Daily Hosts</a></li>
<li><a class="reference internal" href="#d-exercise-visualizing-the-number-of-unique-daily-hosts" id="id21">4d) Exercise: Visualizing the Number of Unique Daily Hosts</a></li>
<li><a class="reference internal" href="#e-exercise-average-number-of-daily-requests-per-host" id="id22">4e) Exercise: Average Number of Daily Requests per Host</a></li>
<li><a class="reference internal" href="#f-exercise-visualizing-the-average-daily-requests-per-unique-host" id="id23">4f) Exercise: Visualizing the Average Daily Requests per Unique Host</a></li>
</ul>
</li>
<li><a class="reference internal" href="#part5-exploring-404-status-codes" id="id24">Part5: Exploring 404 Status Codes</a><ul>
<li><a class="reference internal" href="#a-exercise-counting-404-response-codes" id="id25">5a) Exercise: Counting 404 Response Codes</a></li>
<li><a class="reference internal" href="#b-exercise-listing-404-status-code-records" id="id26">5b) Exercise: Listing 404 Status Code Records</a></li>
<li><a class="reference internal" href="#c-exercise-listing-the-top-twenty-404-response-code-paths" id="id27">5c) Exercise: Listing the Top Twenty 404 Response Code paths</a></li>
<li><a class="reference internal" href="#d-exercise-listing-the-top-twenty-five-404-response-code-hosts" id="id28">5d) Exercise: Listing the Top Twenty-five 404 Response Code Hosts</a></li>
<li><a class="reference internal" href="#e-exercise-listing-404-errors-per-day" id="id29">5e) Exercise: Listing 404 Errors per Day</a></li>
<li><a class="reference internal" href="#f-exercise-visualizing-the-404-errors-by-day" id="id30">5f) Exercise: Visualizing the 404 Errors by Day</a></li>
<li><a class="reference internal" href="#h-exercise-hourly-404-errors" id="id31">5h) Exercise: Hourly 404 Errors</a></li>
<li><a class="reference internal" href="#g-exercise-top-five-days-for-404-errors" id="id32">5g) Exercise: Top Five Days for 404 Errors</a></li>
<li><a class="reference internal" href="#i-exercise-hourly-404-errors" id="id33">5i) Exercise: Hourly 404 Errors</a></li>
<li><a class="reference internal" href="#j-exercise-visualizing-the-404-response-codes-by-hour" id="id34">5j) Exercise: Visualizing the 404 Response Codes by Hour</a></li>
</ul>
</li>
</ul>
</div>
<p class="rubric">During this lab we will cover:</p>
<ol class="arabic simple">
<li>Introduction and Imports</li>
<li>Exploratory Data Analysis</li>
<li>Analysis Walk-Through on the Web Server Log File</li>
<li>Analyzing Web Server Log File</li>
<li>Exploring 404 Response Codes</li>
</ol>
<div class="section" id="part1-overview-web-server-log-analysis-with-apache-spark">
<h2><a class="toc-backref" href="#id1">Part1: Overview: Web Server Log Analysis with Apache Spark</a></h2>
<p>Perform <strong>web server log analysis</strong> with Apache Spark.</p>
<ul class="simple">
<li><strong>Server log analysis</strong> is an ideal use case for Spark.</li>
<li>It&#8217;s a very large, common data source and contains a rich set of information.</li>
<li>Spark allows you to store your logs in files on disk cheaply, while still providing a quick and simple way to perform data analysis on them.</li>
<li><span class="emph">This homework</span> will show you how to use Apache Spark on <strong>real-world text-based production logs</strong> and fully harness the power of that data.</li>
<li><strong>Log data</strong> comes from many sources:<ul>
<li>web, file, and compute servers, application logs, user-generated content,</li>
</ul>
</li>
<li><strong>Log data</strong> can be used to:<ul>
<li>monitor servers</li>
<li>improving business and customer intelligence</li>
<li>building <strong>recommendation systems</strong>,</li>
<li>fraud detection, and much more.</li>
</ul>
</li>
</ul>
<div class="section" id="modules-used-in-this-assignment">
<h3><a class="toc-backref" href="#id2">Modules used in this assignment</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">functions</span> <span class="k">as</span> <span class="n">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">databricks_test_helper</span> <span class="kn">import</span> <span class="n">Test</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;This was last run on: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
<span class="go">This was last run on: 2016-09-10 03:53:11.187741</span>
</pre></div>
</div>
</div>
<div class="section" id="dataset-used">
<h3><a class="toc-backref" href="#id3">Dataset used</a></h3>
<p>Data set from <strong>NASA Kennedy Space Center web server</strong> in Florida.</p>
<ul class="simple">
<li>The full data set is freely available at <a class="reference external" href="http://ita.ee.lbl.gov/html/contrib/NASA-HTTP.html">http://ita.ee.lbl.gov/html/contrib/NASA-HTTP.html</a>, and it contains all <strong>HTTP requests for two months</strong>.</li>
<li><em>We are using a subset</em> that only contains several days&#8217; worth of requests.</li>
</ul>
</div>
</div>
<div class="section" id="part2-exploratory-data-analysis">
<h2><a class="toc-backref" href="#id4">Part2: Exploratory Data Analysis</a></h2>
<div class="section" id="a-loading-the-log-file">
<h3><a class="toc-backref" href="#id5">2a) loading the log file</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.SparkSession.html">sql.SparkSession</a></p>
</div>
<p>replaced <a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.SQLContext.html">sql.SQLContext</a> as of Spark 2.0</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Interestingly, <code class="docutils literal"><span class="pre">sqlContext.read</span></code> is an attribute representing a <code class="docutils literal"><span class="pre">sql.DataFrameReader</span></code> object</p>
<p>I kept thinking it was a method until I looked up the doc.</p>
<ul class="last simple">
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.SparkSession.read.html">https://wtak23.github.io/pyspark/generated/generated/sql.SparkSession.read.html</a></li>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.DataFrameReader.html">https://wtak23.github.io/pyspark/generated/generated/sql.DataFrameReader.html</a></li>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.DataFrameReader.text.html">https://wtak23.github.io/pyspark/generated/generated/sql.DataFrameReader.text.html</a></li>
</ul>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">log_file_path</span> <span class="o">=</span> <span class="s1">&#39;dbfs:/&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;databricks-datasets&#39;</span><span class="p">,</span> <span class="s1">&#39;cs100&#39;</span><span class="p">,</span> <span class="s1">&#39;lab2&#39;</span><span class="p">,</span> <span class="s1">&#39;data-001&#39;</span><span class="p">,</span> <span class="s1">&#39;apache.access.log.PROJECT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">log_file_path</span>
<span class="go">dbfs:/databricks-datasets/cs100/lab2/data-001/apache.access.log.PROJECT</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">base_df</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">log_file_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span> <span class="c1"># default from ``read.text`` gives colname *value* (see doc above)</span>
<span class="go">root</span>
<span class="go"> |-- value: string (nullable = true)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">base_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="c1"># number of rows</span>
<span class="go">1043177</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">(1) Spark Jobs</span>
<span class="go">+--------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|value                                                                                                                     |</span>
<span class="go">+--------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|in24.inetnebr.com - - [01/Aug/1995:00:00:01 -0400] &quot;GET /shuttle/missions/sts-68/news/sts-68-mcc-05.txt HTTP/1.0&quot; 200 1839|</span>
<span class="go">|uplherc.upl.com - - [01/Aug/1995:00:00:07 -0400] &quot;GET / HTTP/1.0&quot; 304 0                                                   |</span>
<span class="go">|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] &quot;GET /images/ksclogo-medium.gif HTTP/1.0&quot; 304 0                          |</span>
<span class="go">|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] &quot;GET /images/MOSAIC-logosmall.gif HTTP/1.0&quot; 304 0                        |</span>
<span class="go">|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] &quot;GET /images/USA-logosmall.gif HTTP/1.0&quot; 304 0                           |</span>
<span class="go">|ix-esc-ca2-07.ix.netcom.com - - [01/Aug/1995:00:00:09 -0400] &quot;GET /images/launch-logo.gif HTTP/1.0&quot; 200 1713              |</span>
<span class="go">|uplherc.upl.com - - [01/Aug/1995:00:00:10 -0400] &quot;GET /images/WORLD-logosmall.gif HTTP/1.0&quot; 304 0                         |</span>
<span class="go">+--------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="b-parsing-the-log-file">
<h3><a class="toc-backref" href="#id6">2b) Parsing the log file</a></h3>
<p>If you&#8217;re familiar with web servers, you&#8217;ll recognize this is in <span class="emph">Common Log Format</span> (<a class="reference external" href="https://www.w3.org/Daemon/User/Config/Logging.html#common-logfile-format">link</a>),
whose fields are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">field</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>remotehost</td>
<td>Remote hostname (or IP number if DNS hostname is not available).</td>
</tr>
<tr class="row-odd"><td>rfc931</td>
<td>The remote logname of the user. We don&#8217;t really care about this field.</td>
</tr>
<tr class="row-even"><td>authuser</td>
<td>The username of the remote user, as authenticated by the HTTP server.</td>
</tr>
<tr class="row-odd"><td>[date]</td>
<td>The date and time of the request.</td>
</tr>
<tr class="row-even"><td>&#8220;request&#8221;</td>
<td>The request, exactly as it came from the browser or client.</td>
</tr>
<tr class="row-odd"><td>status</td>
<td>The HTTP status code the server sent back to the client.</td>
</tr>
<tr class="row-even"><td>bytes</td>
<td>The number of bytes (Content-Length) transferred to the client.</td>
</tr>
</tbody>
</table>
<p>Let&#8217;s  <strong>parse</strong> this into individual columns.</p>
<ul class="simple">
<li>use <code class="docutils literal"><span class="pre">regexp_extract()</span></code> function to do the parsing.<ul>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.functions.regexp_extract.html">https://wtak23.github.io/pyspark/generated/generated/sql.functions.regexp_extract.html</a></li>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.functions.regexp_replace.html">https://wtak23.github.io/pyspark/generated/generated/sql.functions.regexp_replace.html</a></li>
</ul>
</li>
<li>This function matches a column against a regexp with one or more capture groups and allows you to <strong>extract one of the matched groups</strong>.</li>
<li>We&#8217;ll use one regular expression for each field we wish to extract.</li>
</ul>
<p>Some helpers</p>
<ul class="simple">
<li>My favorite quick-lookup for regex: <a class="reference external" href="http://www.rexegg.com/regex-quickstart.html">http://www.rexegg.com/regex-quickstart.html</a></li>
<li>HTTP methods: <a class="reference external" href="http://www.w3schools.com/tags/ref_httpmethods.asp">http://www.w3schools.com/tags/ref_httpmethods.asp</a></li>
<li>HTTP message/status: <a class="reference external" href="http://www.w3schools.com/tags/ref_httpmessages.asp">http://www.w3schools.com/tags/ref_httpmessages.asp</a></li>
</ul>
<p><code class="docutils literal"><span class="pre">regexp_extract(str,</span> <span class="pre">pattern,</span> <span class="pre">idx)</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">base_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">+--------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|value                                                                                                                     |</span>
<span class="go">+--------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|in24.inetnebr.com - - [01/Aug/1995:00:00:01 -0400] &quot;GET /shuttle/missions/sts-68/news/sts-68-mcc-05.txt HTTP/1.0&quot; 200 1839|</span>
<span class="go">+--------------------------------------------------------------------------------------------------------------------------+</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">split_df</span> <span class="o">=</span> <span class="n">base_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1"># \s = whitespace char, \d = digit char [0-9], \w = word char</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1"># &#39;host&#39; field: ([^\s]+\s) means take group who DOESN&#39;T begin with whitespace char, and regex stop when it encounters \s</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">F</span><span class="o">.</span><span class="n">regexp_extract</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">r&#39;^([^\s]+\s)&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1"># &#39;timestamp&#39; field: capture group whose enclosed by bar bracket [] - parenthesis doesn&#39;t cover the bar-brack cuz you just want the timestamp.</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1">#                    it goes like: &quot;2-dig/3-alpha/4-dig/2dig:2dig:2dig: -3dig&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">F</span><span class="o">.</span><span class="n">regexp_extract</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">r&#39;^.*\[(\d{2}/\w{3}/\d{4}:\d{2}:\d{2}:\d{2} -\d{4})]&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1"># &#39;path&#39; field: ^.*&quot; = take any char until you hit the double-quote char.  \w+\s = http request method.</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1">#               Finally, ([^\s]+)\s+HTTP = keep extracing all non-whitespace char until you bump into \s followed up HTTP</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">F</span><span class="o">.</span><span class="n">regexp_extract</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">r&#39;^.*&quot;\w+\s+([^\s]+)\s+HTTP.*&quot;&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1"># &#39;status&#39; field: http://www.w3schools.com/tags/ref_httpmessages.asp</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">F</span><span class="o">.</span><span class="n">regexp_extract</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">r&#39;^.*&quot;\s+([^\s]+)&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="c1"># &#39;content_size&#39; field: the ending series of digits</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">F</span><span class="o">.</span><span class="n">regexp_extract</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">r&#39;^.*\s+(\d+)$&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;content_size&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">split_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">+------------------+--------------------------+-----------------------------------------------+------+------------+</span>
<span class="go">|host              |timestamp                 |path                                           |status|content_size|</span>
<span class="go">+------------------+--------------------------+-----------------------------------------------+------+------------+</span>
<span class="go">|in24.inetnebr.com |01/Aug/1995:00:00:01 -0400|/shuttle/missions/sts-68/news/sts-68-mcc-05.txt|200   |1839        |</span>
<span class="go">|uplherc.upl.com   |01/Aug/1995:00:00:07 -0400|/                                              |304   |0           |</span>
<span class="go">|uplherc.upl.com   |01/Aug/1995:00:00:08 -0400|/images/ksclogo-medium.gif                     |304   |0           |</span>
<span class="go">|uplherc.upl.com   |01/Aug/1995:00:00:08 -0400|/images/MOSAIC-logosmall.gif                   |304   |0           |</span>
<span class="go">|uplherc.upl.com   |01/Aug/1995:00:00:08 -0400|/images/USA-logosmall.gif                      |304   |0           |</span>
<span class="go">+------------------+--------------------------+-----------------------------------------------+------+------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="c-data-cleaning">
<h3><a class="toc-backref" href="#id7">2c) Data Cleaning</a></h3>
<p>Issue: the above parsing generated some <code class="docutils literal"><span class="pre">null</span></code> rows.</p>
<p>Originally, we had no null columns</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">base_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">base_df</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isNull</span><span class="p">())</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">Out[12]: 0</span>
</pre></div>
</div>
<p>But craaaaaap, the above parsing unintentionally created some null row/col values....</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bad_rows_df</span> <span class="o">=</span> <span class="n">split_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">split_df</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">|</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">split_df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">|</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">split_df</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">|</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">split_df</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">|</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="n">split_df</span><span class="p">[</span><span class="s1">&#39;content_size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isNull</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bad_rows_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">Out[13]: 8756</span>
</pre></div>
</div>
<p>So something went wrong. Which columns are affected?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bad_rows_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">(1) Spark Jobs</span>
<span class="go">+--------------------+--------------------+--------------------+------+------------+</span>
<span class="go">|                host|           timestamp|                path|status|content_size|</span>
<span class="go">+--------------------+--------------------+--------------------+------+------------+</span>
<span class="go">|        gw1.att.com |01/Aug/1995:00:03...|/shuttle/missions...|   302|        null|</span>
<span class="go">|js002.cc.utsunomi...|01/Aug/1995:00:07...|/shuttle/resource...|   404|        null|</span>
<span class="go">|    tia1.eskimo.com |01/Aug/1995:00:28...|/pub/winvn/releas...|   404|        null|</span>
<span class="go">|itws.info.eng.nii...|01/Aug/1995:00:38...|/ksc.html/facts/a...|   403|        null|</span>
<span class="go">|grimnet23.idirect...|01/Aug/1995:00:50...|/www/software/win...|   404|        null|</span>
<span class="go">|miriworld.its.uni...|01/Aug/1995:01:04...|/history/history.htm|   404|        null|</span>
<span class="go">|      ras38.srv.net |01/Aug/1995:01:05...|/elv/DELTA/uncons...|   404|        null|</span>
<span class="go">| cs1-06.leh.ptd.net |01/Aug/1995:01:17...|                    |   404|        null|</span>
<span class="go">+--------------------+--------------------+--------------------+------+------------+</span>
<span class="go">only showing top 8 rows</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Approach based on this SO <a class="reference external" href="http://stackoverflow.com/questions/33900726/count-number-of-non-nan-entries-in-each-column-of-spark-dataframe-with-pyspark/33901312">http://stackoverflow.com/questions/33900726/count-number-of-non-nan-entries-in-each-column-of-spark-dataframe-with-pyspark/33901312</a></p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">count_null</span><span class="p">(</span><span class="n">col_name</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span><span class="o">.</span><span class="n">isNull</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build up a list of column expressions, one per column.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exprs</span> <span class="o">=</span> <span class="p">[</span><span class="n">count_null</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span> <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">split_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">_i</span><span class="p">,</span><span class="n">_expr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">exprs</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="k">print</span> <span class="n">_i</span><span class="p">,</span><span class="n">_expr</span>
<span class="go">0 Column&lt;(sum(cast(isnull(host) as int)),mode=Complete,isDistinct=false) AS host#821&gt;</span>
<span class="go">1 Column&lt;(sum(cast(isnull(timestamp) as int)),mode=Complete,isDistinct=false) AS timestamp#822&gt;</span>
<span class="go">2 Column&lt;(sum(cast(isnull(path) as int)),mode=Complete,isDistinct=false) AS path#823&gt;</span>
<span class="go">3 Column&lt;(sum(cast(isnull(status) as int)),mode=Complete,isDistinct=false) AS status#824&gt;</span>
<span class="go">4 Column&lt;(sum(cast(isnull(content_size) as int)),mode=Complete,isDistinct=false) AS content_size#825&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run the aggregation. The *exprs converts the list of expressions into variable function arguments.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">split_df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+----+---------+----+------+------------+</span>
<span class="go">|host|timestamp|path|status|content_size|</span>
<span class="go">+----+---------+----+------+------------+</span>
<span class="go">|   0|        0|   0|     0|        8756|</span>
<span class="go">+----+---------+----+------+------------+</span>
</pre></div>
</div>
<ul class="simple">
<li>So all the <code class="docutils literal"><span class="pre">null</span></code> occurs in the <code class="docutils literal"><span class="pre">content_size</span></code> column.</li>
<li>Here&#8217;s the original parsing regexp used:</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">regexp_extract</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">r&#39;^.*\s+(\d+)$&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;content_size&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">\d+</span></code> selects one or more digits at the end of the input line.</li>
<li>Let&#8217;s see if there are any lines that do not end with one or more digits.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bad_content_size_df</span> <span class="o">=</span> <span class="n">base_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">~</span> <span class="n">base_df</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rlike</span><span class="p">(</span><span class="s1">r&#39;\d+$&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bad_content_size_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">Out[34]: 8756</span>
</pre></div>
</div>
<ul class="simple">
<li>Ah, there&#8217;s the error. <span class="emph">the count mathces the number of rows</span> in <code class="docutils literal"><span class="pre">bad_rows_df</span></code></li>
<li>Let&#8217;s take a look at some of the bad column values.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bad_content_size_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">F</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">bad_content_size_df</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">+----------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|concat(value,*)                                                                                                             |</span>
<span class="go">+----------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|gw1.att.com - - [01/Aug/1995:00:03:53 -0400] &quot;GET /shuttle/missions/sts-73/news HTTP/1.0&quot; 302 -*                            |</span>
<span class="go">|js002.cc.utsunomiya-u.ac.jp - - [01/Aug/1995:00:07:33 -0400] &quot;GET /shuttle/resources/orbiters/discovery.gif HTTP/1.0&quot; 404 -*|</span>
<span class="go">|tia1.eskimo.com - - [01/Aug/1995:00:28:41 -0400] &quot;GET /pub/winvn/release.txt HTTP/1.0&quot; 404 -*                               |</span>
<span class="go">|itws.info.eng.niigata-u.ac.jp - - [01/Aug/1995:00:38:01 -0400] &quot;GET /ksc.html/facts/about_ksc.html HTTP/1.0&quot; 403 -*         |</span>
<span class="go">|grimnet23.idirect.com - - [01/Aug/1995:00:50:12 -0400] &quot;GET /www/software/winvn/winvn.html HTTP/1.0&quot; 404 -*                 |</span>
<span class="go">|miriworld.its.unimelb.edu.au - - [01/Aug/1995:01:04:54 -0400] &quot;GET /history/history.htm HTTP/1.0&quot; 404 -*                    |</span>
<span class="go">+----------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
<div class="admonition-reason-for-error admonition">
<p class="first admonition-title">Reason for error</p>
<ul class="last simple">
<li>The bad rows correspond to <strong>error results</strong>,<ul>
<li>here no content was sent back and the server emitted a <code class="docutils literal"><span class="pre">&quot;-&quot;</span></code> for the <code class="docutils literal"><span class="pre">content_size</span></code> field.</li>
<li>we don&#8217;t want to discard those rows from our analysis, so let&#8217;s map them to 0.</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="fix-the-rows-with-null-content-size">
<h3><a class="toc-backref" href="#id8">Fix the rows with null content_size</a></h3>
<ul class="simple">
<li>Two ways to replace null values in a DF.<ul>
<li><code class="docutils literal"><span class="pre">fillna()</span></code>, which fills null values with specified non-null values.</li>
<li><code class="docutils literal"><span class="pre">na</span></code>, which returns a <code class="docutils literal"><span class="pre">DataFrameNaFunctions</span></code> object with many functions for operating on null columns.</li>
</ul>
</li>
<li>We&#8217;ll use <code class="docutils literal"><span class="pre">fillna()</span></code>, because it&#8217;s simple.</li>
<li>There are several ways to invoke this function.<ul>
<li>the easiest way: replace all null columns with known values.</li>
<li>better way (for safety): pass a dictionary containing <code class="docutils literal"><span class="pre">(column_name,</span> <span class="pre">value)</span></code> mappings. That&#8217;s what we&#8217;ll do.</li>
</ul>
</li>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.DataFrame.fillna.html">https://wtak23.github.io/pyspark/generated/generated/sql.DataFrame.fillna.html</a></li>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.DataFrame.na.html">https://wtak23.github.io/pyspark/generated/generated/sql.DataFrame.na.html</a></li>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.DataFrameNaFunctions.html">https://wtak23.github.io/pyspark/generated/generated/sql.DataFrameNaFunctions.html</a></li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Replace all null content_size values with 0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cleaned_df</span> <span class="o">=</span> <span class="n">split_df</span><span class="o">.</span><span class="n">na</span><span class="o">.</span><span class="n">fill</span><span class="p">({</span><span class="s1">&#39;content_size&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Ensure that there are no nulls left (recall ``count_null`` is a function i defined above)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exprs</span> <span class="o">=</span> <span class="p">[</span><span class="n">count_null</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span> <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">cleaned_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">cleaned_df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+----+---------+----+------+------------+</span>
<span class="go">|host|timestamp|path|status|content_size|</span>
<span class="go">+----+---------+----+------+------------+</span>
<span class="go">|   0|        0|   0|     0|           0|</span>
<span class="go">+----+---------+----+------+------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="parsing-the-timestamp">
<h3><a class="toc-backref" href="#id9">Parsing the timestamp</a></h3>
<ul class="simple">
<li>we now have a clean, parsed DataFrame</li>
<li>next we have to <strong>parse the timestamp field</strong> into an actual <code class="docutils literal"><span class="pre">timestamp</span></code>.</li>
<li>The** Common Log Format time** is somewhat non-standard.<ul>
<li>A User-Defined Function (UDF) is the most straightforward way to parse it.</li>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.functions.udf.html">https://wtak23.github.io/pyspark/generated/generated/sql.functions.udf.html</a></li>
</ul>
</li>
</ul>
<div class="admonition-define-udf admonition">
<p class="first admonition-title">Define UDF</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="n">month_map</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;Jan&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span>
  <span class="s1">&#39;Aug&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span>  <span class="s1">&#39;Sep&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">:</span> <span class="mi">12</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">parse_clf_time</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Convert Common Log time format into a Python datetime object</span>
<span class="sd">    Args:</span>
<span class="sd">        s (str): date and time in Apache time format [dd/mmm/yyyy:hh:mm:ss (+/-)zzzz]</span>
<span class="sd">    Returns:</span>
<span class="sd">        a string suitable for passing to CAST(&#39;timestamp&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># NOTE: We&#39;re ignoring time zone here. In a production application, you&#39;d want to handle that.</span>
    <span class="k">return</span> <span class="s2">&quot;{0:04d}-{1:02d}-{2:02d} {3:02d}:{4:02d}:{5:02d}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">11</span><span class="p">]),</span>
      <span class="n">month_map</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]],</span>
      <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]),</span>
      <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">14</span><span class="p">]),</span>
      <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">15</span><span class="p">:</span><span class="mi">17</span><span class="p">]),</span>
      <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">18</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>
    <span class="p">)</span>

<span class="n">u_parse_time</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">udf</span><span class="p">(</span><span class="n">parse_clf_time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Alright, let&#8217;s use this UDF to append a column <cite>time</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">col_to_append</span> <span class="o">=</span> <span class="p">(</span><span class="n">u_parse_time</span><span class="p">(</span><span class="n">cleaned_df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span> <span class="c1"># convert column type. https://wtak23.github.io/pyspark/generated/generated/sql.Column.cast.html</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>     <span class="c1"># rename</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">col_to_append</span>
<span class="go">Column&lt;cast(PythonUDF#parse_clf_time(timestamp) as timestamp) AS time#1975&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># now append column to our parsed, cleaned dataframe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logs_df</span> <span class="o">=</span> <span class="n">cleaned_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">col_to_append</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logs_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">+------------------+--------------------------+-----------------------------------------------+------+------------+---------------------+</span>
<span class="go">|host              |timestamp                 |path                                           |status|content_size|time                 |</span>
<span class="go">+------------------+--------------------------+-----------------------------------------------+------+------------+---------------------+</span>
<span class="go">|in24.inetnebr.com |01/Aug/1995:00:00:01 -0400|/shuttle/missions/sts-68/news/sts-68-mcc-05.txt|200   |1839        |1995-08-01 00:00:01.0|</span>
<span class="go">|uplherc.upl.com   |01/Aug/1995:00:00:07 -0400|/                                              |304   |0           |1995-08-01 00:00:07.0|</span>
<span class="go">|uplherc.upl.com   |01/Aug/1995:00:00:08 -0400|/images/ksclogo-medium.gif                     |304   |0           |1995-08-01 00:00:08.0|</span>
<span class="go">|uplherc.upl.com   |01/Aug/1995:00:00:08 -0400|/images/MOSAIC-logosmall.gif                   |304   |0           |1995-08-01 00:00:08.0|</span>
<span class="go">|uplherc.upl.com   |01/Aug/1995:00:00:08 -0400|/images/USA-logosmall.gif                      |304   |0           |1995-08-01 00:00:08.0|</span>
<span class="go">+------------------+--------------------------+-----------------------------------------------+------+------------+---------------------+</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># drop the &#39;timestamp&#39; field we originally had</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logs_df</span> <span class="o">=</span> <span class="n">logs_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logs_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">+------------------+-----------------------------------------------+------+------------+---------------------+</span>
<span class="go">|host              |path                                           |status|content_size|time                 |</span>
<span class="go">+------------------+-----------------------------------------------+------+------------+---------------------+</span>
<span class="go">|in24.inetnebr.com |/shuttle/missions/sts-68/news/sts-68-mcc-05.txt|200   |1839        |1995-08-01 00:00:01.0|</span>
<span class="go">|uplherc.upl.com   |/                                              |304   |0           |1995-08-01 00:00:07.0|</span>
<span class="go">|uplherc.upl.com   |/images/ksclogo-medium.gif                     |304   |0           |1995-08-01 00:00:08.0|</span>
<span class="go">|uplherc.upl.com   |/images/MOSAIC-logosmall.gif                   |304   |0           |1995-08-01 00:00:08.0|</span>
<span class="go">|uplherc.upl.com   |/images/USA-logosmall.gif                      |304   |0           |1995-08-01 00:00:08.0|</span>
<span class="go">+------------------+-----------------------------------------------+------+------------+---------------------+</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">total_log_entries</span> <span class="o">=</span> <span class="n">logs_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">total_log_entries</span>
<span class="go">1043177</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">logs_df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
<span class="go">root</span>
<span class="go"> |-- host: string (nullable = true)</span>
<span class="go"> |-- path: string (nullable = true)</span>
<span class="go"> |-- status: integer (nullable = true)</span>
<span class="go"> |-- content_size: integer (nullable = false)</span>
<span class="go"> |-- time: timestamp (nullable = true)</span>
</pre></div>
</div>
<p>Alright. We&#8217;re in business.</p>
</div>
</div>
<div class="section" id="part3-analysis-walk-through-on-the-web-server-log-file">
<h2><a class="toc-backref" href="#id10">Part3: Analysis Walk-Through on the Web Server Log File</a></h2>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>Let&#8217;s cache <code class="docutils literal"><span class="pre">logs_df</span></code> from above. We&#8217;re gonna use it quite often.</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logs_df</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="go">Out[55]: DataFrame[host: string, path: string, status: int, content_size: int, time: timestamp]</span>
</pre></div>
</div>
</div>
<div class="section" id="a-example-content-size-statistics">
<h3><a class="toc-backref" href="#id11">3a) Example: Content Size Statistics</a></h3>
<ul class="simple">
<li>This is like pandas describe method.</li>
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Five-number_summary">https://en.wikipedia.org/wiki/Five-number_summary</a></li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate statistics based on the content size.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">content_size_summary_df</span> <span class="o">=</span> <span class="n">logs_df</span><span class="o">.</span><span class="n">describe</span><span class="p">([</span><span class="s1">&#39;content_size&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">content_size_summary_df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+-------+------------------+</span>
<span class="go">|summary|      content_size|</span>
<span class="go">+-------+------------------+</span>
<span class="go">|  count|           1043177|</span>
<span class="go">|   mean|17531.555702435926|</span>
<span class="go">| stddev| 68561.99906264187|</span>
<span class="go">|    min|                 0|</span>
<span class="go">|    max|           3421948|</span>
<span class="go">+-------+------------------+</span>
</pre></div>
</div>
<ul class="simple">
<li>For more flexibility, pass <code class="docutils literal"><span class="pre">sql.functions</span></code> functions to <code class="docutils literal"><span class="pre">agg()</span></code><ul>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/sql.functions.html">https://wtak23.github.io/pyspark/generated/sql.functions.html</a></li>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.DataFrame.agg.html">https://wtak23.github.io/pyspark/generated/generated/sql.DataFrame.agg.html</a></li>
</ul>
</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">content_size_stats</span> <span class="o">=</span>  <span class="p">(</span><span class="n">logs_df</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">logs_df</span><span class="p">[</span><span class="s1">&#39;content_size&#39;</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">F</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="n">logs_df</span><span class="p">[</span><span class="s1">&#39;content_size&#39;</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">F</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">logs_df</span><span class="p">[</span><span class="s1">&#39;content_size&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="o">.</span><span class="n">first</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Content Size Avg: {1:,.2f}; Min: {0:.2f}; Max: {2:,.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">content_size_stats</span><span class="p">)</span>
<span class="go">Content Size Avg: 17,531.56; Min: 0.00; Max: 3,421,948</span>
</pre></div>
</div>
</div>
<div class="section" id="b-example-http-status-analysis">
<h3><a class="toc-backref" href="#id12">3b) Example: HTTP Status Analysis</a></h3>
<p>Refresher on the DF structure</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logs_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">+------------------+-----------------------------------------------+------+------------+---------------------+</span>
<span class="go">|host              |path                                           |status|content_size|time                 |</span>
<span class="go">+------------------+-----------------------------------------------+------+------------+---------------------+</span>
<span class="go">|in24.inetnebr.com |/shuttle/missions/sts-68/news/sts-68-mcc-05.txt|200   |1839        |1995-08-01 00:00:01.0|</span>
<span class="go">|uplherc.upl.com   |/                                              |304   |0           |1995-08-01 00:00:07.0|</span>
<span class="go">|uplherc.upl.com   |/images/ksclogo-medium.gif                     |304   |0           |1995-08-01 00:00:08.0|</span>
<span class="go">+------------------+-----------------------------------------------+------+------------+---------------------+</span>
</pre></div>
</div>
<p>Alright, let&#8217;s use <code class="docutils literal"><span class="pre">groupBy</span></code> to get insight in the <code class="docutils literal"><span class="pre">status</span></code> field</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">status_to_count_df</span> <span class="o">=</span><span class="p">(</span><span class="n">logs_df</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span> <span class="c1"># sort by the &#39;status&#39; field</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="o">.</span><span class="n">cache</span><span class="p">())</span>       <span class="c1"># remember to cache if you&#39;re gonna use this DF a lot</span>
<span class="go">​&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">status_to_count_length</span> <span class="o">=</span> <span class="n">status_to_count_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Found </span><span class="si">%d</span><span class="s1"> response codes&#39;</span> <span class="o">%</span> <span class="n">status_to_count_length</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">status_to_count_df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">Found 7 response codes</span>
<span class="go">+------+------+</span>
<span class="go">|status| count|</span>
<span class="go">+------+------+</span>
<span class="go">|   200|940847|</span>
<span class="go">|   302| 16244|</span>
<span class="go">|   304| 79824|</span>
<span class="go">|   403|    58|</span>
<span class="go">|   404|  6185|</span>
<span class="go">|   500|     2|</span>
<span class="go">|   501|    17|</span>
<span class="go">+------+------+</span>
</pre></div>
</div>
</div>
<div class="section" id="c-example-status-graphing">
<span id="cs105-lab2-3c"></span><h3><a class="toc-backref" href="#id13">3c) Example: Status Graphing</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">display</span><span class="p">(</span><span class="n">status_to_count_df</span><span class="p">)</span>
</pre></div>
</div>
<img alt="http://spark-mooc.github.io/web-assets/images/cs105x/plot_options_1.png" class="align-center" src="http://spark-mooc.github.io/web-assets/images/cs105x/plot_options_1.png" />
<p>Let&#8217;s take the log since the <code class="docutils literal"><span class="pre">200</span></code> status dominates the count</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">log_status_to_count_df</span> <span class="o">=</span> <span class="n">status_to_count_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;log(count)&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">status_to_count_df</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">display</span><span class="p">(</span><span class="n">log_status_to_count_df</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/105_lab2_3c.png" class="align-center" src="../_images/105_lab2_3c.png" />
<div class="admonition-note-the-use-of-withcolumn-to-append-column admonition">
<p class="first admonition-title">note &#8212; the use of <code class="docutils literal"><span class="pre">withColumn</span></code> to append column</p>
<ul class="simple">
<li>recall the SO thread on how to append cols<ul>
<li><a class="reference external" href="http://stackoverflow.com/questions/33681487/how-do-i-add-a-new-column-to-spark-data-frame-pyspark">http://stackoverflow.com/questions/33681487/how-do-i-add-a-new-column-to-spark-data-frame-pyspark</a></li>
</ul>
</li>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.DataFrame.withColumn.html">https://wtak23.github.io/pyspark/generated/generated/sql.DataFrame.withColumn.html</a></li>
</ul>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">status_to_count_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">+------+------+</span>
<span class="go">|status|count |</span>
<span class="go">+------+------+</span>
<span class="go">|200   |940847|</span>
<span class="go">|302   |16244 |</span>
<span class="go">|304   |79824 |</span>
<span class="go">+------+------+</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_status_to_count_df</span> <span class="o">=</span> <span class="n">status_to_count_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;log(count)&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">status_to_count_df</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_status_to_count_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">+------+------+------------------+</span>
<span class="go">|status|count |log(count)        |</span>
<span class="go">+------+------+------------------+</span>
<span class="go">|200   |940847|13.75453581236166 |</span>
<span class="go">|302   |16244 |9.69547888880619  |</span>
<span class="go">|304   |79824 |11.287579490100818|</span>
<span class="go">+------+------+------------------+</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>k, that&#8217;s a bit better.</li>
<li>to make more adjustments, use <code class="docutils literal"><span class="pre">matplotlib</span></code></li>
<li>Here let&#8217;s use a set of helper functions from the <code class="docutils literal"><span class="pre">spark_notebook_helpers</span></code> library.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># np is just an alias for numpy.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># cm and plt are aliases for matplotlib.cm (for &quot;color map&quot;) and matplotlib.pyplot, respectively.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># prepareSubplot is a helper.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spark_notebook_helpers</span> <span class="kn">import</span> <span class="n">prepareSubplot</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">plt</span><span class="p">,</span> <span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">prepareSubplot</span><span class="p">)</span>
<span class="go">Help on function prepareSubplot in module spark_notebook_helpers:</span>

<span class="go">prepareSubplot(xticks, yticks, figsize=(10.5, 6), hideLabels=False, gridColor=&#39;#999999&#39;, gridWidth=1.0, subplots=(1, 1))</span>
<span class="go">    Template for generating the plot layout.</span>
</pre></div>
</div>
<p>Let&#8217; use the <code class="docutils literal"><span class="pre">Set1</span></code> colormap
<a class="reference external" href="http://matplotlib.org/examples/color/colormaps_reference.html">http://matplotlib.org/examples/color/colormaps_reference.html</a></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">log_status_to_count_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">colorMap</span> <span class="o">=</span> <span class="s1">&#39;Set1&#39;</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">colorMap</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">prepareSubplot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">bar_width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">bar_width</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/105_lab2_3c2.png" class="align-center" src="../_images/105_lab2_3c2.png" />
</div>
<div class="section" id="d-example-frequent-hosts">
<h3><a class="toc-backref" href="#id14">3d) Example: Frequent Hosts</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logs_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">+------------------+--------------------+------+------------+--------------------+</span>
<span class="go">|              host|                path|status|content_size|                time|</span>
<span class="go">+------------------+--------------------+------+------------+--------------------+</span>
<span class="go">|in24.inetnebr.com |/shuttle/missions...|   200|        1839|1995-08-01 00:00:...|</span>
<span class="go">|  uplherc.upl.com |                   /|   304|           0|1995-08-01 00:00:...|</span>
<span class="go">|  uplherc.upl.com |/images/ksclogo-m...|   304|           0|1995-08-01 00:00:...|</span>
<span class="go">+------------------+--------------------+------+------------+--------------------+</span>
</pre></div>
</div>
<p>Get any hosts that has accessed the server more than 10 times (use <code class="docutils literal"><span class="pre">groupBy</span></code>)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># get any hosts that has accessed the server more than 10 times.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">host_sum_df</span> <span class="o">=</span><span class="p">(</span><span class="n">logs_df</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">host_more_than_10_df</span> <span class="o">=</span> <span class="p">(</span><span class="n">host_sum_df</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">host_sum_df</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">host_sum_df</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Any 8 hosts that have accessed more then 10 times:</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">host_more_than_10_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Any 8 hosts that have accessed more then 10 times:</span>

<span class="go">+---------------------------+</span>
<span class="go">|host                       |</span>
<span class="go">+---------------------------+</span>
<span class="go">|gcl-s2.aero.kyushu-u.ac.jp |</span>
<span class="go">|dd09-015.compuserve.com    |</span>
<span class="go">|sun8.hrz.th-darmstadt.de   |</span>
<span class="go">|128.159.144.47             |</span>
<span class="go">|160.151.233.33             |</span>
<span class="go">|128.159.132.13             |</span>
<span class="go">|s025n217.ummed.edu         |</span>
<span class="go">|204.126.175.80             |</span>
<span class="go">+---------------------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="e-example-visualizing-paths">
<h3><a class="toc-backref" href="#id15">3e) Example: Visualizing Paths</a></h3>
<p>Now, let&#8217;s visualize the <strong>number of hits to paths (URIs)</strong> in the <strong>log</strong>.</p>
<ul class="simple">
<li>for this, we start with our <code class="docutils literal"><span class="pre">logs_df</span></code>, and:<ul>
<li>group by the path column</li>
<li>aggregate by count, and</li>
<li>sort in descending order.</li>
</ul>
</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">paths_df</span> <span class="o">=</span> <span class="p">(</span><span class="n">logs_df</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">paths_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">+--------------------+-----+</span>
<span class="go">|                path|count|</span>
<span class="go">+--------------------+-----+</span>
<span class="go">|/images/NASA-logo...|59666|</span>
<span class="go">|/images/KSC-logos...|50420|</span>
<span class="go">|/images/MOSAIC-lo...|43831|</span>
<span class="go">+--------------------+-----+</span>
</pre></div>
</div>
<ul class="simple">
<li>Next extract the paths and the counts, and unpack the resulting list of <code class="docutils literal"><span class="pre">Rows</span></code> using a map function and lambda expression.</li>
<li>Then we can plot it in mpl.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>select gives a collection of Row items....not exactly what we want</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">paths_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Out[176]:</span>
<span class="go">[Row(path=u&#39;/images/NASA-logosmall.gif&#39;, count=59666),</span>
<span class="go"> Row(path=u&#39;/images/KSC-logosmall.gif&#39;, count=50420),</span>
<span class="go"> Row(path=u&#39;/images/MOSAIC-logosmall.gif&#39;, count=43831),</span>
<span class="go"> Row(path=u&#39;/images/USA-logosmall.gif&#39;, count=43604),</span>
</pre></div>
</div>
<p>so apply lambda</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">paths_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Out[179]:</span>
<span class="go">[(u&#39;/images/NASA-logosmall.gif&#39;, 59666),</span>
<span class="go"> (u&#39;/images/KSC-logosmall.gif&#39;, 50420),</span>
<span class="go"> (u&#39;/images/MOSAIC-logosmall.gif&#39;, 43831),</span>
<span class="go"> (u&#39;/images/USA-logosmall.gif&#39;, 43604),</span>
<span class="go"> (u&#39;/images/WORLD-logosmall.gif&#39;, 43217)]</span>
</pre></div>
</div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">paths_counts</span> <span class="o">=</span> <span class="p">(</span><span class="n">paths_df</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">)</span> <span class="c1"># this gives a list of *Row* objects</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="c1"># unpack Rows with lambda function</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="o">.</span><span class="n">collect</span><span class="p">())</span> <span class="c1"># collect. now we have a nice python list that i am accustomted to :)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">paths</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">paths_counts</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colorMap</span> <span class="o">=</span> <span class="s1">&#39;Accent&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">colorMap</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># plot using the first 1000 rows of data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">prepareSubplot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">70000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Paths&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of Hits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">counts</span><span class="p">[:</span><span class="mi">1000</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#999999&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/105_lab2_3e.png" class="align-center" src="../_images/105_lab2_3e.png" />
</div>
<div class="section" id="f-example-top-paths">
<h3><a class="toc-backref" href="#id16">3f) Example: Top Paths</a></h3>
<ul class="simple">
<li>here we&#8217;ll find the <strong>top paths (URIs)</strong> in the log.</li>
<li>Because we sorted paths_df for plotting, all we need to do is call <code class="docutils literal"><span class="pre">.show()</span></code></li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Top Paths</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Top Ten Paths:&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">paths_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Top Ten Paths:</span>
<span class="go">+---------------------------------------+-----+</span>
<span class="go">|path                                   |count|</span>
<span class="go">+---------------------------------------+-----+</span>
<span class="go">|/images/NASA-logosmall.gif             |59666|</span>
<span class="go">|/images/KSC-logosmall.gif              |50420|</span>
<span class="go">|/images/MOSAIC-logosmall.gif           |43831|</span>
<span class="go">|/images/USA-logosmall.gif              |43604|</span>
<span class="go">|/images/WORLD-logosmall.gif            |43217|</span>
<span class="go">|/images/ksclogo-medium.gif             |41267|</span>
<span class="go">|/ksc.html                              |28536|</span>
<span class="go">|/history/apollo/images/apollo-logo1.gif|26766|</span>
<span class="go">|/images/launch-logo.gif                |24742|</span>
<span class="go">|/                                      |20173|</span>
<span class="go">+---------------------------------------+-----+</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="part-4-analyzing-web-server-log-file">
<span id="cs105-lab2-part4"></span><h2><a class="toc-backref" href="#id17">Part 4: Analyzing Web Server Log File</a></h2>
<p>We&#8217;ll be working with this DataFrame for a while.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logs_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">+------------------+--------------------+------+------------+--------------------+</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">|</span>              <span class="n">host</span><span class="o">|</span>                <span class="n">path</span><span class="o">|</span><span class="n">status</span><span class="o">|</span><span class="n">content_size</span><span class="o">|</span>                <span class="n">time</span><span class="o">|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">+------------------+--------------------+------+------------+--------------------+</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">|</span><span class="n">in24</span><span class="o">.</span><span class="n">inetnebr</span><span class="o">.</span><span class="n">com</span> <span class="o">|/</span><span class="n">shuttle</span><span class="o">/</span><span class="n">missions</span><span class="o">...|</span>   <span class="mi">200</span><span class="o">|</span>        <span class="mi">1839</span><span class="o">|</span><span class="mi">1995</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">01</span> <span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="o">...|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">|</span>  <span class="n">uplherc</span><span class="o">.</span><span class="n">upl</span><span class="o">.</span><span class="n">com</span> <span class="o">|</span>                   <span class="o">/|</span>   <span class="mi">304</span><span class="o">|</span>           <span class="mi">0</span><span class="o">|</span><span class="mi">1995</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">01</span> <span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="o">...|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">|</span>  <span class="n">uplherc</span><span class="o">.</span><span class="n">upl</span><span class="o">.</span><span class="n">com</span> <span class="o">|/</span><span class="n">images</span><span class="o">/</span><span class="n">ksclogo</span><span class="o">-</span><span class="n">m</span><span class="o">...|</span>   <span class="mi">304</span><span class="o">|</span>           <span class="mi">0</span><span class="o">|</span><span class="mi">1995</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">01</span> <span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="o">...|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">|</span>  <span class="n">uplherc</span><span class="o">.</span><span class="n">upl</span><span class="o">.</span><span class="n">com</span> <span class="o">|/</span><span class="n">images</span><span class="o">/</span><span class="n">MOSAIC</span><span class="o">-</span><span class="n">lo</span><span class="o">...|</span>   <span class="mi">304</span><span class="o">|</span>           <span class="mi">0</span><span class="o">|</span><span class="mi">1995</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">01</span> <span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="o">...|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">|</span>  <span class="n">uplherc</span><span class="o">.</span><span class="n">upl</span><span class="o">.</span><span class="n">com</span> <span class="o">|/</span><span class="n">images</span><span class="o">/</span><span class="n">USA</span><span class="o">-</span><span class="n">logos</span><span class="o">...|</span>   <span class="mi">304</span><span class="o">|</span>           <span class="mi">0</span><span class="o">|</span><span class="mi">1995</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">01</span> <span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="o">...|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">+------------------+--------------------+------+------------+--------------------+</span>
</pre></div>
</div>
<div class="section" id="a-exercise-top-ten-error-paths-hw">
<h3><a class="toc-backref" href="#id18">4a) Exercise: Top Ten Error Paths (HW)</a></h3>
<ul class="simple">
<li>What are the top ten paths which did not have return code 200?</li>
<li>Create a sorted list containing the paths and the number of times that they were accessed with a non-200 return code and show the top ten.</li>
<li><a class="reference external" href="http://www.w3schools.com/tags/ref_httpmessages.asp">http://www.w3schools.com/tags/ref_httpmessages.asp</a></li>
<li><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.functions.desc.html">https://wtak23.github.io/pyspark/generated/generated/sql.functions.desc.html</a></li>
</ul>
<p>(<a class="reference external" href="https://github.com/wtak23/private_repos/blob/master/cs105_lab2_solutions.rst#a-exercise-top-ten-error-paths-hw">sol</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DataFrame containing all accesses that did not return a code 200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># from pyspark.sql.functions import desc &lt;= I ended up not using this...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">not200DF</span> <span class="o">=</span> <span class="n">logs_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">not200DF</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">+----------------+--------------------+------+------------+--------------------+</span>
<span class="go">|            host|                path|status|content_size|                time|</span>
<span class="go">+----------------+--------------------+------+------------+--------------------+</span>
<span class="go">|uplherc.upl.com |                   /|   304|           0|1995-08-01 00:00:...|</span>
<span class="go">|uplherc.upl.com |/images/ksclogo-m...|   304|           0|1995-08-01 00:00:...|</span>
<span class="go">|uplherc.upl.com |/images/MOSAIC-lo...|   304|           0|1995-08-01 00:00:...|</span>
<span class="go">|uplherc.upl.com |/images/USA-logos...|   304|           0|1995-08-01 00:00:...|</span>
<span class="go">|uplherc.upl.com |/images/WORLD-log...|   304|           0|1995-08-01 00:00:...|</span>
<span class="go">+----------------+--------------------+------+------------+--------------------+</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sorted DataFrame with the paths and the number of times they were accessed with non-200 return code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logs_sum_df</span> <span class="o">=</span> <span class="n">not200DF</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Top Five failed URLs:&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logs_sum_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
<span class="go">Top Five failed URLs:</span>
<span class="go">+----------------------------+-----+</span>
<span class="go">|path                        |count|</span>
<span class="go">+----------------------------+-----+</span>
<span class="go">|/images/NASA-logosmall.gif  |8761 |</span>
<span class="go">|/images/KSC-logosmall.gif   |7236 |</span>
<span class="go">|/images/MOSAIC-logosmall.gif|5197 |</span>
<span class="go">|/images/USA-logosmall.gif   |5157 |</span>
<span class="go">|/images/WORLD-logosmall.gif |5020 |</span>
<span class="go">+----------------------------+-----+</span>
<span class="go">only showing top 5 rows</span>
</pre></div>
</div>
</div>
<div class="section" id="b-exercise-number-of-unique-hosts-hw">
<h3><a class="toc-backref" href="#id19">4b) Exercise: Number of Unique Hosts (HW)</a></h3>
<p>How many unique hosts are there in the entire log?</p>
<ul class="simple">
<li>There are multiple ways to find this.</li>
<li>Try to find a more optimal way than grouping by &#8216;host&#8217;.</li>
</ul>
<p><a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.DataFrame.distinct.html">https://wtak23.github.io/pyspark/generated/generated/sql.DataFrame.distinct.html</a></p>
<p>(<a class="reference external" href="https://github.com/wtak23/private_repos/blob/master/cs105_lab2_solutions.rst#b-exercise-number-of-unique-hosts-hw">solution</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_host_count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Unique hosts: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">unique_host_count</span><span class="p">)</span>
<span class="go">Unique hosts: 54507</span>
</pre></div>
</div>
</div>
<div class="section" id="c-exercise-number-of-unique-daily-hosts">
<h3><a class="toc-backref" href="#id20">4c) Exercise: Number of Unique Daily Hosts</a></h3>
<p>Let&#8217;s determine the <strong>number of unique hosts in the entire log on a day-by-day basis</strong>.</p>
<ul class="simple">
<li>so we want to get the <strong>counts of the number of unique daily hosts</strong>.</li>
<li>We&#8217;d like <code class="docutils literal"><span class="pre">daily_hosts_df</span></code> <strong>sorted by increasing day of the month</strong> which includes: (1) the day of the month and (2) the associated number of unique hosts for that day.</li>
<li>Make sure you <code class="docutils literal"><span class="pre">cache</span></code> the resulting DataFrame (used in next exercise)</li>
<li>note: since the log only covers a single month, you can ignore the month.</li>
<li>you may want ot use the <code class="docutils literal"><span class="pre">dayofmonth</span></code> function (<a class="reference external" href="https://wtak23.github.io/pyspark/generated/generated/sql.functions.dayofmonth.html">link</a>) in <code class="docutils literal"><span class="pre">sql.functions</span></code> module</li>
<li>Think about the steps that you need to perform to count the number of different hosts that make requests each day.</li>
</ul>
<p>(<a class="reference external" href="https://github.com/wtak23/private_repos/blob/master/cs105_lab2_solutions.rst#c-exercise-number-of-unique-daily-hosts">solution</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># dataframe with two columns: (host, day) = (the hostname, the day of the month)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">day_to_host_pair_df</span> <span class="o">=</span> <span class="n">logs_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">day_to_host_pair_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">+------------------+---+</span>
<span class="go">|host              |day|</span>
<span class="go">+------------------+---+</span>
<span class="go">|in24.inetnebr.com |1  |</span>
<span class="go">|uplherc.upl.com   |1  |</span>
<span class="go">|uplherc.upl.com   |1  |</span>
<span class="go">|uplherc.upl.com   |1  |</span>
<span class="go">|uplherc.upl.com   |1  |</span>
<span class="go">+------------------+---+</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">day_to_host_pair_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+-------+------------------+</span>
<span class="go">|summary|               day|</span>
<span class="go">+-------+------------------+</span>
<span class="go">|  count|           1043177|</span>
<span class="go">|   mean|12.215187834854488|</span>
<span class="go">| stddev| 5.904864431416356|</span>
<span class="go">|    min|                 1|</span>
<span class="go">|    max|                22|</span>
<span class="go">+-------+------------------+</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># remove duplicate (day,host) rows</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">day_group_hosts_df</span> <span class="o">=</span> <span class="n">day_to_host_pair_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">day_group_hosts_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">+-------------------------+---+</span>
<span class="go">|host                     |day|</span>
<span class="go">+-------------------------+---+</span>
<span class="go">|xslip47.csrv.uidaho.edu  |1  |</span>
<span class="go">|bettong.client.uq.oz.au  |1  |</span>
<span class="go">|gatekeeper.unicc.org     |1  |</span>
<span class="go">|slmel2p17.ozemail.com.au |1  |</span>
<span class="go">|core.sci.toyama-u.ac.jp  |1  |</span>
<span class="go">+-------------------------+---+</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">day_group_hosts_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+-------+------------------+</span>
<span class="go">|summary|               day|</span>
<span class="go">+-------+------------------+</span>
<span class="go">|  count|             77506|</span>
<span class="go">|   mean|12.263669909426367|</span>
<span class="go">| stddev| 5.947202970239651|</span>
<span class="go">|    min|                 1|</span>
<span class="go">|    max|                22|</span>
<span class="go">+-------+------------------+</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># data frame with columns (day,count) = (day, # of uniq requesting host for that day)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daily_hosts_df</span> <span class="o">=</span> <span class="n">day_group_hosts_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># cache DataFrame as instructed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daily_hosts_df</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Unique hosts per day:&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daily_hosts_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
<span class="go">(2) Spark Jobs</span>
<span class="go">+---+-----+</span>
<span class="go">|day|count|</span>
<span class="go">+---+-----+</span>
<span class="go">|1  |2582 |</span>
<span class="go">|3  |3222 |</span>
<span class="go">|4  |4190 |</span>
<span class="go">|5  |2502 |</span>
<span class="go">|6  |2537 |</span>
<span class="go">|7  |4106 |</span>
<span class="go">|8  |4406 |</span>
<span class="go">|9  |4317 |</span>
<span class="go">|10 |4523 |</span>
<span class="go">|11 |4346 |</span>
<span class="go">|12 |2864 |</span>
<span class="go">|13 |2650 |</span>
<span class="go">|14 |4454 |</span>
<span class="go">|15 |4214 |</span>
<span class="go">|16 |4340 |</span>
<span class="go">|17 |4385 |</span>
<span class="go">|18 |4168 |</span>
<span class="go">|19 |2550 |</span>
<span class="go">|20 |2560 |</span>
<span class="go">|21 |4134 |</span>
<span class="go">|22 |4456 |</span>
<span class="go">+---+-----+</span>
</pre></div>
</div>
</div>
<div class="section" id="d-exercise-visualizing-the-number-of-unique-daily-hosts">
<h3><a class="toc-backref" href="#id21">4d) Exercise: Visualizing the Number of Unique Daily Hosts</a></h3>
<ul class="simple">
<li>plot a line graph of the unique hosts requests by day.</li>
<li>We need two lists:<ul>
<li><code class="docutils literal"><span class="pre">days_with_hosts</span></code> = list of days</li>
<li><code class="docutils literal"><span class="pre">hosts</span></code> = list of the number of unique hosts for each corresponding day</li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ul class="last simple">
<li>calling <code class="docutils literal"><span class="pre">collect()</span></code> on your transformed DataFrame won&#8217;t work, because it returns a list of <code class="docutils literal"><span class="pre">Row</span></code> objects.</li>
<li>You must extract the appropriate column values from the Row objects.</li>
<li>Hint: A loop will help</li>
</ul>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Odd...I don&#8217;t see why the loop is needed...</p>
</div>
<p>(<a class="reference external" href="https://github.com/wtak23/private_repos/blob/master/cs105_lab2_solutions.rst#d-exercise-visualizing-the-number-of-unique-daily-hosts">solution</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">days_with_hosts</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hosts</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">days_with_hosts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">hosts</span><span class="p">)</span>
<span class="go">[1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]</span>
<span class="go">[2582, 3222, 4190, 2502, 2537, 4106, 4406, 4317, 4523, 4346, 2864, 2650, 4454, 4214, 4340, 4385, 4168, 2550, 2560, 4134, 4456]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">prepareSubplot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colorMap</span> <span class="o">=</span> <span class="s1">&#39;Dark2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">colorMap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">days_with_hosts</span><span class="p">,</span> <span class="n">hosts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">days_with_hosts</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">hosts</span><span class="p">)</span><span class="o">+</span><span class="mi">500</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Day&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Hosts&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#999999&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#999999&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/105_lab2_4d.png" class="align-center" src="../_images/105_lab2_4d.png" />
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">display</span><span class="p">(</span><span class="n">daily_hosts_df</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/105_lab2_4d2.png" class="align-center" src="../_images/105_lab2_4d2.png" />
</div>
<div class="section" id="e-exercise-average-number-of-daily-requests-per-host">
<span id="cs105-lab2-4e"></span><h3><a class="toc-backref" href="#id22">4e) Exercise: Average Number of Daily Requests per Host</a></h3>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">This one was VERY informative (although it took a lot of my time)</p>
</div>
<p>Next, let&#8217;s determine the <strong>average number of requests on a day-by-day basis</strong>.</p>
<ul class="simple">
<li>We&#8217;d like a list by <em>increasing day of the month</em> and the <strong>associated average number of requests per host for that day</strong>.</li>
<li>Make sure you <code class="docutils literal"><span class="pre">cache</span></code> the resulting DataFrame <code class="docutils literal"><span class="pre">avg_daily_req_per_host_df</span></code> so that we can reuse it in the next exercise.</li>
<li>To compute the <strong>average number of requests per host</strong>:<ul>
<li>find the <strong>total number of requests per day</strong> (across all hosts)</li>
<li>divide this by the <strong>number of unique hosts per day</strong> (which we found in part 4c and cached as <code class="docutils literal"><span class="pre">daily_hosts_df</span></code>).</li>
</ul>
</li>
<li>Since the log only covers a single month, you can skip checking for the month.</li>
</ul>
<div class="admonition-refresher-on-what-we-have admonition">
<p class="first admonition-title">Refresher on what we have</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logs_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">+------------------+--------------------+------+------------+--------------------+</span>
<span class="go">|              host|                path|status|content_size|                time|</span>
<span class="go">+------------------+--------------------+------+------------+--------------------+</span>
<span class="go">|in24.inetnebr.com |/shuttle/missions...|   200|        1839|1995-08-01 00:00:...|</span>
<span class="go">|  uplherc.upl.com |                   /|   304|           0|1995-08-01 00:00:...|</span>
<span class="go">|  uplherc.upl.com |/images/ksclogo-m...|   304|           0|1995-08-01 00:00:...|</span>
<span class="go">+------------------+--------------------+------+------------+--------------------+</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">daily_hosts_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">+---+-----+</span>
<span class="go">|day|count|</span>
<span class="go">+---+-----+</span>
<span class="go">|  1| 2582|</span>
<span class="go">|  3| 3222|</span>
<span class="go">|  4| 4190|</span>
<span class="go">+---+-----+</span>
</pre></div>
</div>
</div>
<p>(<a class="reference external" href="https://github.com/wtak23/private_repos/blob/master/cs105_lab2_solutions.rst#e-exercise-average-number-of-daily-requests-per-host">solution</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">total_req_per_day_df</span> <span class="o">=</span> <span class="n">logs_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total_req_per_day_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">+---+-----+</span>
<span class="go">|day|count|</span>
<span class="go">+---+-----+</span>
<span class="go">|  1|33996|</span>
<span class="go">|  3|41387|</span>
<span class="go">|  4|59554|</span>
<span class="go">|  5|31888|</span>
<span class="go">|  6|32416|</span>
<span class="go">+---+-----+</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_daily_req_per_host_df</span> <span class="o">=</span> <span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">total_req_per_day_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># cache DF as instructed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_daily_req_per_host_df</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s1">&#39;Average number of daily requests per Hosts is:&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_daily_req_per_host_df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">Average number of daily requests per Hosts is:</span>
<span class="go">+---+-------------------------+</span>
<span class="go">|day|avg_reqs_per_host_per_day|</span>
<span class="go">+---+-------------------------+</span>
<span class="go">|  1|       13.166537567776917|</span>
<span class="go">|  3|       12.845127250155183|</span>
<span class="go">|  4|       14.213365155131266|</span>
<span class="go">|  5|       12.745003996802557|</span>
<span class="go">|  6|       12.777296018919984|</span>
<span class="go">|  7|       13.968582562104238|</span>
<span class="go">|  8|       13.650022696323196|</span>
<span class="go">|  9|        14.00440120454019|</span>
<span class="go">| 10|       13.540791510059695|</span>
<span class="go">| 11|       14.091578462954441|</span>
<span class="go">| 12|       13.292597765363128|</span>
<span class="go">| 13|       13.766037735849057|</span>
<span class="go">| 14|       13.442523574315222|</span>
<span class="go">| 15|       13.964167062173706|</span>
<span class="go">| 16|       13.053225806451612|</span>
<span class="go">| 17|       13.450399087799315|</span>
<span class="go">| 18|       13.494241842610364|</span>
<span class="go">| 19|       12.585098039215687|</span>
<span class="go">| 20|             12.876171875|</span>
<span class="go">| 21|       13.434687953555878|</span>
<span class="go">+---+-------------------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="f-exercise-visualizing-the-average-daily-requests-per-unique-host">
<h3><a class="toc-backref" href="#id23">4f) Exercise: Visualizing the Average Daily Requests per Unique Host</a></h3>
<ul class="simple">
<li>use <code class="docutils literal"><span class="pre">avg_daily_req_per_host_df</span></code> to plot a line graph of the <strong>average daily requests per unique host by day</strong>.</li>
<li><code class="docutils literal"><span class="pre">days_with_avg</span></code> = list of days</li>
<li><code class="docutils literal"><span class="pre">avgs</span></code> = list of average daily requests (as integers) per unique hosts for each corresponding day.</li>
<li><strong>Hint</strong>: You will need to extract these from the Dataframe in a similar way to part 4d.</li>
</ul>
<p>(<a class="reference external" href="https://github.com/wtak23/private_repos/blob/master/cs105_lab2_solutions.rst#f-exercise-visualizing-the-average-daily-requests-per-unique-host">solution</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">days_with_avg</span> <span class="o">=</span> <span class="p">(</span><span class="n">avg_daily_req_per_host_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avgs</span> <span class="o">=</span> <span class="p">(</span><span class="n">avg_daily_req_per_host_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (again, i didn&#39;t see why this loop is needed)...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">days_with_avg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">avgs</span><span class="p">)</span>
<span class="go">[1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]</span>
<span class="go">[13.166537567776917, 12.845127250155183, 14.213365155131266, 12.745003996802557, 12.777296018919984, 13.968582562104238, 13.650022696323196, 14.00440120454019, 13.540791510059695, 14.091578462954441, 13.292597765363128, 13.766037735849057, 13.442523574315222, 13.964167062173706, 13.053225806451612, 13.450399087799315, 13.494241842610364, 12.585098039215687, 12.876171875, 13.434687953555878, 12.961849192100539]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">prepareSubplot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">colorMap</span> <span class="o">=</span> <span class="s1">&#39;Set3&#39;</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">colorMap</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">days_with_avg</span><span class="p">,</span> <span class="n">avgs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">days_with_avg</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">avgs</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Day&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Average&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#999999&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#999999&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/105_lab2_4f1.png" class="align-center" src="../_images/105_lab2_4f1.png" />
<p>As a comparison to the prior plot, use the Databricks display function to plot a line graph of the average daily requests per unique host by day.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">display</span><span class="p">(</span><span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/105_lab2_4f2.png" class="align-center" src="../_images/105_lab2_4f2.png" />
</div>
</div>
<div class="section" id="part5-exploring-404-status-codes">
<h2><a class="toc-backref" href="#id24">Part5: Exploring 404 Status Codes</a></h2>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">This section is basically a carbon-copy of <a class="reference internal" href="#cs105-lab2-part4"><span>Part 4: Analyzing Web Server Log File</span></a>.
So skipped noting.</p>
</div>
<div class="section" id="a-exercise-counting-404-response-codes">
<h3><a class="toc-backref" href="#id25">5a) Exercise: Counting 404 Response Codes</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">not_found_df</span> <span class="o">=</span> <span class="n">logs_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;Found {0} 404 URLs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">not_found_df</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="go">Found 6185 404 URLs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">not_found_df</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="b-exercise-listing-404-status-code-records">
<h3><a class="toc-backref" href="#id26">5b) Exercise: Listing 404 Status Code Records</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>

<span class="n">not_found_paths_df</span> <span class="o">=</span> <span class="n">not_found_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="n">unique_not_found_paths_df</span> <span class="o">=</span> <span class="n">not_found_paths_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>

<span class="k">print</span> <span class="s1">&#39;404 URLS:</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">unique_not_found_paths_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="c-exercise-listing-the-top-twenty-404-response-code-paths">
<h3><a class="toc-backref" href="#id27">5c) Exercise: Listing the Top Twenty 404 Response Code paths</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>

<span class="n">top_20_not_found_df</span> <span class="o">=</span> <span class="n">not_found_paths_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>

<span class="k">print</span> <span class="s1">&#39;Top Twenty 404 URLs:</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">top_20_not_found_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="d-exercise-listing-the-top-twenty-five-404-response-code-hosts">
<h3><a class="toc-backref" href="#id28">5d) Exercise: Listing the Top Twenty-five 404 Response Code Hosts</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>

<span class="n">hosts_404_count_df</span> <span class="o">=</span> <span class="n">not_found_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>

<span class="k">print</span> <span class="s1">&#39;Top 25 hosts that generated errors:</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">hosts_404_count_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="e-exercise-listing-404-errors-per-day">
<h3><a class="toc-backref" href="#id29">5e) Exercise: Listing 404 Errors per Day</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>

<span class="n">errors_by_date_sorted_df</span> <span class="o">=</span> <span class="n">not_found_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>

<span class="k">print</span> <span class="s1">&#39;404 Errors by day:</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">errors_by_date_sorted_df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="f-exercise-visualizing-the-404-errors-by-day">
<h3><a class="toc-backref" href="#id30">5f) Exercise: Visualizing the 404 Errors by Day</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>

<span class="n">days_with_errors_404</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="n">errors_404_by_day</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>
<span class="k">for</span> <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span><span class="p">:</span>
  <span class="o">&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>

<span class="k">print</span> <span class="n">days_with_errors_404</span>
<span class="k">print</span> <span class="n">errors_404_by_day</span>
</pre></div>
</div>
</div>
<div class="section" id="h-exercise-hourly-404-errors">
<h3><a class="toc-backref" href="#id31">5h) Exercise: Hourly 404 Errors</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">hour</span>
<span class="n">hour_records_sorted_df</span> <span class="o">=</span> <span class="n">not_found_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>

<span class="k">print</span> <span class="s1">&#39;Top hours for 404 requests:</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">hour_records_sorted_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="g-exercise-top-five-days-for-404-errors">
<h3><a class="toc-backref" href="#id32">5g) Exercise: Top Five Days for 404 Errors</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>

<span class="n">top_err_date_df</span> <span class="o">=</span> <span class="n">errors_by_date_sorted_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>

<span class="k">print</span> <span class="s1">&#39;Top Five Dates for 404 Requests:</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">top_err_date_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="i-exercise-hourly-404-errors">
<h3><a class="toc-backref" href="#id33">5i) Exercise: Hourly 404 Errors</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">hour</span>
<span class="n">hour_records_sorted_df</span> <span class="o">=</span> <span class="n">not_found_df</span><span class="o">.&lt;</span><span class="n">FILL</span> <span class="n">IN</span><span class="o">&gt;</span>

<span class="k">print</span> <span class="s1">&#39;Top hours for 404 requests:</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">hour_records_sorted_df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="j-exercise-visualizing-the-404-response-codes-by-hour">
<h3><a class="toc-backref" href="#id34">5j) Exercise: Visualizing the 404 Response Codes by Hour</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span># TODO: Replace &lt;FILL IN&gt; with appropriate code
​
hours_with_not_found = &lt;FILL IN&gt;
not_found_counts_per_hour = &lt;FILL IN&gt;
​
print hours_with_not_found
print not_found_counts_per_hour
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/pyspark/cs105_lab2.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>